/*! For license information please see app.js.LICENSE.txt */
(()=>{"use strict";var e,t={1046:(e,t,n)=>{var r=n(4942),o=n(5861),a=n(7757),i=n.n(a),c=n(7294),s=n(3935),l=n(885),d=n(8813);const u={colors:{bgCanvas:"var(--bg-canvas)",bgCanvasSemiTransparent:"var(--bg-canvas-semi-transparent)",bgBlock:"var(--bg-block)",bgHover:"var(--bg-hover)",bgActive:"var(--bg-active)",bgDangerHover:"var(--bg-danger-hover)",bgDangerActive:"var(--bg-danger-active)",contentText:"var(--content-text)",uiText:"var(--ui-text)",uiDanger:"var(--ui-danger)",uiPrimaryVeryLight:"hsla(165deg, 65%, 55%, 0.2)",uiPrimaryLight:"hsla(165deg, 65%, 55%, 0.8)",uiPrimary:"hsl(165deg, 65%, 55%)",uiPrimaryHarder:"hsl(42deg, 20%, 35%)",uiPrimaryAttractive:"hsl(165deg, 80%, 79%)",uiPrimaryAttractiveHover:"hsl(165deg, 80%, 74%)",uiPrimaryAttractiveActive:"hsl(165deg, 80%, 69%)",uiSecondaryDumb:"hsl(42deg, 8%, 75%)",neutral95:"var(--neutral-95)",neutral90:"var(--neutral-90)",neutral70:"var(--neutral-70)",neutral60:"var(--neutral-60)",neutral50:"var(--neutral-50)",neutral40:"var(--neutral-40)",neutral10:"var(--neutral-10)"},shadows:{focus:"var(--shadow-focus)",layer:"var(--shadow-layer)",float:"var(--shadow-float)"},borders:{largeRadius:".6rem",smallRadius:".3rem"},animations:{fadeIn:(0,d.F4)({"0%":{opacity:0},"100%":{opacity:1}}),fadeOut:(0,d.F4)({"0%":{opacity:1},"100%":{opacity:0}})},easings:{easeInOutCubic:"cubic-bezier(0.65, 0, 0.35, 1)",easeInQuart:"cubic-bezier(0.5, 0, 0.75, 0)",easeOutQuart:"cubic-bezier(0.25, 1, 0.5, 1)",easeOutQuint:"cubic-bezier(0.22, 1, 0.36, 1)",easeOutExpo:"cubic-bezier(0.16, 1, 0.3, 1)"},paddings:{blockComfort:".5rem 1.25rem",blockCompact:".35rem 1.25rem",navComfort:".5rem"},arrowSize:6,fonts:{monospace:"var(--font-monospace)"}};var f=(0,d.zE)({app:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:0,overflow:"hidden",color:u.colors.contentText,background:u.colors.bgCanvas,transition:"color 0.5s ".concat(u.easings.easeInOutCubic,",\nbackground 0.5s ").concat(u.easings.easeInOutCubic)},movingBlocks:{cursor:"grabbing"},resizingBlocks:{cursor:"ew-resize"},drawingRelation:{cursor:"crosshair"}}),p=n(2982);function m(e,t){return{x:e.x+t.x,y:e.y+t.y}}function b(e,t){return{x:e.x-t.x,y:e.y-t.y}}function g(e,t){return{x:e.x/t,y:e.y/t}}function y(e,t){var n=Math.pow(10,t);return{x:Math.floor(e.x*n)/n,y:Math.floor(e.y*n)/n}}function h(e,t){return e.x>t.left&&e.x<t.right&&e.y>t.top&&e.y<t.bottom}function v(e,t){return e.x>t.x&&e.x<t.x+t.w&&e.y>t.y&&e.y<t.y+t.h}function w(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function x(e,t){return n=e.x,r=e.y,o=e.w,a=e.h,i=t.x,c=t.y,s=t.w,l=t.h,n<i+s&&n+o>i&&r<c+l&&r+a>c;var n,r,o,a,i,c,s,l}function k(e,t,n,r){return{x:e<n?e:n,y:t<r?t:r,w:Math.abs(e-n),h:Math.abs(t-r)}}function E(e,t){return m(t.focus,g(e,t.scale))}function O(e){return e!=e}function T(e){var t=Math.min.apply(Math,(0,p.Z)(e.map((function(e){return e.x})))),n=Math.min.apply(Math,(0,p.Z)(e.map((function(e){return e.y}))));return{x:t,y:n,w:Math.max.apply(Math,(0,p.Z)(e.map((function(e){return e.x+e.w}))))-t,h:Math.max.apply(Math,(0,p.Z)(e.map((function(e){return e.y+e.h}))))-n}}function C(e){return{x:e.x+e.w/2,y:e.y+e.h/2}}function S(e,t){return{x:e.x-t,y:e.y-t,w:e.w+2*t,h:e.h+2*t}}function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e,t,n){switch(n){case"top":return{x:e.x,y:Math.min(e.y-(e.y-t.y)/2,e.y-30)};case"bottom":return{x:e.x,y:Math.max(e.y-(e.y-t.y)/2,e.y+30)};case"left":return{x:Math.min(e.x-(e.x-t.x)/2,e.x-30),y:e.y};case"right":return{x:Math.max(e.x-(e.x-t.x)/2,e.x+30),y:e.y}}}function B(e){switch(e){case"top":return 90;case"bottom":return 270;case"left":return 0;default:return 180}}var z,M,R,j=(0,d.zE)({Arrow:{pointerEvents:"none",overflow:"visible"}});function D(e){var t,n,o,a,i,s=e.fromBox,d=e.toBox,f=e.viewBox,p=e.color,m=void 0===p?"#000":p,b=e.size,g=void 0===b?7:b,h=e.onMouseDown,x=(n=d,o={padEnd:g},function(e,t,n,o,a,i,c,s,l){for(var d=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({padStart:0,padEnd:0},l),u={x:e,y:t,w:n,h:o},f={x:e+n/2,y:t-2*d.padStart},p={x:e+n/2,y:t+o+2*d.padStart},m={x:e-2*d.padStart,y:t+o/2},b={x:e+n+2*d.padStart,y:t+o/2},g={x:a,y:i,w:c,h:s},y={x:a+c/2,y:i-2*d.padEnd},h={x:a+c/2,y:i+s+2*d.padEnd},x={x:a-2*d.padEnd,y:i+s/2},k=["top","right","bottom","left"],E=[f,b,p,m],O=[y,{x:a+c+2*d.padEnd,y:i+s/2},h,x],T=1/0,C=f,z=y,M="top",R="top",j=0;j<k.length;j++){var D=E[j];if(!v(D,S(g,15)))for(var N=0;N<k.length;N++){var L=O[N];if(!v(L,S(u,15))){var A=w(D,L);A<T&&(T=A,C=D,z=L,M=k[j],R=k[N])}}}var Z=P(C,z,M),H=P(z,C,R);return[C.x,C.y,Z.x,Z.y,H.x,H.y,z.x,z.y,B(R),B(M)]}((t=s).x,t.y,t.w,t.h,n.x,n.y,n.w,n.h,o)),k=(0,l.Z)(x,9),E=k[0],O=k[1],T=k[2],C=k[3],z=k[4],M=k[5],R=k[6],D=k[7],N=k[8],L=[y({x:E,y:O},2),y({x:R,y:D},2),y({x:T,y:C},2),y({x:z,y:M},2),N],A=L[0],Z=L[1],H=L[2],F=L[3],$=L[4],_=(a=f,2,i=Math.pow(10,2),{x:Math.floor(a.x*i)/i,y:Math.floor(a.y*i)/i,w:Math.floor(a.w*i)/i,h:Math.floor(a.h*i)/i}),V=(0,c.useState)(!1),W=(0,l.Z)(V,2),K=W[0],J=W[1];return c.createElement("svg",{className:j.Arrow,width:_.w,height:_.h,xmlns:"http://www.w3.org/2000/svg",onMouseDown:h,onContextMenu:function(e){return e.preventDefault()}},c.createElement("path",{d:"M ".concat(A.x-_.x," ").concat(A.y-_.y," C ").concat(H.x-_.x," ").concat(H.y-_.y,", ").concat(F.x-_.x," ").concat(F.y-_.y,", ").concat(Z.x-_.x," ").concat(Z.y-_.y),stroke:K?u.colors.uiPrimary:m,strokeWidth:g/2,fill:"none"}),c.createElement("polygon",{points:"0,".concat(-g," ").concat(2*g,",0, 0,").concat(g),transform:"translate(".concat(Z.x-_.x,", ").concat(Z.y-_.y,") rotate(").concat($,")"),fill:K?u.colors.uiPrimary:m}),c.createElement("path",{d:"M ".concat(A.x-_.x," ").concat(A.y-_.y," C ").concat(H.x-_.x," ").concat(H.y-_.y,", ").concat(F.x-_.x," ").concat(F.y-_.y,", ").concat(Z.x-_.x," ").concat(Z.y-_.y),stroke:"transparent",strokeWidth:2*g,fill:"none",pointerEvents:"visibleStroke",onMouseEnter:function(){return J(!0)},onMouseLeave:function(){return J(!1)}}))}!function(e){e[e.None=0]="None",e[e.Normal=1]="Normal",e[e.PinnedTL=2]="PinnedTL",e[e.PinnedTR=3]="PinnedTR",e[e.PinnedBL=4]="PinnedBL",e[e.PinnedBR=5]="PinnedBR"}(z||(z={})),function(e){e[e.Idle=0]="Idle",e[e.Moving=1]="Moving",e[e.Resizing=2]="Resizing",e[e.Focusing=3]="Focusing"}(M||(M={})),function(e){e.BackgroundRed="background-red",e.BackgroundOrange="background-orange",e.BackgroundYellow="background-yellow",e.BackgroundGreen="background-green",e.BackgroundBlue="background-blue",e.BackgroundPurple="background-purple",e.BackgroundPink="background-pink",e.BackgroundBrown="background-brown",e.BackgroundGrey="background-grey"}(R||(R={}));var N,L,A,Z,H=function(e){return e.references.length>0};!function(e){e[e.InferFromPointer=0]="InferFromPointer",e[e.Relation=1]="Relation"}(N||(N={})),function(e){e.Concept="concept",e.Block="block",e.View="view"}(L||(L={})),function(e){e.ConceptCreate="concept::create",e.ConceptWriteData="concept::writeData",e.BlockCreate="block::create",e.BlockRemove="block::remove",e.BlockCut="block::cut",e.BlockPaste="block::paste",e.BlockMoveStart="block::moveStart",e.BlockMove="block::move",e.BlockMoveEnd="block::moveEnd",e.BlockResizeDelta="block::resizeDelta",e.BlockSetMode="block::setMode",e.BlockSetColor="block::setColor",e.BlockSetSize="block::setSize",e.BlockSelect="block::select",e.BlockDeselect="block::deselect",e.BlockDeselectAll="block::deselectAll",e.BlockOpenAsCanvas="block::openAsCanvas",e.CameraMoveDelta="camera::moveDelta",e.CameraScaleDelta="camera::scaleDelta",e.CameraSetValue="camera::setValue",e.SelectionBoxSetStart="selectionBox::setStart",e.SelectionBoxSetEnd="selectionBox::setEnd",e.SelectionBoxClear="selectionBox::clear",e.RelationDrawStart="relation::drawStart",e.RelationDrawMove="relation::drawMove",e.RelationDrawEnd="relation::drawEnd",e.RelationRemove="relation::remove",e.NavigateBack="navigateBack",e.NavigateForward="navigateForward",e.BlocksRendered="blocksRendered",e.ContextMenuOpen="contextMenu::open",e.ContextMenuClose="contextMenu::close",e.SettingsSet="settings::set"}(A||(A={})),function(e){e.ExactAt="exactAt",e.Below="below",e.Above="above",e.LeftOf="leftOf",e.RightOf="rightOf"}(Z||(Z={}));var F=(0,c.createContext)(null);function $(){var e=(0,c.useContext)(F);if(e)return e;throw new LifecycleError("useAppState() must be called within a Provider")}var _=(0,c.createContext)(null);function V(){var e=(0,c.useContext)(_);if(e)return e;throw new LifecycleError("useSystem() must be called within a Provider")}var W,K=n(4586),J=n(3144),G=n(5671),U=new((0,J.Z)((function e(){var t=this;(0,G.Z)(this,e),(0,r.Z)(this,"camera",void 0),(0,r.Z)(this,"blockInfoMap",void 0),(0,r.Z)(this,"ro",void 0),(0,r.Z)(this,"setElement",(function(e,n){t.blockInfoMap.set(e,{alive:!0,cachedEnvRect:void 0,el:n}),n.dataset.blockId=e,t.ro.observe(n)})),(0,r.Z)(this,"detachElement",(function(e){var n=t.blockInfoMap.get(e);n&&(n.el&&t.ro.unobserve(n.el),t.blockInfoMap.set(e,{alive:!1,cachedEnvRect:n.cachedEnvRect,el:void 0}))})),(0,r.Z)(this,"getMeasuredSize",(function(e){var n=t.blockInfoMap.get(e);if(n)return n.cachedEnvRect})),(0,r.Z)(this,"updateCamera",(function(e){t.camera=e})),(0,r.Z)(this,"clear",(function(){t.blockInfoMap.clear()})),(0,r.Z)(this,"deleteBlocks",(function(e){e.forEach((function(e){t.blockInfoMap.delete(e)}))})),this.blockInfoMap=new Map,this.ro=new ResizeObserver((function(e){for(var n=0;n<e.length;n++){var r=e[n],o=r.target,a=o.dataset.blockId;if(a){var i=(c=o.getBoundingClientRect(),s=t.camera,l=void 0,d=void 0,l=E({x:c.x,y:c.y},s),{x:(d={x:l.x,y:l.y,width:c.width/s.scale,height:c.height/s.scale}).x,y:d.y,width:d.width,height:d.height,top:d.y,right:d.x+d.width,bottom:d.y+d.height,left:d.x});t.blockInfoMap.set(a,{alive:!0,cachedEnvRect:{top:i.top,right:i.right,bottom:i.bottom,left:i.left,x:i.x,y:i.y,width:r.borderBoxSize[0].inlineSize,height:r.borderBoxSize[0].blockSize},el:o})}}var c,s,l,d}))})));function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function q(e){return X({id:(0,K.Z)(),createdTime:Date.now(),lastEditedTime:Date.now()},e)}function Q(e,t){return{id:e.id,posType:e.posType,pos:e.pos,size:e.size,zIndex:t,color:e.color,createdTime:e.createdTime,lastEditedTime:e.lastEditedTime,mode:M.Idle,selected:!1,highlighted:!1,conceptId:e.to}}function ee(e,t){var n=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};return X(X(X({},e),t),{},{lastEditedTime:n(t,"pos")||n(t,"posType")||n(t,"size")?Date.now():e.lastEditedTime})}function te(e){return{id:e.id,to:e.conceptId,posType:e.posType,pos:e.pos,size:e.size,color:e.color,createdTime:e.createdTime,lastEditedTime:e.lastEditedTime}}function ne(e){return e.posType===z.Normal}function re(e,t){var n,r=(n=t,function(e){var t=U.getMeasuredSize(e.id);return!!t&&x(n,{x:e.pos.x,y:e.pos.y,w:t.width,h:t.height})});return e.filter(ne).filter(r).map((function(e){return e.id}))}function oe(e,t){return e.find((function(e){return t===e.id}))}function ae(e){var t=U.getMeasuredSize(e.id)||{width:0,height:0};return{x:e.pos.x,y:e.pos.y,w:t.width,h:t.height}}function ie(e){return e.map((function(e){return ee(e,{selected:!1})}))}function ce(e,t,n,r){var o=t.pos,a=U.getMeasuredSize(t.id);if(!a)return!1;if(t.posType===z.None)return!1;if(t.posType===z.Normal)return h(e,{left:t.pos.x,right:t.pos.x+a.width,top:t.pos.y,bottom:t.pos.y+a.height});switch(t.posType){case z.PinnedTL:return h(e,{left:n.focus.x+o.x/n.scale,right:n.focus.x+(o.x+a.width)/n.scale,top:n.focus.y+o.y/n.scale,bottom:n.focus.y+(o.y+a.height)/n.scale});case z.PinnedTR:return h(e,{left:n.focus.x+(r.w-o.x-a.width)/n.scale,right:n.focus.x+(r.w-o.x)/n.scale,top:n.focus.y+o.y/n.scale,bottom:n.focus.y+(o.y+a.height)/n.scale});case z.PinnedBL:return h(e,{left:n.focus.x+o.x/n.scale,right:n.focus.x+(o.x+a.width)/n.scale,top:n.focus.y+(r.h-o.y-a.height)/n.scale,bottom:n.focus.y+(r.h-o.y)/n.scale});case z.PinnedBR:return h(e,{left:n.focus.x+(r.w-o.x-a.width)/n.scale,right:n.focus.x+(r.w-o.x)/n.scale,top:n.focus.y+(r.h-o.y-a.height)/n.scale,bottom:n.focus.y+(r.h-o.y)/n.scale});default:return!1}}function se(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a={w:window.innerWidth,h:window.innerHeight},i=t.length-1;i>=0;i--){var c=t[i];if(!r.includes(c.id)&&(!o||c.posType===z.Normal)&&ce(e,c,n,a))return c}}function le(e,t){var n=C({x:e.pos.x,y:e.pos.y,w:"auto"===e.size.w?300:e.size.w,h:"auto"===e.size.h?350:e.size.h}),r=window.innerWidth,o=window.innerHeight;return n&&{x:n.x-r/2/t,y:n.y-o/2/t}}var de={$nest:(W={},(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundRed,'"]'),{background:"var(--bg-red)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundOrange,'"]'),{background:"var(--bg-orange)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundYellow,'"]'),{background:"var(--bg-yellow)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundGreen,'"]'),{background:"var(--bg-green)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundBlue,'"]'),{background:"var(--bg-blue)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundPurple,'"]'),{background:"var(--bg-purple)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundPink,'"]'),{background:"var(--bg-pink)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundBrown,'"]'),{background:"var(--bg-brown)"}),(0,r.Z)(W,'&[data-color="'.concat(R.BackgroundGrey,'"]'),{background:"var(--bg-grey)"}),W)};function ue(e,t,n){for(var r={},o=t.length-e.length,a=t.filter((function(t){return e.includes(t.id)})).sort((function(e,t){return e.zIndex-t.zIndex})),i=0;i<a.length;i++){var c=a[i],s=X(X({},c),{},{zIndex:o+i});r[c.id]=n?n(s):s}for(var l=t.filter((function(t){return!e.includes(t.id)})).sort((function(e,t){return e.zIndex-t.zIndex})),d=0;d<l.length;d++){var u=l[d];r[u.id]=X(X({},u),{},{zIndex:d})}return t.map((function(e){return r[e.id]}))}function fe(e){return!!e.find((function(e){return e.mode===M.Moving}))}var pe=c.memo((function(e){var t=e.className,n=e.posType,r=e.pos,o=e.size,a=e.zIndex,i=e.children,s=void 0===a?"auto":a,l=(0,c.useMemo)((function(){switch(n){case z.PinnedTR:return{width:o.w,height:o.h,position:"absolute",top:0,right:0,zIndex:s,transformOrigin:"top right",transform:"translate3d(".concat(-r.x,"px, ").concat(r.y,"px, 0px)")};case z.PinnedBL:return{width:o.w,height:o.h,position:"absolute",bottom:0,left:0,zIndex:s,transformOrigin:"bottom left",transform:"translate3d(".concat(r.x,"px, ").concat(-r.y,"px, 0px)")};case z.PinnedBR:return{width:o.w,height:o.h,position:"absolute",bottom:0,right:0,zIndex:s,transformOrigin:"bottom right",transform:"translate3d(".concat(-r.x,"px, ").concat(-r.y,"px, 0px)")};default:return{width:o.w,height:o.h,position:"absolute",top:0,left:0,zIndex:s,transformOrigin:"top left",transform:"translate3d(".concat(r.x,"px, ").concat(r.y,"px, 0px)")}}}),[n,o.w,o.h,r.x,r.y,s]);return c.createElement("div",{className:t,style:l},i)})),me={w:0,h:0};function be(){var e=$(),t=e.relations,n=e.blocks,r=V().dispatchAction,o=(0,c.useMemo)((function(){return t.map((function(e){var t=oe(n,e.fromId);return t&&ae(t)}))}),[t,n]),a=(0,c.useMemo)((function(){return t.map((function(e){var t=oe(n,e.toId);return t&&ae(t)}))}),[t,n]);return c.createElement(c.Fragment,null,t.map((function(e,t){var n=o[t],i=a[t];if(!n||!i)return null;var s=S(T([n,i]),100);return c.createElement(pe,{key:"vo-r-".concat(e.id),posType:z.Normal,pos:s,size:me},c.createElement(D,{fromBox:n,toBox:i,viewBox:s,color:u.colors.uiPrimaryHarder,size:u.arrowSize,onMouseDown:function(t){if(2===t.button){var n={x:t.clientX,y:t.clientY};r({type:A.ContextMenuOpen,data:{contextType:N.Relation,pointerInViewportCoords:n,relationId:e.id}})}}}))})))}var ge=(0,d.oB)({display:"block",fill:"inherit",flexShrink:0,backfaceVisibility:"hidden"}),ye=function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("rect",{fill:"none",height:"24",width:"24"}),c.createElement("path",{d:"M9,6L9,6c0,0.56,0.45,1,1,1h5.59L4.7,17.89c-0.39,0.39-0.39,1.02,0,1.41h0c0.39,0.39,1.02,0.39,1.41,0L17,8.41V14 c0,0.55,0.45,1,1,1H18c0.55,0,1-0.45,1-1V6c0-0.55-0.45-1-1-1H10C9.45,5,9,5.45,9,6z"}))},he=c.memo((function(){return c.createElement("svg",{className:ge,width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.createElement("rect",{fill:"none",height:"24",width:"24"}),c.createElement("path",{d:"M21,8.59V4c0-0.55-0.45-1-1-1h-4.59c-0.89,0-1.34,1.08-0.71,1.71l1.59,1.59l-10,10l-1.59-1.59C4.08,14.08,3,14.52,3,15.41 V20c0,0.55,0.45,1,1,1h4.59c0.89,0,1.34-1.08,0.71-1.71l-1.59-1.59l10-10l1.59,1.59C19.92,9.92,21,9.48,21,8.59z"}))}));function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=18,ke=(0,d.zE)({actionButton:{transition:"0.1s opacity ".concat(u.easings.easeInOutCubic,", 30ms fill ").concat(u.easings.easeInOutCubic),fill:u.colors.neutral60,cursor:"pointer",borderRadius:u.borders.smallRadius,$nest:{"&:hover":{fill:u.colors.neutral40,background:u.colors.bgHover},"&:active":{fill:u.colors.neutral10,background:u.colors.bgActive}}},blink:{position:"absolute",top:0,left:0,width:4,height:4,margin:8,borderRadius:"100%",background:u.colors.uiPrimary,transition:"0.1s opacity ".concat(u.easings.easeInOutCubic)}}),Ee=we(we({},(0,d.zE)({block:{color:u.colors.contentText,background:u.colors.bgBlock,borderRadius:u.borders.smallRadius,overflow:"hidden",position:"relative",transition:"opacity 0.2s ".concat(u.easings.easeInOutCubic,",\nbox-shadow 0.2s ").concat(u.easings.easeInOutCubic,",\nbackground 0.5s ").concat(u.easings.easeInOutCubic),animation:"".concat(u.animations.fadeIn," 0.3s ").concat(u.easings.easeInOutCubic),$nest:we(we({},de.$nest),{},{"&:hover":{cursor:"pointer"}})},fillParentHeight:{height:"100%"},selected:{boxShadow:"0px 0px 1px 2px ".concat(u.colors.uiPrimary)},focusing:{boxShadow:u.shadows.focus,$nest:{"&:hover":{cursor:"auto"}}},moving:{$nest:{"&:hover":{cursor:"grabbing"}}},widthResizer:{position:"absolute",top:20,bottom:0,right:0,width:14,cursor:"ew-resize"},heightResizer:{position:"absolute",left:20,right:20,bottom:0,height:14,cursor:"ns-resize"},widthHeightResizer:{position:"absolute",bottom:0,right:0,width:xe,height:xe,cursor:"nwse-resize"},open:{position:"absolute",top:0,left:0,width:xe,height:xe,padding:2},arrow:{position:"absolute",top:0,right:0,width:xe,height:xe,padding:1},highlightOverlay:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:u.colors.uiPrimaryVeryLight,overflow:"hidden",animation:"".concat(u.animations.fadeIn," 33ms ").concat(u.easings.easeInOutCubic)}})),ke),Oe=function(e){return e instanceof MouseEvent?{x:e.clientX,y:e.clientY}:e.touches.length?{x:e.touches[0].clientX,y:e.touches[0].clientY}:{x:0,y:0}};function Te(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}):""}var Ce=c.memo((function(e){var t=e.id,n=e.conceptId,r=e.color,o=e.mode,a=e.selected,i=e.highlighted,s=e.blink,u=e.allowResizeWidth,f=void 0===u||u,p=e.allowResizeHeight,m=void 0!==p&&p,g=e.dispatchAction,y=e.className,h=e.children,v=(0,c.useRef)(null),x=(0,c.useRef)(null),k=(0,c.useRef)(null),E=(0,c.useRef)(null),O=(0,c.useRef)(null),T=(0,c.useRef)(o),C=(0,c.useState)(!1),S=(0,l.Z)(C,2),I=S[0],P=S[1];(0,c.useLayoutEffect)((function(){return v.current&&U.setElement(t,v.current),function(){return U.detachElement(t)}}),[t]),(0,c.useEffect)((function(){T.current=o}),[o]),(0,c.useEffect)((function(){return function(){T.current===M.Focusing&&g({type:A.BlockSetMode,data:{id:t,mode:M.Idle}})}}),[t,g]);var B=(0,c.useRef)("idle"),z=(0,c.useRef)({x:0,y:0}),R=(0,c.useRef)({x:0,y:0});(0,c.useEffect)((function(){var e=v.current;if(e)return e.addEventListener("mousedown",o),e.addEventListener("touchstart",o),function(){e.removeEventListener("mousedown",o),e.removeEventListener("touchstart",o)};function n(e){if(!(e instanceof MouseEvent&&0!==e.button)){window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),window.removeEventListener("touchcancel",n);var o=z.current;"drawArrow"===B.current&&g({type:A.RelationDrawEnd,data:{id:t,pointerInViewportCoords:o}}),B.current="idle",T.current===M.Moving&&g({type:A.BlockMoveEnd}),T.current!==M.Moving&&T.current!==M.Resizing||g({type:A.BlockSetMode,data:{id:t,mode:M.Idle}})}}function r(e){var n=Oe(e),r=b(n,z.current);switch(z.current=n,B.current){case"ready_to_move":w(n,R.current)>3&&(B.current="move",g({type:A.BlockMoveStart,data:{id:t,pointerInViewportCoords:n}}));break;case"move":g({type:A.BlockMove,data:{id:t,pointerInViewportCoords:n}}),g({type:A.BlockSetMode,data:{id:t,mode:M.Moving}});break;case"resizeW":case"resizeH":case"resizeWH":var o=B.current;g({type:A.BlockResizeDelta,data:{id:t,movementInViewportCoords:{x:"resizeW"===o||"resizeWH"===o?r.x:0,y:"resizeH"===o||"resizeWH"===o?r.y:0}}}),g({type:A.BlockSetMode,data:{id:t,mode:M.Resizing}});break;case"drawArrow":g({type:A.RelationDrawMove,data:{id:t,pointerInViewportCoords:n}})}}function o(e){var o=Oe(e);if(z.current=o,e instanceof MouseEvent&&0!==e.button)return T.current!==M.Focusing&&e.preventDefault(),void(2===e.button&&T.current===M.Idle&&g({type:A.ContextMenuOpen,data:{contextType:N.InferFromPointer,pointerInViewportCoords:o}}));var a=x.current,i=k.current,c=E.current,s=O.current;a&&a.contains(e.target)?B.current="resizeW":i&&i.contains(e.target)?B.current="resizeH":c&&c.contains(e.target)?B.current="resizeWH":s&&s.contains(e.target)?(B.current="drawArrow",g({type:A.RelationDrawStart,data:{id:t,pointerInViewportCoords:o}})):T.current!==M.Focusing&&(B.current="ready_to_move"),window.addEventListener("mousemove",r),window.addEventListener("touchmove",r),window.addEventListener("mouseup",n),window.addEventListener("touchend",n),window.addEventListener("touchcancel",n)}}),[t,g]),(0,c.useEffect)((function(){var e=v.current;if(e)return e.addEventListener("contextmenu",t),function(){e.removeEventListener("contextmenu",t)};function t(e){T.current!==M.Focusing&&e.preventDefault()}}),[]);var j=(0,c.useMemo)((function(){return(0,d.Sh)(y,Ee.block,m&&Ee.fillParentHeight,a&&Ee.selected,o===M.Focusing&&Ee.focusing,o===M.Moving&&Ee.moving)}),[o,a,m,y]),D=(0,c.useCallback)((function(){return P(!0)}),[]),L=(0,c.useCallback)((function(){return P(!1)}),[]),Z=(0,c.useCallback)((function(){g({type:A.BlockOpenAsCanvas,data:{id:n}})}),[n,g]);return c.createElement("div",{ref:v,className:j,"data-color":r,onMouseEnter:D,onMouseLeave:L},h,f&&c.createElement("div",{ref:x,className:Ee.widthResizer}),m&&c.createElement("div",{ref:k,className:Ee.heightResizer}),f&&m&&c.createElement("div",{ref:E,className:Ee.widthHeightResizer}),!I&&s&&c.createElement("div",{className:Ee.blink}),(o===M.Idle||o===M.Focusing)&&I&&c.createElement(c.Fragment,null,c.createElement("div",{className:(0,d.Sh)(Ee.actionButton,Ee.open),onClick:Z},c.createElement(he,null)),c.createElement("div",{ref:O,className:(0,d.Sh)(Ee.actionButton,Ee.arrow)},c.createElement(ye,null))),i&&c.createElement("div",{className:Ee.highlightOverlay}))})),Se=(0,d.F4)({"0%, 100%":{opacity:.8},"50%":{opacity:.4}}),Ie=(0,d.zE)({conceptLoader:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",minWidth:48,minHeight:48,$nest:{"& > div":{width:"0.3rem",height:"0.3rem",margin:"0.125rem",borderRadius:"50%",background:u.colors.neutral60,animation:"".concat(Se," 1.2s ").concat(u.easings.easeOutExpo," infinite")},"& > div:nth-child(1)":{animationDelay:"0s"},"& > div:nth-child(2)":{animationDelay:"-0.4s"},"& > div:nth-child(3)":{animationDelay:"-0.8s"}}}}),Pe=c.memo((function(){return c.createElement("div",{className:Ie.conceptLoader},c.createElement("div",null),c.createElement("div",null),c.createElement("div",null))})),Be=c.memo((function(e){var t=e.block,n=e.concept,r=V(),o=r.db,a=r.dispatchAction,i=r.factoryRegistry,s=(0,c.useCallback)((function(e){a({type:A.BlockSetMode,data:{id:t.id,mode:e}})}),[t.id,a]),l=(0,c.useCallback)((function(){s(M.Focusing)}),[s]),d=(0,c.useCallback)((function(){s(M.Idle)}),[s]),u=(0,c.useCallback)((function(e){a({type:A.ConceptWriteData,data:{id:n.id,type:n.summary.type,content:e}})}),[n.id,n.summary.type,a]),f=(0,c.useCallback)((function(e){a({type:A.ConceptWriteData,data:{id:n.id,type:e,content:{initialized:!1}}})}),[n.id,a]);return i.createConceptDisplay(n.summary.type,{readOnly:t.mode===M.Moving,viewMode:"Block",concept:n,blockId:t.id,dispatchAction:a,factoryRegistry:i,database:o,onChange:u,onReplace:f,onInteractionStart:l,onInteractionEnd:d})})),ze=c.memo((function(e){var t=e.block,n=e.concept;return n?c.createElement(Be,{block:t,concept:n}):c.createElement(Pe,null)})),Me=c.memo((function(e){var t=e.block,n=e.concept,r=V().dispatchAction,o=(0,c.useMemo)((function(){return t.posType>z.Normal?(0,d.oB)({boxShadow:u.shadows.layer,borderRadius:u.borders.largeRadius,background:u.colors.bgCanvasSemiTransparent,backdropFilter:"saturate(180%) blur(30px)"}):void 0}),[t.posType]);return c.createElement(Ce,{id:t.id,conceptId:t.conceptId,color:t.color,mode:t.mode,selected:t.selected,highlighted:t.highlighted,blink:!!n&&H(n),allowResizeWidth:"auto"!==t.size.w,allowResizeHeight:"auto"!==t.size.h,dispatchAction:r,className:o},c.createElement(ze,{block:t,concept:n}))}));function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function De(e){var t=V().db,n=(0,c.useState)(),r=(0,l.Z)(n,2),o=r[0],a=r[1];return(0,c.useEffect)((function(){function n(e){a(e)}return t.getConcept(e).then((function(e){return a(e)})).catch((function(e){throw e})),t.subscribeConcept(e,n),function(){t.unsubscribeConcept(e,n)}}),[e,t]),o}var Ne=(0,d.zE)({ul:{listStyle:"none",margin:0},li:{$nest:{"&-appear":{animation:"".concat(u.animations.fadeIn," 1.4s ").concat(u.easings.easeOutExpo)},"&-enter":{opacity:0},"&-enter-active":{opacity:1,transition:"opacity 0.6s ".concat(u.easings.easeOutExpo)},"&-exit":{opacity:1},"&-exit-active":{opacity:0,transition:"opacity 0.3s ".concat(u.easings.easeOutExpo)}}}});function Le(e){var t=e.blocks,n=e.onRender,o=function(e){var t=V().db,n=(0,c.useState)({}),o=(0,l.Z)(n,2),a=o[0],i=o[1],s=(0,c.useRef)({});return(0,c.useEffect)((function(){s.current=a}),[a]),(0,c.useEffect)((function(){for(var n=[],o=[],a=0;a<e.length;a++){var c=e[a];s.current[c]||(n.push(t.getConcept(c)),o.push(c))}function l(e){e&&i((function(t){return je(je({},t),{},(0,r.Z)({},e.id,e))}))}Promise.all(n).then((function(e){if(0!==e.length){for(var t={},n=0;n<e.length;n++){var r=o[n],a=e[n];t[r]=a}i((function(e){return je(je({},e),t)}))}})).catch((function(e){return console.error(e)}));for(var d=0;d<e.length;d++)t.subscribeConcept(e[d],l);return function(){for(var n=0;n<e.length;n++)t.unsubscribeConcept(e[n],l)}}),[e,t]),a}(t.map((function(e){return e.conceptId})));return(0,c.useEffect)((function(){n&&n()}),[]),c.createElement(c.Fragment,null,t.map((function(e){return c.createElement(pe,{className:Ne.li,key:"vo-b-".concat(e.id),posType:e.posType,pos:e.pos,size:e.size,zIndex:e.zIndex},c.createElement(Me,{block:e,concept:o[e.conceptId]}))})))}var Ae=(0,d.zE)({canvasBase:{position:"absolute",top:0,right:0,bottom:0,left:0}}),Ze=c.memo((function(e){var t=e.dispatchAction,n=e.children,r=(0,c.useRef)(null);(0,c.useEffect)((function(){var e=function(e){e.ctrlKey?(e.preventDefault(),t({type:A.CameraScaleDelta,data:{focus:{x:e.clientX,y:e.clientY},wheelDelta:e.deltaY}})):t({type:A.CameraMoveDelta,data:{x:-e.deltaX,y:-e.deltaY}})},n=function(e){if(e.target===r.current){var n={x:e.clientX,y:e.clientY};t({type:A.ConceptCreate,data:{posType:z.Normal,intent:Z.ExactAt,pointerInViewportCoords:n}})}},o=function(){var e=!1,n=!1,o={x:0,y:0};function a(){e=!1,n&&(t({type:A.SelectionBoxClear}),n=!1),window.removeEventListener("mouseup",a),window.removeEventListener("touchend",a)}return{handlePointerDown:function(i){var c=Oe(i);i instanceof MouseEvent?0===i.button?i.target===r.current&&(t({type:A.SelectionBoxSetStart,data:c}),n=!0):1===i.button&&(e=!0):i.target===r.current&&2===i.touches.length&&(e=!0),o=c,window.addEventListener("mouseup",a),window.addEventListener("touchend",a)},handlePointerMove:function(r){var a=Oe(r);if(e){var i=b(a,o);t({type:A.CameraMoveDelta,data:i})}else n&&t({type:A.SelectionBoxSetEnd,data:a});o=a},handleKeydown:function(e){e.altKey&&"n"===e.key?t({type:A.ConceptCreate,data:{posType:z.Normal,intent:Z.ExactAt,pointerInViewportCoords:o}}):"Delete"!==e.key&&"Backspace"!==e.key||t({type:A.BlockRemove,data:{}})}}}(),a=r.current;if(a)return a.addEventListener("wheel",e),a.addEventListener("dblclick",n),a.addEventListener("mousedown",o.handlePointerDown),a.addEventListener("touchstart",o.handlePointerDown),window.addEventListener("keydown",o.handleKeydown),window.addEventListener("mousemove",o.handlePointerMove),window.addEventListener("touchmove",o.handlePointerMove),function(){a.removeEventListener("wheel",e),a.removeEventListener("dblclick",n),a.removeEventListener("mousedown",o.handlePointerDown),a.removeEventListener("touchstart",o.handlePointerDown),window.removeEventListener("keydown",o.handleKeydown),window.removeEventListener("mousemove",o.handlePointerMove),window.removeEventListener("touchmove",o.handlePointerMove)}}),[t]);var o=(0,c.useRef)({x:0,y:0}),a=(0,c.useRef)(!1),i=(0,c.useRef)({x:0,y:0}),s=(0,c.useRef)(!1);return(0,c.useEffect)((function(){function e(e){o.current=Oe(e),a.current=1===e.button}function t(e){var t=Oe(e);i.current=t,a.current&&w(t,o.current)>3&&(s.current=!0)}function n(){o.current={x:0,y:0},a.current=!1,setTimeout((function(){s.current=!1}),100)}return window.addEventListener("mousedown",e),window.addEventListener("mousemove",t),window.addEventListener("mouseup",n),function(){window.removeEventListener("mousedown",e),window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)}}),[]),(0,c.useEffect)((function(){function e(){t({type:A.BlockCut})}function n(){s.current?s.current=!1:t({type:A.BlockPaste,data:{pointerInViewportCoords:i.current}})}return document.addEventListener("cut",e),document.addEventListener("paste",n),function(){document.removeEventListener("cut",e),document.removeEventListener("paste",n)}}),[t]),c.createElement("div",{ref:r,className:Ae.canvasBase},n)}));function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e={outline:"none",border:"none",borderRadius:u.borders.smallRadius,padding:".3rem .5rem",fontSize:".875rem",lineHeight:"1.25rem",transition:"background 30ms ease-in-out",cursor:"pointer"},_e=Fe(Fe({},$e),{},{color:u.colors.uiText,background:"transparent",$nest:{"&:hover":{background:u.colors.bgHover},"&:active":{background:u.colors.bgActive}}}),Ve=Fe(Fe({},$e),{},{color:"rgb(230, 226, 217, 0.95)",background:"rgba(29, 28, 22, 0.75)",$nest:{"&:hover":{color:"rgb(245, 240, 231)",background:"rgba(29, 28, 22, 0.85)"},"&:active":{color:"rgb(245, 240, 231)",background:"rgba(29, 28, 22, 0.95)"}}}),We=Fe(Fe({},$e),{},{color:u.colors.uiText,background:u.colors.uiPrimaryAttractive,$nest:{"&:hover":{background:u.colors.uiPrimaryAttractiveHover},"&:active":{background:u.colors.uiPrimaryAttractiveActive}}}),Ke={outline:"none",border:"none",borderRadius:u.borders.smallRadius,padding:".3rem .5rem",background:u.colors.neutral95,lineHeight:"normal"},Je=Fe(Fe({},Ke),{},{background:"transparent"}),Ge={padding:u.paddings.navComfort,fontSize:".8rem"},Ue={padding:".3rem",color:u.colors.contentText,background:u.colors.bgBlock,boxShadow:u.shadows.float,borderRadius:u.borders.smallRadius,animation:"".concat(u.animations.fadeIn," 200ms ").concat(u.easings.easeInOutCubic)},Ye={padding:".3rem .5rem",fontSize:".7rem",color:u.colors.neutral50},Xe=Fe(Fe({},_e),{},{color:u.colors.contentText,width:"100%",padding:".25rem .5rem",fontSize:".875rem",textAlign:"left",borderRadius:u.borders.smallRadius,cursor:"pointer"});function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et=1.75,tt={height:"".concat(et,"rem"),fontSize:"0.9rem",outline:"none",border:"none",borderRadius:u.borders.smallRadius,color:u.colors.contentText,background:u.colors.bgBlock,cursor:"pointer",transition:"background 30ms ".concat(u.easings.easeInOutCubic),$nest:{"&:hover":{background:u.colors.bgHover},"&:active":{background:u.colors.bgActive}}},nt=(0,d.zE)({ContextMenu:Qe(Qe({},Ue),{},{width:"calc(".concat(et,"rem * 6 + 1.1rem)")}),Title:Qe({},Ye),TileButtonGroup:{padding:".3rem .25rem"},TileButton:Qe(Qe({},tt),{},{padding:".25rem",width:"".concat(et,"rem")}),ListButton:Qe({},Xe),ColorTile:{width:"100%",height:"100%",background:u.colors.bgBlock,borderRadius:u.borders.smallRadius,$nest:Qe((0,r.Z)({},'&[data-color="default"]',{border:"1px solid ".concat(u.colors.neutral90)}),de.$nest)},Danger:{color:u.colors.uiDanger,$nest:{"&:hover":{background:u.colors.bgDangerHover},"&:active":{background:u.colors.bgDangerActive}}},InfoLines:{fontSize:"0.68rem",padding:".3rem .5rem"}}),rt=(0,d.zE)({InfoLine:{$nest:{"&, & > *":{userSelect:"text"}}},Label:{color:u.colors.neutral40},Value:{color:u.colors.contentText}});function ot(e){var t=e.label,n=e.value;return c.createElement("div",{className:rt.InfoLine},c.createElement("span",{className:rt.Label},t)," ",c.createElement("span",{className:rt.Value},n))}var at=(0,d.zE)({section:{$nest:{"&:not(:first-of-type)":{marginTop:"0.3rem"}}}});function it(e){var t=e.children;return c.createElement("div",{className:at.section},t)}var ct=(0,c.createContext)(null);function st(){var e=(0,c.useContext)(ct);if(e)return e;throw new LifecycleError("useSettings() must be called within a Provider")}function lt(e){var t=function(e){var t="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[t?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;return n.style.top="".concat(r,"px"),n.setAttribute("readonly",""),n.value=e,n}(e);document.body.appendChild(t),t.select(),t.setSelectionRange(0,t.value.length),document.execCommand("copy"),t.remove()}function dt(e){return"jade://v1/concept/".concat(e.id)}function ut(e){var t=e.split("/"),n=t.findIndex((function(e){return"concept"===e}));return{conceptId:t[n+1],blockId:t[n+2]}}function ft(e){return e.startsWith("jade://")}var pt,mt=c.forwardRef((function(e,t){var n=e.context.block,r=$(),o=r.selectedBlockIds,a=r.viewingConcept,i=st(),s=V().dispatchAction,l=De(n.conceptId),u=(0,c.useCallback)((function(e){s({type:A.BlockSetColor,data:{id:n.id,color:e}})}),[n.id,s]),f=(0,c.useCallback)((function(){s({type:A.BlockRemove,data:{id:n.id}}),s({type:A.ContextMenuClose})}),[n.id,s]),p=(0,c.useCallback)((function(){var e=le(n,1);e&&s({type:A.CameraSetValue,data:{focus:e,scale:1}}),s({type:A.ContextMenuClose})}),[n,s]),m=(0,c.useCallback)((function(){var e=function(e,t){return"jade://v1/concept/".concat(e.id,"/").concat(t.id)}(a,n);lt(e),s({type:A.ContextMenuClose})}),[n,a,s]),b=(0,c.useCallback)((function(){s({type:A.BlockCut}),s({type:A.ContextMenuClose})}),[s]),g=o.includes(n.id)?o.length:1,y=g>1,h="".concat(y?g:"the"," block").concat(y?"s":""),v=(0,c.useMemo)((function(){return[{title:"Cut ".concat(h),perform:b},{title:"Delete ".concat(h),perform:f},{title:"Focus ".concat(h),perform:p},{title:"Copy link",perform:m}]}),[p,m,f,b,h]);return c.createElement("div",{ref:t,className:nt.ContextMenu},c.createElement(it,null,c.createElement("div",{className:nt.Title},"BACKGROUND"),c.createElement("div",{className:nt.TileButtonGroup},c.createElement("button",{key:"default",className:nt.TileButton,onClick:function(){return u(void 0)}},c.createElement("div",{className:nt.ColorTile,"data-color":"default"})),Object.values(R).map((function(e){return c.createElement("button",{key:e,className:nt.TileButton,onClick:function(){return u(e)}},c.createElement("div",{className:nt.ColorTile,"data-color":e}))})))),c.createElement(it,null,c.createElement("div",{className:nt.Title},"ACTION"),v.map((function(e){return c.createElement("button",{key:e.title,className:(0,d.Sh)(nt.ListButton,e.danger&&nt.Danger),onClick:e.perform},e.title)}))),c.createElement(it,null,c.createElement("div",{className:nt.Title},"INFO"),c.createElement("div",{className:nt.InfoLines},c.createElement(ot,{label:"Created",value:Te(null==l?void 0:l.createdTime)}),c.createElement(ot,{label:"Updated",value:Te(null==l?void 0:l.lastEditedTime)}),i.shouldEnableDevMode&&c.createElement(c.Fragment,null,c.createElement(ot,{label:"Widget Type",value:null!=l&&l.references.length?"Canvas":"Block"}),c.createElement(ot,{label:"Widget ID",value:n.id}),c.createElement(ot,{label:"Content Type",value:null==l?void 0:l.summary.type}),c.createElement(ot,{label:"Content ID",value:n.conceptId})," "))))})),bt=c.forwardRef((function(e,t){var n=e.context,r=n.relation,o=n.fromBlock,a=n.toBlock,i=V().dispatchAction,s=(0,c.useCallback)((function(){i({type:A.RelationRemove,data:{id:r.id}}),i({type:A.ContextMenuClose})}),[r.id,i]),l=(0,c.useCallback)((function(){var e,t,n,r=(1,e=C(S(T([ae(o),ae(a)]),10)),t=window.innerWidth,n=window.innerHeight,{x:e.x-t/2/1,y:e.y-n/2/1});i({type:A.CameraSetValue,data:{focus:r,scale:1}}),i({type:A.ContextMenuClose})}),[o,a,i]),u=(0,c.useCallback)((function(){console.log(r),i({type:A.ContextMenuClose})}),[r,i]),f=(0,c.useMemo)((function(){return[{title:"Delete arrow",perform:s},{title:"Focus arrow",perform:l},{title:"Copy link",perform:u}]}),[s,l,u]);return c.createElement("div",{ref:t,className:nt.ContextMenu},c.createElement(it,null,c.createElement("div",{className:nt.Title},"ACTION"),f.map((function(e){return c.createElement("button",{key:e.title,className:(0,d.Sh)(nt.ListButton,e.danger&&nt.Danger),onClick:e.perform},e.title)}))),c.createElement(it,null,c.createElement("div",{className:nt.Title},"INFO"),c.createElement("div",{className:nt.InfoLines},c.createElement(ot,{label:"ID",value:r.id}),c.createElement(ot,{label:"Type",value:r.type}))))}));function gt(){var e=$(),t=V().dispatchAction,n=(0,c.useRef)(null),r=e.contextMenuState.context;if((0,c.useEffect)((function(){function e(){t({type:A.ContextMenuClose})}function r(t){var r;t instanceof MouseEvent&&2===t.button||null!==(r=n.current)&&void 0!==r&&r.contains(t.target)||e()}return window.addEventListener("mousedown",r),window.addEventListener("touchstart",r),window.addEventListener("resize",e),window.addEventListener("wheel",e),function(){window.removeEventListener("mousedown",r),window.removeEventListener("touchstart",r),window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[t]),!r)return c.createElement("div",{className:nt.ContextMenu},c.createElement("div",{className:nt.Title},"Something is wrong. Cannot find entities to operate on."));switch(r.type){case pt.Block:return c.createElement(mt,{ref:n,context:r});case pt.Relation:return c.createElement(bt,{ref:n,context:r})}}function yt(e){var t=e.blocks,n=e.camera,r=e.shouldRenderOnlyVisible,o=e.selectBlock,a=e.onRender,i=(0,c.useMemo)((function(){if(!r)return t.filter(o);var e=window.innerWidth,a=window.innerHeight,i={x:n.focus.x-0,y:n.focus.y-0,w:e/n.scale+0,h:a/n.scale+0},c=t.map((function(e){return U.getMeasuredSize(e.id)}));return t.filter((function(e,t){var n=c[t];return o(e)&&(!n||x({x:e.pos.x,y:e.pos.y,w:"number"==typeof e.size.w?e.size.w:n.width,h:"number"==typeof e.size.h?e.size.h:n.height},i))}))}),[t,n,r,o]);return c.createElement(Le,{blocks:i,onRender:a})}function ht(e){return c.createElement("div",null,e.children)}!function(e){e[e.Block=0]="Block",e[e.Relation=1]="Relation"}(pt||(pt={}));var vt=n(1472),wt=(0,d.zE)({SelectionBox:{border:"2px solid ".concat(u.colors.uiPrimaryLight),borderRadius:u.borders.smallRadius,background:u.colors.uiPrimaryVeryLight}});function xt(e){var t=e.style;return c.createElement("div",{className:wt.SelectionBox,style:t})}var kt=(0,d.zE)({origin:{width:0,height:0,transformOrigin:"top left",position:"absolute",top:0,left:0}});function Et(e){var t=e.focus,n=e.scale,r=e.selecting,o=e.selectionBox,a=e.shouldAnimate,i=e.children,s="translate3d(".concat(-t.x*n,"px, ").concat(-t.y*n,"px, 0px) scale(").concat(n,")"),l=(0,vt.useSpring)({transform:s,config:{frequency:.3,damping:1}});return c.createElement(vt.animated.div,{className:kt.origin,style:{transform:a?l.transform:s}},i,r&&c.createElement(xt,{key:"SelectionBox",style:{width:o.w,height:o.h,position:"absolute",transformOrigin:"top left",transform:"translate3d(".concat(o.x,"px, ").concat(o.y,"px, 0px)"),zIndex:99999999}}))}var Ot,Tt=n(7462),Ct=n(4925),St=["children","className"],It=(0,d.zE)({overlay:{position:"absolute",top:0,bottom:0,left:0,right:0,zIndex:1,pointerEvents:"none"},overlayChildren:{width:0,height:0,pointerEvents:"auto"}}),Pt=c.forwardRef((function(e,t){var n=e.children,r=e.className,o=(0,Ct.Z)(e,St);return c.createElement("div",(0,Tt.Z)({className:(0,d.Sh)(It.overlay,r)},o),c.createElement("div",{className:It.overlayChildren,ref:t},n))})),Bt=c.memo(Pt);function zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rt(e){var t=e.near,n=e.children,r=(0,c.useRef)(null),o=(0,c.useState)(!1),a=(0,l.Z)(o,2),i=a[0],s=a[1],d=(0,c.useState)({top:0,left:0}),u=(0,l.Z)(d,2),f=u[0],p=u[1];return(0,c.useEffect)((function(){if(r.current){var e=window.innerWidth,n=window.innerHeight,o=r.current.getBoundingClientRect(),a=t.bottom+o.height>n?{bottom:n-t.top}:{top:t.bottom},i=t.right+o.width>e?{right:e-t.right}:{left:t.right};p(Mt(Mt({},a),i)),s(!0)}}),[t]),c.createElement("div",{ref:r,style:Mt(Mt({position:"absolute"},f),{},{visibility:i?"visible":"hidden"})},n)}function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Dt({id:(0,K.Z)(),summary:{type:e,data:{}},references:[],relations:[],drawing:[],camera:{focus:{x:0,y:0},scale:1},createdTime:Date.now(),lastEditedTime:Date.now()},t)}function Lt(e,t){return Dt(Dt(Dt({},e),t),{},{lastEditedTime:Object.prototype.hasOwnProperty.call(t,"summary")?Date.now():e.lastEditedTime})}function At(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?At(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):At(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ht(e,t){return!!e.find((function(e){return e.type===t.type&&e.fromEntity===t.fromEntity&&e.fromId===t.fromId&&e.toEntity===t.toEntity&&e.toId===t.toId}))}function Ft(e){return"block-to-block-in-canvas"===e.type&&e.fromEntity===L.Block&&e.toEntity===L.Block}function $t(e,t){var n=t.map((function(e){return e.id}));return e.filter((function(e){return n.includes(e.fromId)&&n.includes(e.toId)}))}function _t(e,t,n){for(var r={value:e,guideline:void 0},o=0;o<t.length;o+=1){var a=t[o],i=Math.abs(e-a.valueOf());i<n&&(n=i,r={value:a.valueOf(),guideline:a})}return r}function Vt(e,t,n){for(var r=[],o=[],a=function(a){var i=t[a],c={x:i.x-n,y:i.y-n,w:i.w+2*n,h:i.h+2*n};x(e,c)&&(r.push({valueOf:function(){return i.y},fromSide:Ot.Top},{valueOf:function(){return i.y+i.h},fromSide:Ot.Bottom}),o.push({valueOf:function(){return i.x},fromSide:Ot.Left},{valueOf:function(){return i.x+i.w},fromSide:Ot.Right}))},i=0;i<t.length;i+=1)a(i);return{horizontalGuidelines:r,verticalGuidelines:o}}function Wt(e,t){switch(t.contextType){case N.InferFromPointer:return function(e,t){var n=e.camera,r=e.blocks,o=se(E(t.pointerInViewportCoords,n),r,n);return o?{type:pt.Block,block:o}:void 0}(e,t);case N.Relation:return function(e,t){var n=e.viewingConcept,r=e.blocks,o=n.relations.find((function(e){return t===e.id}));if(o){var a=r.find((function(e){return o.fromId===e.id})),i=r.find((function(e){return o.toId===e.id}));return a&&i&&{type:pt.Relation,relation:o,fromBlock:a,toBlock:i}}}(e,t.relationId)}}function Kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.Top="top",e.Right="right",e.Bottom="bottom",e.Left="left"}(Ot||(Ot={}));var Gt="core/store/reducer:";function Ut(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,[Gt].concat(n))}function Yt(e,t,n){return Xt.apply(this,arguments)}function Xt(){return(Xt=(0,o.Z)(i().mark((function e(t,n,r){var o,a,c,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e,t){if(!r)return Q(e,t);var n=r.find((function(t){return t.id===e.id}));return n?(n.conceptId=e.to,n.posType=e.posType,n.pos=e.pos,n.size=e.size,n.color=e.color,n.lastEditedTime=e.lastEditedTime,n):Q(e,t)},e.next=3,n.getConcept("__tool_mask__");case 3:return a=e.sent,c=a?a.references.map(o):[],s=t.references.map(o),e.abrupt("return",c.concat(s));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qt(){return(qt=(0,o.Z)(i().mark((function e(t){var n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ut("Loading app state"),n=t.getSettings(),e.next=4,t.getConcept(n.viewingConceptId);case 4:if(r=e.sent){e.next=7;break}throw new Error("".concat(Gt," Viewing concept is broken"));case 7:return e.next=9,Yt(r,t);case 9:return o=e.sent,e.abrupt("return",{settings:n,viewingConcept:r,expandHistory:new Array(99).concat(r.id),camera:r.camera,shouldAnimateCamera:!1,selecting:!1,selectionBoxStart:{x:0,y:0},selectionBoxEnd:{x:0,y:0},selectionBox:{x:0,y:0,w:0,h:0},pointerOffsetInLeaderBox:{x:0,y:0},selectedBlockIds:[],blocks:o,blocksRendered:!1,relations:$t(r.relations.filter((function(e){return Ft(e)})),o),drawingRelation:!1,drawingRelationFromBlockId:"",drawingRelationToPoint:{x:0,y:0},contextMenuState:{shouldShow:!1,pos:{x:0,y:0},context:void 0},clipboard:[]});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tn={w:0,h:0},nn=c.memo((function(){var e=$(),t=V(),n=t.dispatchAction,r=t.createOverlay,o=st(),a=(0,c.useCallback)((function(){n({type:A.BlocksRendered})}),[n]),i=(0,c.useCallback)((function(e){return e.posType===z.Normal}),[]),s=e.blocks.filter((function(e){return e.posType>z.Normal})),l=(0,c.useMemo)((function(){return{top:e.contextMenuState.pos.y,left:e.contextMenuState.pos.x,bottom:e.contextMenuState.pos.y,right:e.contextMenuState.pos.x}}),[e.contextMenuState.pos]);return c.createElement("div",{className:(0,d.Sh)(f.app,fe(e.blocks)&&f.movingBlocks,e.blocks.find((function(e){return e.mode===M.Resizing}))&&f.resizingBlocks,e.drawingRelation&&f.drawingRelation)},c.createElement(Ze,{dispatchAction:n},c.createElement(Et,{focus:e.camera.focus,scale:e.camera.scale,selecting:e.selecting,selectionBox:e.selectionBox,shouldAnimate:e.shouldAnimateCamera},e.blocksRendered&&c.createElement(be,null),c.createElement(yt,{key:e.viewingConcept.id,blocks:e.blocks,camera:e.camera,shouldRenderOnlyVisible:o.shouldEnableEfficientRendering,selectBlock:i,onRender:a}),e.blocksRendered&&e.drawingRelation&&function(){var t=oe(e.blocks,e.drawingRelationFromBlockId);if(t){var n=ae(t),r=en(en({},e.drawingRelationToPoint),{},{w:0,h:0}),o=S(T([n,r]),10);return c.createElement(pe,{key:"drawingRelation",posType:z.Normal,pos:o,size:tn},c.createElement(D,{fromBox:n,toBox:r,viewBox:o,color:u.colors.uiPrimaryHarder,size:u.arrowSize}))}}())),c.createElement(ht,null,c.createElement(Le,{blocks:s})),e.contextMenuState.shouldShow&&r(c.createElement(Rt,{near:l},c.createElement(gt,null))))}));function rn(e){var t=e.db,n=e.factoryRegistry,r=e.openExternal,a=(0,c.useMemo)((function(){return function(e,t){var n={w:300,h:"auto"},r="",a={w:0,h:0};return function(){var c=(0,o.Z)(i().mark((function o(c,s){var l,d,u,f,y,h,v,w,x,O,T,C,S,I,P,B,R,j,D,N,H,F,$,_,V,W,J,G,Y,X,ne,ce,de,pe,me,be,ge,ye,he,ve,we,xe,ke,Ee,Oe,Te,Ce,Se,Ie,Pe,Be,ze,Me,Re,je,De,Ne,Le,Ae,Ze,He,Fe,$e,_e,Ve,We,Ke,Je,Ge,Ue,Ye,Xe,qe,Qe,et,tt,nt,rt,ot,at,it,ct,st,lt,dt,ut,ft,mt,bt,gt,yt,ht,vt,wt,xt,kt,Et,Tt,Ct,St,It,Pt,Bt,zt,Mt,Rt,jt,Dt,At,Ft,$t,Kt,Gt,Ut,Xt,qt,Qt,en,tn,nn,rn,on,an,cn,sn,ln,dn,un,fn,pn,mn,bn,gn,yn,hn,vn,wn,xn,kn,En,On,Tn,Cn,Sn,In,Pn,Bn,zn,Mn,Rn,jn,Dn,Nn,Ln,An,Zn,Hn,Fn,$n,_n,Vn,Wn,Kn,Jn,Gn,Un,Yn,Xn,qn,Qn,er,tr,nr,rr,or,ar,ir,cr,sr,lr,dr,ur,fr,pr,mr,br,gr,yr,hr,vr,wr,xr,kr,Er,Or,Tr;return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:o.t0=s.type,o.next=o.t0===A.ConceptCreate?3:o.t0===A.ConceptWriteData?16:o.t0===A.BlockCreate?30:o.t0===A.BlockRemove?42:o.t0===A.BlockCut?61:o.t0===A.BlockPaste?75:o.t0===A.BlockMoveStart?87:o.t0===A.BlockMove?98:o.t0===A.BlockMoveEnd?123:o.t0===A.BlockResizeDelta?124:o.t0===A.BlockSetMode?150:o.t0===A.BlockSetColor?153:o.t0===A.BlockSetSize?162:o.t0===A.BlockSelect?172:o.t0===A.BlockDeselect?176:o.t0===A.BlockDeselectAll?177:o.t0===A.BlockOpenAsCanvas?178:o.t0===A.SelectionBoxSetStart?226:o.t0===A.SelectionBoxSetEnd?228:o.t0===A.SelectionBoxClear?234:o.t0===A.CameraMoveDelta?235:o.t0===A.CameraScaleDelta?248:o.t0===A.CameraSetValue?260:o.t0===A.RelationDrawStart?265:o.t0===A.RelationDrawMove?268:o.t0===A.RelationDrawEnd?273:o.t0===A.RelationRemove?282:o.t0===A.SettingsSet?287:o.t0===A.NavigateBack?291:o.t0===A.BlocksRendered?315:o.t0===A.ContextMenuOpen?316:o.t0===A.ContextMenuClose?323:324;break;case 3:if(l=s.data.posType,d=c.camera,u=c.blocks,f=t.getDefaultContentFactory().id,y=Nt(f),h=function(){switch(s.data.intent){case Z.ExactAt:return Jt(Jt({},E(s.data.pointerInViewportCoords,d)),n);case Z.Below:var e,t=s.data.blockId,r=null===(e=oe(u,t))||void 0===e?void 0:e.pos,o=U.getMeasuredSize(t);return r&&o&&{x:r.x,y:r.y+o.height+5,w:o.width,h:n.h};case Z.Above:var a,i=s.data.blockId,c=null===(a=oe(u,i))||void 0===a?void 0:a.pos,l=U.getMeasuredSize(i);return c&&l&&{x:c.x,y:c.y-5-("auto"===n.h?50:n.h),w:l.width,h:n.h};case Z.LeftOf:var f,p=s.data.blockId,m=null===(f=oe(u,p))||void 0===f?void 0:f.pos,b=U.getMeasuredSize(p);return m&&b&&{x:m.x-5-n.w,y:m.y,w:b.width,h:n.h};case Z.RightOf:var g,y=s.data.blockId,h=null===(g=oe(u,y))||void 0===g?void 0:g.pos,v=U.getMeasuredSize(y);return h&&v&&{x:h.x+v.width+5,y:h.y,w:v.width,h:n.h}}}(),h){o.next=10;break}return o.abrupt("return",c);case 10:return v=q({to:y.id,posType:l,pos:h,size:h}),w=Q(v,u.length),x=Lt(c.viewingConcept,{references:c.viewingConcept.references.concat(v)}),e.createConcept(y),e.updateConcept(x),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:x,blocks:ie(c.blocks).concat(w),selectedBlockIds:[]}));case 16:return O=s.data.type,T=s.data.content,o.next=20,e.getConcept(s.data.id);case 20:if(C=o.sent){o.next=23;break}throw new Error("Trying to write data to broken concept");case 23:if(S=Lt(C,{summary:{type:O,data:T}}),e.updateConcept(S),s.data.id!==c.viewingConcept.id){o.next=29;break}return o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:S}));case 29:return o.abrupt("return",c);case 30:return I=q({to:s.data.id,posType:z.Normal,pos:s.data.position,size:n}),P=Lt(c.viewingConcept,{references:c.viewingConcept.references.concat([I])}),e.updateConcept(P),o.t1=Jt,o.t2=Jt({},c),o.t3={},o.t4=P,o.next=39,Yt(P,e);case 39:return o.t5=o.sent,o.t6={viewingConcept:o.t4,blocks:o.t5},o.abrupt("return",(0,o.t1)(o.t2,o.t3,o.t6));case 42:if(B=c.blocks,R=c.selectedBlockIds,j=s.data.id,D=j&&B.find((function(e){return j===e.id})),!B.find((function(e){return e.mode===M.Focusing}))){o.next=47;break}return o.abrupt("return",c);case 47:return N=function(e){return D?D.selected?R.includes(e):e===D.id:R.includes(e)},H=Lt(c.viewingConcept,{references:c.viewingConcept.references.filter((function(e){return!N(e.id)})),relations:c.viewingConcept.relations.filter((function(e){return!N(e.fromId)&&!N(e.toId)}))}),e.updateConcept(H),U.deleteBlocks(B.filter((function(e){return N(e.id)})).map((function(e){return e.id}))),o.t7=Jt,o.t8=Jt({},c),o.t9={},o.t10=H,o.t11=H.relations,o.next=58,Yt(H,e);case 58:return o.t12=o.sent,o.t13={viewingConcept:o.t10,relations:o.t11,blocks:o.t12},o.abrupt("return",(0,o.t7)(o.t8,o.t9,o.t13));case 61:if(F=c.blocks,$=c.selectedBlockIds,_=c.viewingConcept,!F.find((function(e){return e.mode!==M.Idle}))){o.next=64;break}return o.abrupt("return",c);case 64:if(0!==$.length){o.next=66;break}return o.abrupt("return",c);case 66:return V={},F.forEach((function(e){return V[e.id]=e})),W=$.map((function(e){var t=U.getMeasuredSize(e),n=V[e];return{left:n.pos.x,right:n.pos.x+((null==t?void 0:t.width)||0),top:n.pos.y,bottom:n.pos.y+((null==t?void 0:t.height)||0)}})),i=W,J={top:Math.min.apply(Math,(0,p.Z)(i.map((function(e){return e.top})))),right:Math.max.apply(Math,(0,p.Z)(i.map((function(e){return e.right})))),bottom:Math.max.apply(Math,(0,p.Z)(i.map((function(e){return e.bottom})))),left:Math.min.apply(Math,(0,p.Z)(i.map((function(e){return e.left}))))},G={x:(J.left-J.right)/2,y:(J.top-J.bottom)/2},Y={x:J.left,y:J.top},X=Lt(_,{references:_.references.filter((function(e){return!$.includes(e.id)})),relations:_.relations.filter((function(e){return!$.includes(e.fromId)&&!$.includes(e.toId)}))}),e.updateConcept(X),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:X,blocks:F.filter((function(e){return!e.selected})),relations:X.relations,selectedBlockIds:[],clipboard:c.clipboard.concat({pasteOffset:G,blocks:F.filter((function(e){return e.selected})).map((function(e){return Jt(Jt({},e),{},{pos:b(e.pos,Y)})})).map(te),relations:c.relations.filter((function(e){return $.includes(e.fromId)&&$.includes(e.toId)}))})}));case 75:if(ne=s.data.pointerInViewportCoords,ce=c.blocks,de=c.camera,pe=c.clipboard,me=c.viewingConcept,be=pe.pop()){o.next=80;break}return o.abrupt("return",c);case 80:return ge=E(ne,de),ye=m(ge,be.pasteOffset),he=be.blocks.map((function(e){return Jt(Jt({},e),{},{pos:m(e.pos,ye)})})),ve=Lt(me,{references:me.references.concat(he),relations:me.relations.concat(be.relations)}),e.updateConcept(ve),we=he.map((function(e,t){return ee(Q(e,ce.length+t),{selected:!0})})),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:ve,blocks:c.blocks.concat(we),relations:c.relations.concat(be.relations),selectedBlockIds:we.map((function(e){return e.id}))}));case 87:if(ke=s.data,Ee=ke.id,Oe=ke.pointerInViewportCoords,Te=c.blocks,Ce=c.selectedBlockIds,Se=c.camera,(null===(xe=Te.find((function(e){return Ee===e.id})))||void 0===xe?void 0:xe.posType)===z.Normal){o.next=92;break}return console.warn("reducer/BlockMoveStart: No support for moving non-normal positioned blocks."),o.abrupt("return",c);case 92:if(Ie=Ce.length&&Ce.includes(Ee)?Ce:[Ee],Pe=Te.find((function(e){return Ee===e.id})),Be=E(Oe,Se),Pe){o.next=97;break}return o.abrupt("return",c);case 97:return o.abrupt("return",Jt(Jt({},c),{},{blocks:ue(Ie,Te).map((function(e){return ee(e,{selected:Ie.includes(e.id)})})),selectedBlockIds:Ie,pointerOffsetInLeaderBox:b(Be,Pe.pos)}));case 98:if(Me=s.data,Re=Me.id,je=Me.pointerInViewportCoords,De=c.selectedBlockIds,Ne=c.blocks,Le=c.camera,Ae=c.pointerOffsetInLeaderBox,(null===(ze=Ne.find((function(e){return Re===e.id})))||void 0===ze?void 0:ze.posType)===z.Normal){o.next=103;break}return console.warn("reducer: No support for moving non-normal positioned blocks."),o.abrupt("return",c);case 103:if(Ze=E(je,Le),He=Ne.find((function(e){return Re===e.id}))){o.next=107;break}return o.abrupt("return",c);case 107:return Fe=ae(He),$e=b(Ze,Ae),_e=function(e){return He.selected?De.includes(e):e===He.id},Ve=Ne.filter((function(e){return!_e(e.id)&&e.posType===z.Normal})).map((function(e){var t=U.getMeasuredSize(e.id);return{x:e.pos.x,y:e.pos.y,w:"number"==typeof e.size.w?e.size.w:(null==t?void 0:t.width)||0,h:"number"==typeof e.size.h?e.size.h:(null==t?void 0:t.height)||0}})),We=Vt(Fe,Ve,36),Ke=We.horizontalGuidelines,Je=We.verticalGuidelines,Ge={left:_t($e.x,Je,12),top:_t($e.y,Ke,12),right:_t($e.x+Fe.w,Je,12),bottom:_t($e.y+Fe.h,Ke,12)},Ue=Ge.left.guideline&&Ge.right.guideline?Math.abs($e.x-Ge.left.value)<Math.abs($e.x+Fe.w-Ge.right.value)?"left":"right":Ge.left.guideline?"left":"right",Ye=Ge.top.guideline&&Ge.bottom.guideline?Math.abs($e.y-Ge.top.value)<Math.abs($e.y+Fe.h-Ge.bottom.value)?"top":"bottom":Ge.top.guideline?"top":"bottom",Xe={x:"right"===Ue?Ge.right.guideline&&Ge.right.guideline.fromSide===Ot.Left?Ge.right.value-5-Fe.w:Ge.right.value-Fe.w:Ge.left.guideline&&Ge.left.guideline.fromSide===Ot.Right?Ge.left.value+5:Ge.left.value,y:"bottom"===Ye?Ge.bottom.guideline&&Ge.bottom.guideline.fromSide===Ot.Top?Ge.bottom.value-5-Fe.h:Ge.bottom.value-Fe.h:Ge.top.guideline&&Ge.top.guideline.fromSide===Ot.Bottom?Ge.top.value+5:Ge.top.value},qe={x:Xe.x-He.pos.x,y:Xe.y-He.pos.y},Qe=Lt(c.viewingConcept,{references:c.viewingConcept.references.map((function(e){return _e(e.id)?Jt(Jt({},e),{},{pos:m(e.pos,qe)}):e}))}),e.updateConcept(Qe),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Qe,blocks:ue([Re],Ne).map((function(e){return Jt(Jt({},e),{},{pos:_e(e.id)?m(e.pos,qe):e.pos})}))}));case 123:return o.abrupt("return",Jt(Jt({},c),{},{pointerOffsetInLeaderBox:{x:0,y:0},blocks:c.blocks.map((function(e){return ee(e,{highlighted:!1})}))}));case 124:if(et=s.data,tt=et.id,nt=et.movementInViewportCoords,rt=c.camera,ot=c.blocks,at=c.selectedBlockIds,it=ot.find((function(e){return e.id===tt}))){o.next=129;break}return o.abrupt("return",c);case 129:if(ct=U.getMeasuredSize(tt)){o.next=132;break}return o.abrupt("return",c);case 132:return st=it.size,a=r!==tt?{w:"number"==typeof st.w?st.w+nt.x/rt.scale:ct.width,h:"number"==typeof st.h?st.h+nt.y/rt.scale:ct.height}:{w:"number"==typeof a.w?a.w+nt.x/rt.scale:a.w,h:"number"==typeof a.h?a.h+nt.y/rt.scale:a.h},r=tt,lt=Jt(Jt({},it.pos),a),dt=function(e){return it.selected?at.includes(e):e===it.id},ut=ot.filter((function(e){return!dt(e.id)&&e.posType===z.Normal})).map((function(e){var t=U.getMeasuredSize(e.id);return Jt(Jt({},e.pos),{},{w:"number"==typeof e.size.w?e.size.w:(null==t?void 0:t.width)||0,h:"number"==typeof e.size.h?e.size.h:(null==t?void 0:t.height)||0})})),ft=36/rt.scale,mt=Vt(lt,ut,ft),bt=mt.horizontalGuidelines,gt=mt.verticalGuidelines,yt=12/rt.scale,ht=_t(lt.y+lt.h,bt,yt),vt=_t(lt.x+lt.w,gt,yt),wt=ht.guideline&&ht.guideline.fromSide===Ot.Top?ht.value-5-lt.y:ht.value-lt.y,xt=vt.guideline&&vt.guideline.fromSide===Ot.Left?vt.value-5-lt.x:vt.value-lt.x,kt={w:"number"==typeof st.w?xt-st.w:0,h:"number"==typeof st.h?wt-st.h:0},Et=Lt(c.viewingConcept,{references:c.viewingConcept.references.map((function(e){return dt(e.id)?Jt(Jt({},e),{},{size:{w:"number"==typeof e.size.w?e.size.w+kt.w:e.size.w,h:"number"==typeof e.size.h?e.size.h+kt.h:e.size.h}}):e}))}),e.updateConcept(Et),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Et,blocks:ue([tt],ot).map((function(e){return dt(e.id)?ee(e,{size:{w:"number"==typeof e.size.w?e.size.w+kt.w:e.size.w,h:"number"==typeof e.size.h?e.size.h+kt.h:e.size.h}}):e}))}));case 150:return Tt=s.data,Ct=Tt.id,St=Tt.mode,It=c.blocks,o.abrupt("return",Jt(Jt({},c),{},{blocks:St!==M.Idle?ue([Ct],It,(function(e){return ee(e,{mode:St})})):It.map((function(e){return e.id===Ct?ee(e,{mode:St}):e}))}));case 153:if(Pt=s.data,Bt=Pt.id,zt=Pt.color,Mt=c.blocks,Rt=c.selectedBlockIds,jt=Mt.find((function(e){return e.id===Bt}))){o.next=158;break}return o.abrupt("return",c);case 158:return Dt=function(e){return jt.selected?Rt.includes(e):e===jt.id},At=Lt(c.viewingConcept,{references:c.viewingConcept.references.map((function(e){return Dt(e.id)?Jt(Jt({},e),{},{color:zt}):e}))}),e.updateConcept(At),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:At,blocks:ue([Bt],Mt).map((function(e){return Dt(e.id)?ee(e,{color:zt}):e}))}));case 162:if(Ft=s.data,$t=Ft.id,Kt=Ft.size,Gt=c.blocks,Ut=c.viewingConcept,Xt=oe(Gt,$t)){o.next=167;break}return o.abrupt("return",c);case 167:return qt=ee(Xt,{size:Kt}),Qt=Lt(Ut,{references:Ut.references.map((function(e){return e.id===$t?te(qt):e}))}),e.updateConcept(Qt),r="",o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Qt,blocks:Gt.map((function(e){return e.id===$t?qt:e}))}));case 172:return en=s.data.blockIds,tn=c.selectedBlockIds.concat(en.filter((function(e){return!c.selectedBlockIds.includes(e)}))),nn=c.blocks.map((function(e){return ee(e,{selected:tn.includes(e.id)})})),o.abrupt("return",Jt(Jt({},c),{},{blocks:nn,selectedBlockIds:tn}));case 176:return o.abrupt("return",Jt(Jt({},c),{},{selectedBlockIds:c.selectedBlockIds.filter((function(e){return!s.data.find((function(t){return t===e}))}))}));case 177:return o.abrupt("return",Jt(Jt({},c),{},{blocks:c.blocks.map((function(e){return ee(e,{selected:!1})})),selectedBlockIds:[]}));case 178:if(rn=s.data,on=rn.id,an=rn.focusBlockId,cn=c.blocks,sn=c.settings,on){o.next=182;break}return o.abrupt("return",c);case 182:if(on!==c.viewingConcept.id){o.next=193;break}if(!(ln=cn.find((function(e){return e.id===an})))){o.next=192;break}if(un=le(ln,dn=1)){o.next=189;break}return o.abrupt("return",c);case 189:return o.abrupt("return",Jt(Jt({},c),{},{camera:{focus:un,scale:dn},shouldAnimateCamera:!0,blocks:ue([ln.id],cn).map((function(e){return ee(e,{selected:e.id===an,mode:M.Idle})})),selectedBlockIds:an?[an]:c.selectedBlockIds}));case 192:return o.abrupt("return",c);case 193:return fn=Jt(Jt({},sn),{},{viewingConceptId:on}),e.saveSettings(fn),o.next=197,e.getConcept(on);case 197:if(pn=o.sent){o.next=200;break}return o.abrupt("return",c);case 200:if(mn=pn.references.find((function(e){return e.id===an})),bn=mn&&{focus:le(mn,1)||{x:0,y:0},scale:1},o.t14=Jt,o.t15=Jt({},c),o.t16={},o.t17=fn,o.t18=pn,o.t19=bn||pn.camera,!an||!mn){o.next=217;break}return o.t21=ue,o.t22=[an],o.next=213,Yt(pn,e);case 213:o.t23=o.sent,o.t20=(0,o.t21)(o.t22,o.t23).map((function(e){return ee(e,{selected:e.id===an})})),o.next=220;break;case 217:return o.next=219,Yt(pn,e);case 219:o.t20=o.sent;case 220:return o.t24=o.t20,o.t25=an&&mn?[an]:[],o.t26=pn.relations,o.t27=c.expandHistory.slice(1).concat(on),o.t28={settings:o.t17,viewingConcept:o.t18,camera:o.t19,shouldAnimateCamera:!1,blocks:o.t24,selectedBlockIds:o.t25,blocksRendered:!1,relations:o.t26,expandHistory:o.t27},o.abrupt("return",(0,o.t14)(o.t15,o.t16,o.t28));case 226:return gn=E(s.data,c.camera),o.abrupt("return",Jt(Jt({},c),{},{selecting:!0,selectionBoxStart:gn,selectionBoxEnd:gn,selectionBox:Jt(Jt({},gn),{},{w:0,h:0}),selectedBlockIds:[],blocks:ie(c.blocks)}));case 228:return yn=c.selectionBoxStart,hn=E(s.data,c.camera),vn=k(yn.x,yn.y,hn.x,hn.y),wn=re(c.blocks,vn),xn=c.blocks.map((function(e){return ee(e,{selected:wn.includes(e.id)})})),o.abrupt("return",Jt(Jt({},c),{},{selectionBoxEnd:hn,selectionBox:vn,selectedBlockIds:wn,blocks:xn}));case 234:return o.abrupt("return",Jt(Jt({},c),{},{selecting:!1,selectionBoxStart:{x:0,y:0},selectionBoxEnd:{x:0,y:0},selectionBox:{x:0,y:0,w:0,h:0}}));case 235:if(kn=g(s.data,c.camera.scale),En=c.selectionBoxStart,On=c.selecting,Tn=c.blocks,Cn=c.camera,Sn=c.viewingConcept,In=Jt(Jt({},Cn),{},{focus:b(Cn.focus,kn)}),Pn=fe(Tn)?Tn.map((function(e){return e.posType===z.Normal&&e.selected?ee(e,{pos:b(e.pos,kn)}):e})):Tn,Bn=Lt(Sn,{camera:In,references:Pn.filter((function(e){return e.posType===z.Normal})).map((function(e){return te(e)}))}),e.updateConcept(Bn),!On){o.next=247;break}return zn=b(c.selectionBoxEnd,kn),Mn=k(En.x,En.y,zn.x,zn.y),Rn=re(c.blocks,Mn),jn=c.blocks.map((function(e){return ee(e,{selected:Rn.includes(e.id)})})),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Bn,camera:In,shouldAnimateCamera:!1,selectionBoxEnd:zn,selectionBox:Mn,selectedBlockIds:Rn,blocks:jn}));case 247:return o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Bn,camera:In,shouldAnimateCamera:!1,blocks:Pn}));case 248:return Dn=Math.sqrt(1.618),Nn=-s.data.wheelDelta/48,(Ln=c.camera.scale*Math.pow(Dn,Nn))>2?Ln=2:Ln<.05&&(Ln=.05),An=b(E(s.data.focus,c.camera),g(s.data.focus,Ln)),Ln===c.camera.scale&&(An=c.camera.focus),Zn=Jt(Jt({},c.camera),{},{focus:An,scale:Ln}),Hn=Lt(c.viewingConcept,{camera:Zn}),e.updateConcept(Hn),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Hn,camera:Zn,shouldAnimateCamera:!0}));case 260:return Fn=c.viewingConcept,$n=c.camera,_n=Jt(Jt({},$n),s.data),Vn=Lt(Fn,{camera:_n}),e.updateConcept(Vn),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:Vn,camera:_n,shouldAnimateCamera:!0}));case 265:return Wn=s.data,Kn=Wn.id,Jn=Wn.pointerInViewportCoords,Gn=c.camera,o.abrupt("return",Jt(Jt({},c),{},{drawingRelation:!0,drawingRelationFromBlockId:Kn,drawingRelationToPoint:E(Jn,Gn)}));case 268:return Un=s.data.pointerInViewportCoords,Yn=c.camera,Xn=c.blocks,qn=c.drawingRelationFromBlockId,Qn=E(Un,Yn),er=se(Qn,Xn,Yn,[qn],!0),o.abrupt("return",Jt(Jt({},c),{},{blocks:Xn.map((function(e){return ee(e,{highlighted:!!er&&e.id===er.id})})),drawingRelationToPoint:E(Un,Yn)}));case 273:return tr=s.data,nr=tr.id,rr=tr.pointerInViewportCoords,or=c.blocks,ar=c.relations,ir=c.camera,cr=c.viewingConcept,sr=E(rr,ir),lr=se(sr,or,ir,[nr],!0),dr=lr&&{type:"block-to-block-in-canvas",fromEntity:L.Block,fromId:nr,toEntity:L.Block,toId:lr.id},ur=dr&&!Ht(ar,dr)&&Zt(Zt({},dr),{},{id:(0,K.Z)(),userData:void 0}),fr=Lt(cr,{relations:ur?ar.concat(ur):cr.relations}),e.updateConcept(fr),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:fr,blocks:or.map((function(e){return ee(e,{highlighted:!1})})),relations:fr.relations,drawingRelation:!1,drawingRelationFromBlockId:"",drawingRelationToPoint:{x:0,y:0}}));case 282:return pr=s.data.id,mr=c.viewingConcept,br=c.relations,gr=Lt(mr,{relations:br.filter((function(e){return e.id!==pr}))}),e.updateConcept(gr),o.abrupt("return",Jt(Jt({},c),{},{viewingConcept:gr,relations:gr.relations}));case 287:return yr=s.data,hr=Jt(Jt({},c.settings),yr),e.saveSettings(hr),o.abrupt("return",Jt(Jt({},c),{},{settings:hr}));case 291:if(vr=c.expandHistory,wr=vr[vr.length-2]){o.next=295;break}return o.abrupt("return",c);case 295:return o.next=297,e.getConcept(wr);case 297:if(xr=o.sent){o.next=300;break}return o.abrupt("return",c);case 300:return kr=Jt(Jt({},c.settings),{},{viewingConceptId:xr.id}),e.saveSettings(kr),o.t29=Jt,o.t30=Jt({},c),o.t31={},o.t32=kr,o.t33=xr,o.t34=xr.camera,o.next=310,Yt(xr,e);case 310:return o.t35=o.sent,o.t36=xr.relations,o.t37=[void 0].concat(vr.slice(0,-1)),o.t38={settings:o.t32,viewingConcept:o.t33,camera:o.t34,shouldAnimateCamera:!1,blocks:o.t35,blocksRendered:!1,relations:o.t36,expandHistory:o.t37},o.abrupt("return",(0,o.t29)(o.t30,o.t31,o.t38));case 315:return o.abrupt("return",Jt(Jt({},c),{},{blocksRendered:!0}));case 316:if(Er=Wt(c,s.data),Or={shouldShow:!0,pos:s.data.pointerInViewportCoords,context:Er},(null==Er?void 0:Er.type)!==pt.Block){o.next=322;break}if((Tr=Er.block).selected){o.next=322;break}return o.abrupt("return",Jt(Jt({},c),{},{blocks:c.blocks.map((function(e){return ee(e,{selected:e.id===Tr.id})})),selectedBlockIds:[Tr.id],contextMenuState:Or}));case 322:return o.abrupt("return",Jt(Jt({},c),{},{contextMenuState:Or}));case 323:return o.abrupt("return",Jt(Jt({},c),{},{contextMenuState:{shouldShow:!1,pos:{x:0,y:0},context:void 0}}));case 324:return o.abrupt("return",c);case 325:case"end":return o.stop()}var i}),o)})));return function(e,t){return c.apply(this,arguments)}}()}(t,n)}),[t,n]),d=(0,c.useState)(),u=(0,l.Z)(d,2),f=u[0],y=u[1],h=(0,c.useRef)(),v=(0,c.useRef)(0),w=(0,c.useRef)(0);(0,c.useEffect)((function(){(function(e){return qt.apply(this,arguments)})(t).then((function(e){h.current=e,U.updateCamera(e.camera),v.current=Date.now()})).catch((function(e){throw e}))}),[t]);var x,O,T,C,S=(0,c.useRef)([]),I=(0,c.useRef)(!1),P=(0,c.useCallback)((0,o.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:I.current=!0;case 1:if(!S.current.length){e.next=11;break}if(t=S.current.shift(),!h.current||!t){e.next=8;break}return e.next=6,a(h.current,t);case 6:h.current=e.sent,U.updateCamera(h.current.camera);case 8:v.current=Date.now(),e.next=1;break;case 11:I.current=!1;case 12:case"end":return e.stop()}}),e)}))),[a]),B=(0,c.useCallback)((function(e){S.current.push(e),I.current||P().catch((function(e){throw e}))}),[P]);x=function(){v.current>w.current&&(w.current=Date.now(),y(h.current))},O=(0,c.useRef)(),T=(0,c.useRef)(),C=function e(t){if(null!=T.current){T.current;x()}T.current=t,O.current=requestAnimationFrame(e)},(0,c.useEffect)((function(){return O.current=requestAnimationFrame(C),function(){O.current&&cancelAnimationFrame(O.current)}}),[]);var R=(0,c.useRef)(null),j=(0,c.useCallback)((function(e){return R.current&&s.createPortal(e,R.current)}),[]),D=(0,c.useMemo)((function(){return{db:t,factoryRegistry:n,dispatchAction:B,createOverlay:j,openExternal:r}}),[t,n,B,j,r]);return f?c.createElement(c.Fragment,null,c.createElement(_.Provider,{value:D},c.createElement(F.Provider,{value:f},c.createElement(ct.Provider,{value:f.settings},c.createElement(nn,null)))),c.createElement(Bt,{ref:R})):c.createElement("div",{className:"loading-container"},c.createElement("div",{className:"glow-ball glow-ball-square"}),c.createElement("h1",{className:"loading-message"},"Starting"))}var on=n(9340),an=n(4575),cn=n(1120);var sn=function(e){(0,on.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,cn.Z)(t);if(n){var o=(0,cn.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,an.Z)(this,e)});function o(e){var t;return(0,G.Z)(this,o),(t=r.call(this,e)).state={hasError:!1},t}return(0,J.Z)(o,[{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return this.state.hasError?c.createElement("p",null,"Something went wrong."):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),o}(c.Component),ln=n(6922),dn=n(8780),un=n(8638),fn=n(6189),pn=n(6327),mn=(0,d.zE)({EditorContainer:{position:"relative",$nest:{"& .ProseMirror":{whiteSpace:"pre-wrap",overflowWrap:"break-word",wordBreak:"break-word"},"& .ProseMirror:focus":{outline:"none"},'&[data-view-mode="Block"] > .ProseMirror':{padding:u.paddings.blockComfort},'&[data-view-mode="NavItem"] > .ProseMirror':{padding:u.paddings.navComfort},'&[data-view-mode="CardTitle"] > .ProseMirror':{padding:0}}},Placeholder:{position:"absolute",top:0,right:0,bottom:0,left:0,opacity:.6,pointerEvents:"none",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",$nest:{'&[data-view-mode="Block"]':{padding:u.paddings.blockComfort},'&[data-view-mode="NavItem"]':{padding:u.paddings.navComfort},'&[data-view-mode="CardTitle"]':{padding:0}}},PMTextNavItem:{fontSize:".8rem",maxHeight:"100%"},PMTextCardTitle:{margin:"auto",width:"100%"},Code:{borderRadius:5,backgroundColor:"rgba(27, 31, 35, 0.05)",fontSize:"0.9em",padding:"0.2em 0.4em",wordBreak:"break-word",fontFamily:u.fonts.monospace},Underline:{borderBottom:"0.05em solid"}});function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bn(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var yn,hn,vn={padding:"".concat(.3,"rem"),zIndex:1e4,background:u.colors.bgBlock,boxShadow:u.shadows.float,borderRadius:u.borders.smallRadius,animation:"".concat(u.animations.fadeIn," 200ms ").concat(u.easings.easeInOutCubic)},wn={height:"".concat(1.75,"rem"),fontSize:"0.9rem",outline:"none",border:"none",borderRadius:u.borders.smallRadius,color:u.colors.contentText,background:u.colors.bgBlock,cursor:"pointer",transition:"background 30ms ".concat(u.easings.easeInOutCubic),$nest:{"&:hover":{background:u.colors.bgHover},"&:active":{background:u.colors.bgActive}}},xn=(0,d.zE)({Button:gn(gn({},wn),{},{padding:0,width:"".concat(1.75,"rem")}),TextButton:gn(gn({},wn),{},{padding:"0 .4rem"}),Glow:{color:u.colors.uiPrimary},TextActionMenu:gn(gn({},vn),{},{display:"flex"}),HighlightPicker:gn(gn({},vn),{},{position:"absolute",top:"-9rem",left:"".concat(4.375000000000001,"rem"),width:"".concat(11.1,"rem")}),LinkDialog:gn(gn({},vn),{},{position:"absolute",top:"-2.7rem",left:"-1.5rem",right:"-1.5rem",display:"flex",$nest:{"& > input":gn(gn({},Ke),{},{flex:"1 1 0",fontSize:".9rem",marginRight:".3rem"}),"& > button":gn(gn({},We),{},{flex:"0 0 3rem",padding:"0 .5rem"})}}),Title:gn(gn({},Ye),{},{padding:"0.3rem 0.3rem 0"})});function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.BackgroundRed="background-red",e.BackgroundOrange="background-orange",e.BackgroundYellow="background-yellow",e.BackgroundGreen="background-green",e.BackgroundBlue="background-blue",e.BackgroundPurple="background-purple",e.BackgroundPink="background-pink",e.BluePurpleGradient="blue-purple-gradient",e.OrangePinkGradient="orange-pink-gradient"}(hn||(hn={}));var On={"-webkit-background-clip":"text","-webkit-text-fill-color":"transparent","-webkit-box-decoration-break":"clone",backgroundClip:"text"},Tn=(0,d.zE)({Highlight:{color:u.colors.contentText,background:"transparent",borderRadius:u.borders.smallRadius,$nest:(yn={},(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundRed,'"]'),{background:"rgb(255, 214, 214)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundOrange,'"]'),{background:"rgb(255, 235, 214)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundYellow,'"]'),{background:"rgb(255, 249, 153)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundGreen,'"]'),{background:"rgb(176, 255, 211)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundBlue,'"]'),{background:"rgb(199, 231, 255)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundPurple,'"]'),{background:"rgb(231, 215, 255)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BackgroundPink,'"]'),{background:"rgb(255, 213, 249)"}),(0,r.Z)(yn,'&[data-color="'.concat(hn.BluePurpleGradient,'"]'),En(En({},On),{},{backgroundImage:"linear-gradient(90deg, rgb(40, 188, 190) 0%, rgb(57, 53, 221) 100%)"})),(0,r.Z)(yn,'&[data-color="'.concat(hn.OrangePinkGradient,'"]'),En(En({},On),{},{backgroundImage:"linear-gradient(90deg, rgb(255, 107, 0) 0%, rgb(255, 0, 162) 100%)"})),yn)}}),Cn="highlight",Sn={attrs:{color:{default:hn.BackgroundYellow}},toDOM:function(e){var t=e.attrs.color;return["mark",{class:Tn.Highlight,"data-color":t},0]},parseDOM:[{tag:"mark",getAttrs:function(e){return{color:e.getAttribute("data-color")}}}]};function In(e){return e.startsWith("background")}function Pn(e){return!e.startsWith("background")}var Bn,zn=c.createElement("span",{style:{fontWeight:600}},"B"),Mn=c.createElement("span",{style:{fontStyle:"italic"}},"I"),Rn=c.createElement("s",null,"S"),jn=c.createElement("span",{style:{textDecoration:"underline"}},"U"),Dn=c.createElement("span",{style:{fontSize:".8rem"}},"</>"),Nn=c.createElement("div",{style:{fontFamily:"serif",fontSize:".7rem",position:"relative",width:"100%",height:"100%"}},c.createElement("span",{style:{position:"absolute",top:".35rem",left:".3rem"}},"T"),c.createElement("span",{style:{position:"absolute",bottom:".35rem",left:".6rem"}},"E"),c.createElement("span",{style:{position:"absolute",top:".35rem",right:".3rem"}},"X")),Ln=c.createElement("span",{style:{padding:"0 .3rem"}},"A");function An(e){return c.createElement("button",{className:(0,d.Sh)(xn.Button,e.glow&&xn.Glow),onClick:e.onClick},e.children)}function Zn(e){return c.createElement("button",{className:(0,d.Sh)(xn.TextButton,e.glow&&xn.Glow),onClick:e.onClick},e.children)}function Hn(e){return c.createElement("div",{className:xn.HighlightPicker},c.createElement("div",null,c.createElement("div",{className:xn.Title},"COLOR"),c.createElement("div",null,Object.values(hn).filter(Pn).map((function(t){return c.createElement(An,{key:t,onClick:function(){return e.setHighlight(t)}},c.createElement("mark",{className:Tn.Highlight,"data-color":t},Ln))})).concat(c.createElement(An,{key:"no-color",onClick:function(){return e.setHighlight(void 0)}},c.createElement("mark",{className:Tn.Highlight},Ln))))),c.createElement("div",null,c.createElement("div",{className:xn.Title},"BACKGROUND"),c.createElement("div",null,Object.values(hn).filter(In).map((function(t){return c.createElement(An,{key:t,onClick:function(){return e.setHighlight(t)}},c.createElement("mark",{className:Tn.Highlight,"data-color":t},Ln))})).concat(c.createElement(An,{key:"no-color",onClick:function(){return e.setHighlight(void 0)}},c.createElement("mark",{className:Tn.Highlight},Ln))))))}function Fn(e){var t=(0,c.useState)(e.activeLink),n=(0,l.Z)(t,2),r=n[0],o=n[1];return c.createElement("div",{className:xn.LinkDialog},c.createElement("input",{value:r,autoFocus:!0,onChange:function(e){return o(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&(t.preventDefault(),e.setLink(r))},placeholder:"Paste an URL..."}),c.createElement("button",{onClick:function(){return e.setLink(r)}},"Set"))}!function(e){e.Main="main",e.HighlighPicker="highlightPicker",e.LinkDialog="linkDialog"}(Bn||(Bn={}));var $n,_n=c.forwardRef((function(e,t){var n=e.setHighlight,r=e.setLink,o=(0,c.useState)(Bn.Main),a=(0,l.Z)(o,2),i=a[0],s=a[1],d=(0,c.useCallback)((function(){s((function(e){return e===Bn.HighlighPicker?Bn.Main:Bn.HighlighPicker}))}),[]),u=(0,c.useCallback)((function(){s((function(e){return e===Bn.LinkDialog?Bn.Main:Bn.LinkDialog}))}),[]);(0,c.useEffect)((function(){return function(){s(Bn.Main)}}),[]);var f=(0,c.useCallback)((function(e){s(Bn.Main),n(e)}),[n]),p=(0,c.useCallback)((function(e){s(Bn.Main),r(e)}),[r]);return c.createElement("div",{className:xn.TextActionMenu,ref:t},c.createElement(An,{glow:e.boldActive,onClick:e.toggleBold},zn),c.createElement(An,{glow:e.italicActive,onClick:e.toggleItalic},Mn),c.createElement(An,{glow:e.strikeActive,onClick:e.toggleStrike},Rn),c.createElement(An,{glow:e.underlineActive,onClick:e.toggleUnderline},jn),c.createElement(An,{glow:e.codeActive,onClick:e.toggleCode},Dn),c.createElement(An,{onClick:d},c.createElement("mark",{className:Tn.Highlight,"data-color":e.activeHighlightColor||null},Ln)),c.createElement(Zn,{glow:!!e.activeLink,onClick:u},"Link"),c.createElement(An,{onClick:e.turnIntoLatex},Nn),i===Bn.HighlighPicker&&c.createElement(Hn,{setHighlight:f}),i===Bn.LinkDialog&&c.createElement(Fn,{activeLink:e.activeLink,setLink:p}))})),Vn=(0,d.zE)({Link:{color:"inherit",opacity:.75,cursor:"pointer",textDecoration:"none",borderBottom:"0.05em solid ".concat(u.colors.uiSecondaryDumb),$nest:{"&:hover":{borderBottom:"0.05em solid ".concat(u.colors.uiPrimary)}}}}),Wn="link",Kn={attrs:{href:{default:"#"},title:{default:null}},inclusive:!1,toDOM:function(e){var t=e.attrs,n=t.href,r=t.title;return["a",{class:Vn.Link,href:n,title:r},0]},parseDOM:[{tag:"a[href]",getAttrs:function(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}]},Jn=new un.V_({nodes:{doc:{content:"inline*"},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}},math_inline:{group:"inline",content:"text*",inline:!0,atom:!0,toDOM:function(){return["math-inline",{class:"math-node"},0]},parseDOM:[{tag:"math-inline"}]}},marks:($n={bold:{toDOM:function(){return["strong",0]},parseDOM:[{tag:"strong"}]},italic:{toDOM:function(){return["em",0]},parseDOM:[{tag:"em"},{tag:"i"},{style:"font-style=italic"}]},underline:{toDOM:function(){return["span",{class:mn.Underline},0]},parseDOM:[{style:"text-decoration=underline"}]},strike:{toDOM:function(){return["s",0]},parseDOM:[{tag:"strike"},{tag:"s"},{style:"text-decoration=line-through"}]},code:{toDOM:function(){return["code",{class:mn.Code},0]},parseDOM:[{tag:"code"}]}},(0,r.Z)($n,Wn,Kn),(0,r.Z)($n,Cn,Sn),$n)});function Gn(e){var t=[];return e.content.descendants((function(e){e.isText&&t.push(e)})),t}function Un(e){return Gn(e.content())}function Yn(e){var t=new Map;if(!e)return t;var n=new Map;return e.forEach((function(e){e.marks.forEach((function(e){n.set(e.type,(n.get(e.type)||0)+1)}))})),n.forEach((function(n,r){t.set(r,n===e.length)})),t}var Xn=function(e,t,n){if(t[0]){var r=t[0].marks.find((function(t){return t.type.name===e}));if(r){for(var o=1;o<t.length;o++){var a=t[o].marks.find((function(t){return t.type.name===e}));if(!a)return;if(!n(r.attrs,a.attrs))return}return r}}},qn=function(e,t,n){var r=Un(t);return Xn(e,r,n)},Qn=function(e,t){return!(!e||!t)&&e.color===t.color};function er(e){var t=function(e,t,n){var r=Gn(t);return Xn("highlight",r,n)}(0,e,Qn);return t&&t.attrs.color}function tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rr,or,ar=(0,d.zE)({SuggestionMenu:nr({},Ue),OptionGroupTitle:nr({},Ye),Option:{padding:".3rem .5rem",fontSize:".875rem",borderRadius:u.borders.smallRadius,cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",$nest:{"&:active":{background:u.colors.bgActive}}},Selected:{background:u.colors.bgHover}});function ir(e){return"pmtext"===e.summary.type}function cr(e){return function(t){return{id:t.id,title:e.getConceptString(t)}}}function sr(e,t){return H(e)===H(t)?t.lastEditedTime-e.lastEditedTime:H(e)?-1:1}function lr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ur(e){return e.reduce((function(e,t,n){return e.concat(t.items.map((function(e,t){return{key:[n,t],item:e}})))}),[])}function fr(e,t,n){var r=ur(n)[e];return!!r&&r.key[0]==t[0]&&r.key[1]===t[1]}!function(e){e.SlashCommands="slashCommands",e.Mention="mention"}(rr||(rr={})),function(e){e.TurnInto="turnInto",e.LinkTo="linkTo",e.CreateAndLinkTo="createAndLinkTo"}(or||(or={}));var pr=c.forwardRef((function(e,t){var n=e.optionGroups,r=e.selectedOptionIndex,o=e.width,a=e.onCloseMenu,i=e.onConfirmOption,s=e.onSelectOption,l=e.onSelectPrevOption,u=e.onSelectNextOption,f=(0,c.useCallback)((function(e){switch(e.key){case"ArrowUp":l&&l();break;case"ArrowDown":u&&u();break;case"Enter":i&&i();break;case"Escape":a&&a()}}),[a,i,l,u]);return(0,c.useEffect)((function(){return window.addEventListener("keydown",f),function(){return window.removeEventListener("keydown",f)}}),[f]),c.createElement("div",{ref:t,className:ar.SuggestionMenu,style:{width:o||150}},n.map((function(e,t){return c.createElement("div",{key:e.id},c.createElement("div",{className:ar.OptionGroupTitle},e.title),e.items.map((function(e,o){return c.createElement("div",{key:e.id,className:(0,d.Sh)(ar.Option,fr(r,[t,o],n)&&ar.Selected),onMouseEnter:function(){return s&&s(t,o)},onClick:function(){return i&&i()}},e.title)})),!e.items.length&&c.createElement("div",{className:ar.Option},"No result"))})))})),mr=n(2778),br=n(2629),gr=n(896);function yr(e,t){return new gr.VK(e,(function(e,n,r,o){var a=[];a=Array.isArray(t)?t.map((function(e){return e.create()})):[t.create()];var i=n[0].split(n[1]),c=(0,l.Z)(i,2),s=c[0],d=c[1],u=e.tr;return a.forEach((function(e){u=u.addMark(r,o,e)})),u=(u=(u=u.delete(r,r+s.length)).delete(u.mapping.map(o-(d.length-1)),u.mapping.map(o))).setStoredMarks([])}))}function hr(e){return e&&0===e.content.size}function vr(e,t){return e?un.NB.fromJSON(t,e):void 0}var wr=(0,br.h)({"Mod-b":(0,mr.w9)(Jn.marks.bold),"Mod-i":(0,mr.w9)(Jn.marks.italic),"Mod-u":(0,mr.w9)(Jn.marks.underline),"Mod-Shift-s":(0,mr.w9)(Jn.marks.strike),"Mod-e":(0,mr.w9)(Jn.marks.code),"Shift-Enter":function(e,t){var n=Jn.nodes.hard_break,r=e.selection.$from;return!!r.parent.canReplaceWith(r.index(),r.index(),n)&&(t(e.tr.replaceSelectionWith(n.create())),!0)},"Mod-z":kr((0,mr.QF)(gr.dU,fn.Yw)),"Shift-Mod-z":kr(fn.KX)}),xr=(0,gr.Hw)({rules:[yr(/(?<=[^*\n]|^)\*\*\*([^*\n]+)\*\*\*$/,[Jn.marks.bold,Jn.marks.italic]),yr(/(?<=[^*\n]|^)\*\*([^*\n]+)\*\*$/,Jn.marks.bold),yr(/(?<=[^_\n]|^)__([^_\n]+)__$/,Jn.marks.bold),yr(/`(.+)`$/,Jn.marks.code),yr(/(?<=[^*\n]|^)\*([^*\n]+)\*$/,Jn.marks.italic),yr(/(?<=[^_\n]|^)_([^_\n]+)_$/,Jn.marks.italic),yr(/~~(.+)~~$/,Jn.marks.strike),new gr.VK(/->$/,"→"),new gr.VK(/=>$/,"⇒"),new gr.VK(/!=$/,"≠"),new gr.VK(/--$/,"—"),(0,pn.Oi)(pn._V,Jn.nodes.math_inline)]});function kr(e){return function(t,n,r){return!(!r||!r.hasFocus())&&e(t,n,r)}}function Er(e){if("function"!=typeof e&&null!=e)throw console.log(e),new Error("It is now allowed to pass in a thing that is not a function, undefined, or null to useFunctionRef")}function Or(e){var t,n;return Er(e),(0,c.useRef)((t=function(){},n=e||t,{get current(){return n},set current(e){Er(e),n=e||t}})).current}function Tr(){var e=!1,t=!1;function n(e){t=1===e.button}return new ln.Sy({view:function(){return{update:function(){e||(window.addEventListener("mousedown",n),e=!0)},destroy:function(){window.removeEventListener("mousedown",n)}}},props:{handleDOMEvents:{paste:function(e,n){return t&&(n.preventDefault(),t=!1),!1}}}})}var Cr="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function Sr(){}function Ir(e){return!!e.$from.sameParent(e.$to)&&e.$from.parent.isTextblock}function Pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onSelectionCreate,n=void 0===t?Sr:t,r=e.onSelectionRemove,o=void 0===r?Sr:r;function a(e){if(e){var t=e.state;if(!t.selection.empty&&Ir(t.selection)){var r=e.coordsAtPos(t.selection.from),o=e.coordsAtPos(t.selection.to),a=window.getSelection();if(!a||0===a.rangeCount)return;var i=a.getRangeAt(0).getBoundingClientRect();n({from:t.selection.from,to:t.selection.to,fromRect:r,toRect:o,selectionBoundingRect:i})}}}return new ln.Sy({props:{handleDOMEvents:{mouseup:function(e){return a(e),!1},keydown:Cr?function(e,t){return t.metaKey&&"a"===t.key&&setTimeout((function(){return a(e)})),!1}:function(e,t){return t.ctrlKey&&"a"===t.key&&setTimeout((function(){return a(e)})),!1}}},view:function(){return{update:function(e,t){t&&!t.selection.empty&&e.state.selection.empty&&o()}}}})}var Br=(0,J.Z)((function e(t,n){(0,G.Z)(this,e),(0,r.Z)(this,"markName",void 0),(0,r.Z)(this,"handler",void 0),this.markName=t,this.handler=n})),zr=n(1854);function Mr(e){return Jn.mark(Jn.marks.link,{href:e})}function Rr(e){var t=e.onFocus,n=e.onBlur,r=e.onPointerDownOutside,o=e.clickRadius,a=void 0===o?3:o,i=e.externalHasFocus,s=(0,c.useRef)(null),l=(0,c.useCallback)((function(e){s.current=e}),[]),d=(0,c.useRef)(void 0),u=(0,c.useRef)(!1),f=(0,c.useRef)(i);return(0,c.useEffect)((function(){function e(e){return s.current&&s.current.contains(e)}function o(t){d.current=Oe(t),u.current=!1;var o=!e(t.target),a={clientX:d.current.x,clientY:d.current.y,target:t.target};o&&r&&r(a),(f.current||i)&&o&&(f.current=!1,n&&n(a)),t instanceof MouseEvent&&0!==t.button||(window.addEventListener("mousemove",c),window.addEventListener("touchmove",c),window.addEventListener("mouseup",l),window.addEventListener("touchend",l),window.addEventListener("touchcancel",l))}function c(e){if(d.current){var t=Oe(e);w(d.current,t)>a&&(u.current=!0,l(e))}}function l(n){window.removeEventListener("mousemove",c),window.removeEventListener("touchmove",c),window.removeEventListener("mouseup",l),window.removeEventListener("touchend",l),window.removeEventListener("touchcancel",l);var r=Oe(n),o=e(n.target);f.current&&i||u.current||!o||(f.current=!0,t&&t({clientX:r.x,clientY:r.y,target:n.target}))}return window.addEventListener("mousedown",o),window.addEventListener("touchstart",o),function(){window.removeEventListener("mousedown",o),window.removeEventListener("touchstart",o)}}),[t,n,r,a,i]),{setNodeRef:l}}function jr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,zr.zR)("jade");var Nr={id:"pmtext",name:"PMText",component:function(e){var t=e.concept,n=e.blockId,r=e.viewMode,a=e.readOnly,s=e.onChange,d=e.onReplace,u=e.onInteractionStart,f=e.onInteractionEnd,p=$().blocks,m=V(),b=m.dispatchAction,g=m.openExternal,y=m.createOverlay,h=m.factoryRegistry,v=m.db,x=oe(p,n),k=(0,c.useState)((null==x?void 0:x.mode)===M.Focusing),E=(0,l.Z)(k,2),O=E[0],T=E[1],C=(0,c.useState)(!1),S=(0,l.Z)(C,2),I=S[0],P=S[1],B=(0,c.useRef)(null),R=(0,c.useRef)(null),j=function(e){var t=(0,c.useRef)(null),n=(0,c.useState)(!1),r=(0,l.Z)(n,2),o=r[0],a=r[1],i=(0,c.useState)({top:0,left:0}),s=(0,l.Z)(i,2),d=s[0],u=s[1],f=(0,c.useState)(new Map),p=(0,l.Z)(f,2),m=p[0],b=p[1],g=function(e){return!!e.get(Jn.marks.bold)}(m),y=function(e){return!!e.get(Jn.marks.italic)}(m),h=function(e){return!!e.get(Jn.marks.strike)}(m),v=function(e){return!!e.get(Jn.marks.underline)}(m),w=function(e){return!!e.get(Jn.marks.code)}(m),x=function(t){return function(){e&&(e.focus(),function(e,t,n,r){var o=t.from,a=t.to;n.get(r)?e.dispatch(e.state.tr.removeMark(o,a,r)):e.dispatch(e.state.tr.addMark(o,a,e.state.schema.mark(r)))}(e,e.state.selection,m,t))}},k=x(Jn.marks.bold),E=x(Jn.marks.italic),O=x(Jn.marks.strike),T=x(Jn.marks.underline),C=x(Jn.marks.code),S=(0,c.useState)(void 0),I=(0,l.Z)(S,2),P=I[0],B=I[1],z=(0,c.useState)(""),M=(0,l.Z)(z,2),R=M[0],j=M[1],D=(0,c.useCallback)((function(e){b(function(e){return Yn(Un(e))}(e)),B(function(e){var t=qn(Cn,e,Qn);return t&&t.attrs.color}(e)),j(function(e){var t=qn(Wn,e,(function(e,t){return e.href===t.href}));return t&&t.attrs?t.attrs.href:""}(e))}),[]);return{textActionMenuRef:t,shouldShowTextActionMenu:o,openTextActionMenu:(0,c.useCallback)((function(){a(!0)}),[]),closeTextActionMenu:(0,c.useCallback)((function(){a(!1)}),[]),textActionMenuPos:d,setTextActionMenuPos:u,boldActive:g,italicActive:y,strikeActive:h,underlineActive:v,codeActive:w,activeHighlightColor:P,activeLink:R,toggleBold:k,toggleItalic:E,toggleStrike:O,toggleUnderline:T,toggleCode:C,setHighlight:function(t){e&&(e.focus(),function(e,t,n){var r=Jn.mark(Cn,{color:n});n?e.dispatch(e.state.tr.addMark(t.from,t.to,r)):e.dispatch(e.state.tr.removeMark(t.from,t.to,Jn.marks.highlight))}(e,e.state.selection,t))},setLink:function(t){var n,r,o,a;e&&(e.focus(),n=e,r=e.state.selection,o=t,a=Jn.mark(Wn,{href:o}),o?n.dispatch(n.state.tr.addMark(r.from,r.to,a)):n.dispatch(n.state.tr.removeMark(r.from,r.to,Jn.marks.link)))},turnIntoLatex:function(){var t,n,r,o,i,c;e&&(e.focus(),t=e,n=e.state.selection,r=t.state.doc.textBetween(n.from,n.to),o=Jn.node("math_inline",void 0,Jn.text(r)),i=un.HY.from(o),c=new un.p2(i,0,0),t.dispatch(t.state.tr.replaceRange(n.from,n.to,c)),a(!1))},updateMenuState:D}}(R.current),D=j.textActionMenuRef,N=j.shouldShowTextActionMenu,L=j.openTextActionMenu,H=j.closeTextActionMenu,F=j.textActionMenuPos,_=j.setTextActionMenuPos,W=j.boldActive,K=j.italicActive,J=j.strikeActive,G=j.underlineActive,U=j.codeActive,Y=j.activeHighlightColor,X=j.activeLink,q=j.toggleBold,Q=j.toggleItalic,ee=j.toggleStrike,te=j.toggleUnderline,ne=j.toggleCode,re=j.setHighlight,ae=j.setLink,ie=j.turnIntoLatex,ce=j.updateMenuState,se=Or(L),le=Or(H);(0,c.useEffect)((function(){se.current=L}),[L]),(0,c.useEffect)((function(){le.current=H}),[H]);var de=(0,c.useRef)(null),ue=function(e,t,n,r,a){var s=(0,c.useState)(!1),d=(0,l.Z)(s,2),u=d[0],f=d[1],p=(0,c.useState)(""),m=(0,l.Z)(p,2),b=m[0],g=m[1],y=(0,c.useState)({from:0,to:0}),h=(0,l.Z)(y,2),v=h[0],w=h[1],x=(0,c.useState)(rr.SlashCommands),k=(0,l.Z)(x,2),E=k[0],O=k[1],T=(0,c.useState)(0),C=(0,l.Z)(T,2),S=C[0],I=C[1],P=(0,c.useState)({top:0,right:0,bottom:0,left:0}),B=(0,l.Z)(P,2),z=B[0],M=B[1],R=(0,c.useMemo)((function(){return t.getContentFactories().map((function(e){return{id:e.id,title:e.name}}))}),[t]),j=(0,c.useCallback)((function(e){f(!0),O(e)}),[]),D=(0,c.useCallback)((function(){f(!1),g(""),w({from:0,to:0})}),[]),N=(0,c.useState)([]),L=(0,l.Z)(N,2),A=L[0],Z=L[1];(0,c.useEffect)((function(){function n(){return(n=(0,o.Z)(i().mark((function n(){var r,o,a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(E!==rr.SlashCommands){n.next=5;break}r=R.filter((function(e){return e.title.toLocaleLowerCase().includes(b.toLocaleLowerCase())})),Z([{id:or.TurnInto,title:"Turn into",items:b?r:R}]),n.next=17;break;case 5:if(n.t0=or.LinkTo,!b){n.next=10;break}n.t1=e.searchConceptByText(b,{limit:6}).map((function(e){return cr(t)(e.item)})).filter((function(e){return!!e.title})),n.next=13;break;case 10:return n.next=12,e.getAllConcepts();case 12:n.t1=n.sent.filter(ir).sort(sr).slice(0,6).map(cr(t));case 13:n.t2=n.t1,o={id:n.t0,title:"Insert link to",items:n.t2},a={id:or.CreateAndLinkTo,title:"Create and link to",items:[{id:"create_and_link_to",title:'Create "'.concat(b,'"')}]},Z(b?[o,a]:[o]);case 17:case"end":return n.stop()}}),n)})))).apply(this,arguments)}(function(){return n.apply(this,arguments)})().catch((function(e){throw e}))}),[b,E,R,e,t]);var H,F,$,_,V,W,K=(0,c.useCallback)((function(e,t){g(e),w(t)}),[]),J=(0,c.useCallback)((function(e){if(a){var n=v.from,r=v.to,o=a.state.doc.slice(n,r),i=function(e){return Yn(Gn(e))}(o),c=t.getConceptString(e),s=Jn.text(c,Array.from(i.keys()).filter((function(e){return e.name!==Wn})).map((function(e){return e.name===Cn?Jn.mark(e,{color:er(o)}):Jn.mark(e)})).concat([Jn.mark(Jn.marks.link,{href:dt(e)})])),l=un.HY.from(s),d=new un.p2(l,0,0);a.dispatch(a.state.tr.replaceRange(n,r,d))}}),[a,t,v]),G=(0,c.useCallback)((function(){var t=ur(A),o=t[S]&&t[S].key,a=(0,l.Z)(o,2),i=a[0],c=a[1],s=A[i],d=s&&s.items[c];if(D(),d)if(E===rr.SlashCommands)n(),r(d.id);else if(s.id===or.LinkTo)e.getConcept(d.id).then((function(e){e&&J(e)})).catch((function(e){throw e}));else if(s.id===or.CreateAndLinkTo){var u=Nt("pmtext",{summary:{type:"pmtext",data:{initialized:!0,data:{type:"doc",content:[{type:"text",text:b}]}}}});J(u),e.createConcept(u)}}),[e,D,n,r,J,b,A,E,S]),U=(0,c.useCallback)((function(e,t){var n=ur(A).findIndex((function(n){return n.key[0]===e&&n.key[1]===t}));-1!==n&&I(n)}),[A]),Y=(0,c.useCallback)((function(){I((function(e){return function(e,t){var n=ur(t);return e>0?e-1:n.length-1}(e,A)}))}),[A]),X=(0,c.useCallback)((function(){I((function(e){return function(e,t){return e<ur(t).length-1?e+1:0}(e,A)}))}),[A]),q=(0,c.useRef)();return q.current||(q.current=(F=(H={debug:!1,rules:[{trigger:/\/$/,onTrigger:function(e){j(rr.SlashCommands),M(e.keywordCoords.from),K(e.keyword,{from:e.keywordRange.from-e.triggerString.length,to:e.keywordRange.to})},onKeywordChange:function(e){K(e.keyword,{from:e.keywordRange.from-e.triggerString.length,to:e.keywordRange.to})},onKeywordStop:D},{trigger:/(\[\[|@|「「)$/,onTrigger:function(e){j(rr.Mention),M(e.keywordCoords.from),K(e.keyword,{from:e.keywordRange.from-e.triggerString.length,to:e.keywordRange.to})},onKeywordChange:function(e){K(e.keyword,{from:e.keywordRange.from-e.triggerString.length,to:e.keywordRange.to})},onKeywordStop:D}]}).rules,$=void 0===F?[]:F,V=void 0!==(_=H.debug)&&_,W=new ln.H$("keywordObserver"),{plugin:new ln.Sy({key:W,view:function(){return{update:function(e,t){var n=W.getState(t),r=W.getState(e.state);if(n&&r){var o=n.active&&r.active&&n.keywordRange.from!==r.keywordRange.from,a=!n.active&&r.active,i=n.active&&!r.active,c=!a&&!i&&n.keyword!==r.keyword;if(i||o){var s,l=null===(s=n.activeRule)||void 0===s?void 0:s.onKeywordStop;l&&l({keyword:n.keyword,keywordRange:n.keywordRange,triggerString:n.triggerString})}if(c&&!o){var d,u=null===(d=r.activeRule)||void 0===d?void 0:d.onKeywordChange;u&&u({keyword:r.keyword,keywordRange:r.keywordRange,keywordCoords:{from:e.coordsAtPos(r.keywordRange.from),to:e.coordsAtPos(r.keywordRange.to)},triggerString:r.triggerString})}if(a||o){var f,p=null===(f=r.activeRule)||void 0===f?void 0:f.onTrigger;p&&p({keyword:r.keyword,keywordRange:r.keywordRange,keywordCoords:{from:e.coordsAtPos(r.keywordRange.from),to:e.coordsAtPos(r.keywordRange.to)},triggerString:r.triggerString})}}}}},state:{init:function(){return{active:!1,keywordRange:{from:-1,to:-1},keyword:"",triggerPos:-1,triggerString:"",activeRule:void 0}},apply:function(e,t){var n=e.selection;if(t.active){if(e.getMeta("pointer"))return{active:!1,keywordRange:{from:-1,to:-1},keyword:"",triggerPos:-1,triggerString:"",activeRule:void 0};if(n.from===n.to&&n.from<t.triggerPos)return{active:!1,keywordRange:{from:-1,to:-1},keyword:"",triggerPos:-1,triggerString:"",activeRule:void 0};var r=e.getMeta(W);if(r&&r.stopReporting)return{active:!1,keywordRange:{from:-1,to:-1},keyword:"",triggerPos:-1,triggerString:"",activeRule:void 0};var o=n.from,a=n.$from.doc.textBetween(t.triggerPos,o,"\0","\0");return dr(dr({},t),{},{keywordRange:{from:t.triggerPos,to:o},keyword:a})}if(e.getMeta("pointer")||e.getMeta("uiEvent")||!e.docChanged)return dr({},t);if(n.from!==n.to)return dr({},t);var i=n.from,c=n.$from,s=c.start(),l=c.end();if(e.steps&&e.steps[0]){var d=e.steps[0].getMap(),u=!1;if(d.forEach((function(e,t,n,r){n>=s&&r<=l&&t-e!=0&&r===n&&(u=!0)})),u)return dr({},t)}for(var f=c.doc.textBetween(s,i,"\0","\0"),p=0;p<$.length;p++){var m=$[p],b=m.trigger.exec(f);if(b)return{active:!0,keywordRange:{from:i,to:i},keyword:"",triggerPos:i,triggerString:b[0],activeRule:m}}return dr({},t)}},props:{decorations:function(e){var t=this.getState(e),n=t.active,r=t.activeRule,o=t.keywordRange;return n&&r?dn.EH.create(e.doc,[dn.p.inline(o.from,o.to,{nodeName:"span",class:r.keywordDecorationClass||"ProseMirrorKeyword",style:V?"background: rgba(5, 12, 156, 0.05);\n                 color: #050c9c;\n                 border: 2px solid #050c9c;":null})]):null}}}),reset:function(e,t){var n=W.getState(e);return!(!n||!n.active||(t&&t(e.tr.setMeta(W,{stopReporting:!0})),0))}})),(0,c.useEffect)((function(){var e;!u&&a&&(null===(e=q.current)||void 0===e||e.reset(a.state,a.dispatch.bind(null)))}),[u,a]),(0,c.useEffect)((function(){ur(A)[S]||I(0)}),[A,S]),{models:{showSuggestionMenu:u,optionGroups:A,suggestFor:E,selectedOptionIndex:S,suggestionMenuAnchorRect:z},operations:{openSuggestionMenu:j,closeSuggestionMenu:D,updateKeyword:K,confirmOption:G,selectOption:U,selectPrevOption:Y,selectNextOption:X},utils:{keywordObserver:q.current}}}(v,h,f,d,R.current),fe=ue.models,pe=ue.operations,me=ue.utils.keywordObserver,be=fe.showSuggestionMenu,ge=fe.optionGroups,ye=fe.suggestFor,he=fe.selectedOptionIndex,ve=fe.suggestionMenuAnchorRect,we=pe.closeSuggestionMenu,xe=pe.confirmOption,ke=pe.selectOption,Ee=pe.selectPrevOption,Te=pe.selectNextOption,Ce=Or();(0,c.useEffect)((function(){Ce.current=function(e,t){if(e.composing)return!1;if(!be||"ArrowUp"!==t.key&&"ArrowDown"!==t.key&&"Enter"!==t.key||t.preventDefault(),"Block"===r&&!be&&!t.shiftKey&&"Enter"===t.key){var o=window.getSelection();o&&o.removeAllRanges(),R.current&&R.current.setProps({editable:function(){return!1}}),H(),we(),T(!1),f(),b({type:A.ConceptCreate,data:{posType:z.Normal,intent:Z.Below,blockId:n}})}return!1}}),[n,b,be,f,r]),(0,c.useEffect)((function(){var e,n,r,o=t.summary.data.data,a=ln.yy.create({schema:Jn,doc:vr(o,Jn),plugins:[wr,xr,(0,fn.m8)(),Tr(),Pr({onSelectionCreate:function(e){_({top:e.selectionBoundingRect.top-50,left:e.selectionBoundingRect.left-40}),se.current()},onSelectionRemove:function(){le.current()}}),me.plugin,(e={rules:[new Br(Wn,(function(e){if(ft(e.href)){var t=ut(e.href);if(!t.conceptId)return;b({type:A.BlockOpenAsCanvas,data:{id:t.conceptId,focusBlockId:t.blockId}})}else g(e.href)}))]},n=e.rules,r=void 0===n?[]:n,new ln.Sy({props:{handleDOMEvents:{mousedown:function(e,t){return 0!==t.button||window.addEventListener("mouseup",(function n(o){window.removeEventListener("mouseup",n);var a=Oe(t),i=Oe(o);if(!(w(a,i)>3)){var c=e.posAtCoords({left:i.x,top:i.y});if(c){var s=e.state.doc.nodeAt(c.pos);s&&s.marks.forEach((function(e){var t=r.find((function(t){return t.markName===e.type.name}));t&&t.handler(e.attrs,o)}))}}})),!1},click:function(e,t){return t.preventDefault(),!1},dragstart:function(e,t){return t.preventDefault(),!1}}}})),pn.c1,new ln.Sy({props:{handlePaste:function(e,t){if(!t.clipboardData)return!1;var n=Array.from(t.clipboardData.items);if(n.length>1)return!1;var r=n[0].type;if("text/plain"!==r)return!1;var o=t.clipboardData.getData(r);if(!(0,zr.Bu)(o))return!1;var a=o,i=e.state.selection;if(i.from===i.to){var c=Jn.text(a,[Mr(a)]),s=e.state.tr.insert(i.from,c);return e.dispatch(s),!0}var l=i.content(),d=!0;if(l.content.forEach((function(e){e.isText||(d=!1)})),!d)return!1;var u=Mr(a),f=e.state.tr.addMark(i.from,i.to,u);return e.dispatch(f),!0}}})]});if(!B.current)return function(){return 0};var i=function(e,t){var n=new dn.tk(e,{state:t,dispatchTransaction:function(e){var t=n.state.apply(e);n.updateState(t),P(hr(t.doc)),ce(n.state.selection),e.steps.length>0&&!e.getMeta("from_upstream")&&s({initialized:!0,data:t.doc.toJSON()})},handleDOMEvents:{keydown:function(e,t){return Ce.current(e,t)}},editable:function(){return!1},handleScrollToSelection:function(){return!0}});return n}(B.current,a);return R.current=i,t.summary.data.initialized||(i.setProps({editable:function(){return!0}}),i.focus(),T(!0),u(),s({initialized:!0})),P(hr(a.doc)),function(){i.destroy()}}),[]),(0,c.useEffect)((function(){var e=R.current;if(e&&!e.dom.contains(document.activeElement)){var n=vr(t.summary.data.data,Jn),r=e.state,o=new ln.C1(r.doc),a=o.from,i=o.to;n&&(a||i||!hr(n))&&e.dispatch(r.tr.replaceRangeWith(a,i,n).setMeta("from_upstream",!0))}}),[t.summary.data.data]);var Se=Rr({onFocus:(0,c.useCallback)((function(e){if(!a&&R.current){var t=R.current.posAtCoords({left:e.clientX,top:e.clientY});if(t){console.log("PMText: interaction start via synthetic focus");var n=R.current.state.doc.resolve(t.pos);R.current.dispatch(R.current.state.tr.setSelection(ln.Y1.near(n))),R.current.setProps({editable:function(){return!0}}),R.current.focus(),T(!0),u()}}}),[a,u]),onPointerDownOutside:(0,c.useCallback)((function(e){if(O){var t=!!R.current&&R.current.dom,n=D.current,r=de.current,o=!!t&&t.contains(e.target),a=!!n&&n.contains(e.target),i=!!r&&r.contains(e.target);if(!o&&!a&&!i){console.log("PMText: interaction end via synthetic pointerDownOutside");var c=window.getSelection();c&&c.removeAllRanges(),R.current&&R.current.setProps({editable:function(){return!1}}),H(),we(),T(!1),f()}}}),[O,f,we,H,D]),externalHasFocus:O}).setNodeRef,Ie=(0,c.useMemo)((function(){return c.createElement("div",{ref:function(e){Se(e),B.current=e},className:mn.EditorContainer,"data-view-mode":e.viewMode},I&&c.createElement("div",{className:mn.Placeholder,"data-view-mode":e.viewMode},O?"Type '/' for commands":"Wanna capture something"))}),[O,e.viewMode,I,Se]);switch(e.viewMode){case"NavItem":return c.createElement("div",{className:mn.PMTextNavItem},Ie);case"Block":case"CardTitle":return c.createElement(c.Fragment,null,"Block"===e.viewMode?Ie:c.createElement("div",{className:mn.PMTextCardTitle},Ie),be&&y(c.createElement(Rt,{near:ve},c.createElement(pr,{ref:de,optionGroups:ge,selectedOptionIndex:he,width:ye===rr.SlashCommands?150:350,onConfirmOption:xe,onCloseMenu:we,onSelectOption:ke,onSelectPrevOption:Ee,onSelectNextOption:Te}))),N&&y(c.createElement("div",{style:Dr({position:"absolute"},F)},c.createElement(_n,{ref:D,boldActive:W,italicActive:K,strikeActive:J,underlineActive:G,codeActive:U,activeHighlightColor:Y,activeLink:X,toggleBold:q,toggleItalic:Q,toggleStrike:ee,toggleUnderline:te,toggleCode:ne,turnIntoLatex:ie,setHighlight:re,setLink:ae}))));default:return c.createElement("span",null,"Unknown ",c.createElement("code",null,"viewMode"),": ",e.viewMode)}},toText:function(e){var t,n=null===(t=e.summary.data)||void 0===t?void 0:t.data;return n?un.NB.fromJSON(Jn,n).textContent:""}},Lr=(0,d.zE)({NavItem:{fontSize:".8rem",padding:u.paddings.navComfort,maxHeight:"100%"},Block:{padding:u.paddings.blockComfort},CardTitle:{margin:"auto",width:"100%"}}),Ar=n(2245),Zr=n(8872),Hr=n(7645),Fr=function(e,t){var n=function(e,t){var n=Ar.ML.marks(e);return!!n&&!0===n[t]}(e,t);n?Ar.ML.removeMark(e,t):Ar.ML.addMark(e,t,!0)},$r=function(e){return e.children},_r=function(e){return c.createElement("pre",e.attributes,c.createElement("code",null,e.children))},Vr=function(e){var t=e.attributes,n=e.leaf,r=e.children;return n.bold&&(r=c.createElement("strong",null,r)),n.code&&(r=c.createElement("code",null,c.createElement("style",{jsx:!0},"\n          code {\n            border-radius: 5px;\n            background-color: rgba(135, 131, 120, 0.15);\n            color: #ff4081;\n            font-size: 0.9em;\n            padding: 0em 0.4em;\n            word-break: break-word;\n          }\n        "),r)),n.italic&&(r=c.createElement("em",null,r)),n.underline&&(r=c.createElement("u",null,r)),c.createElement("span",t,r)},Wr=function(e){var t=(0,c.useMemo)((function(){return(0,Zr.BU)((0,Hr.VC)((0,Ar.Jh)()))}),[]),n=(0,c.useState)(e.content),r=(0,l.Z)(n,2),o=r[0],a=r[1],i=(0,c.useCallback)((function(e){return"code"===e.element.type?c.createElement(_r,e):c.createElement($r,e)}),[]),s=(0,c.useCallback)((function(e){return c.createElement(Vr,e)}),[]);(0,c.useEffect)((function(){a(e.content)}),[e.content]),(0,c.useEffect)((function(){e.forceFocus&&(console.log("Focus Slate programmatically"),t.selection={anchor:{path:[0,0],offset:0},focus:{path:[0,0],offset:0}},Zr.F3.focus(t))}),[t,e.forceFocus]);var d=(0,c.useState)(),u=(0,l.Z)(d,2),f=u[0],p=u[1];return c.createElement(Zr.mH,{editor:t,value:o,onChange:function(t){a(t),e.onChange(t)}},c.createElement(Zr.CX,{readOnly:e.readOnly,renderElement:i,renderLeaf:s,onKeyDown:function(e){"["===e.key?(e.preventDefault(),t.insertText("[]"),Ar.YR.move(t,{distance:1,unit:"character",reverse:!0})):"`"===e.key&&e.ctrlKey?(e.preventDefault(),Fr(t,"code")):"b"===e.key&&e.ctrlKey?(e.preventDefault(),Fr(t,"bold")):"i"===e.key&&e.ctrlKey?(e.preventDefault(),Fr(t,"italic")):"Enter"===e.key&&(e.preventDefault(),e.shiftKey&&t.insertText("\n"))},onFocus:e.onFocus,onBlur:function(n){n.target!==document.activeElement&&(Zr.F3.deselect(t),e.onBlur&&e.onBlur())},onDOMBeforeInput:function(e){console.log(e),p({data:e.data||"",isComposing:e.isComposing}),f&&f.isComposing&&e.isComposing&&f.data===e.data&&console.log("Slate is ready to crash.")},placeholder:"Type here..."}))},Kr={id:"text",name:"SlateText",component:function(e){var t,n=e.readOnly,r=e.viewMode,o=e.concept,a=e.onChange,i=e.onInteractionStart,s=e.onInteractionEnd,d=(0,c.useState)({slateData:(t=o.summary.data,t.initialized?t.data:[{type:"paragraph",children:[{text:""}]}]),isNewText:!o.summary.data.initialized}),u=(0,l.Z)(d,2),f=u[0],p=u[1],m=(0,c.useCallback)((function(e){p({slateData:e,isNewText:!1}),a({initialized:!0,data:e})}),[a]),b=c.createElement(Wr,{readOnly:n,forceFocus:f.isNewText,content:f.slateData,onChange:m,onFocus:i,onBlur:s});switch(r){case"NavItem":return c.createElement("div",{className:Lr.NavItem},b);case"Block":return c.createElement("div",{className:Lr.Block},b);case"CardTitle":return c.createElement("div",{className:Lr.CardTitle},b);default:return c.createElement("span",null,"Unknown ",c.createElement("code",null,"viewMode"),": ",r)}},toText:function(e){return"slatetext "+JSON.stringify(e.summary.data)}},Jr={fontSize:".8rem",padding:u.paddings.navComfort,maxHeight:"100%",color:u.colors.neutral50};function Gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Yr=(0,d.zE)({ImageNavItem:{height:"100%",maxHeight:"inherit",overflow:"hidden",$nest:{"&>img":{width:"100%",height:"100%",maxHeight:"inherit",objectFit:"contain"}}},ImageErrorMsg:Ur({},Jr),ImageBlockViewer:{display:"flex",height:"100%",overflow:"hidden",$nest:{"&>img":{width:"100%"},"&>img[data-view-mode='CardTitle']":{height:"100%",objectFit:"contain",objectPosition:"left center"},"& > button":Ur(Ur({},Ve),{},{position:"absolute",top:12,right:20,opacity:0,transition:"background 0.1s ease-in-out, opacity 0.15s ".concat(u.easings.easeInOutCubic)}),"&:hover > button":{opacity:1}}},ImageBlockChooser:{padding:u.paddings.blockComfort,paddingBottom:".7rem",$nest:{"&>input":{width:"100%"}}},Title:{fontWeight:600,marginBottom:".3rem"},ImgLinkInput:Ur(Ur({},Ke),{},{marginBottom:".5rem"}),ImgLinkButton:Ur(Ur({},We),{},{marginBottom:".7rem"}),ChooseImgBtn:Ur(Ur({},We),{},{$nest:Ur(Ur({},We.$nest),{},{"& > input":{display:"none"}})}),sizeWarning:{color:u.colors.neutral40,fontSize:"0.7rem",marginBottom:"0.5rem"}}),Xr={NOT_LOADED:Symbol("notloaded"),LOADED:Symbol("loaded"),ERROR:Symbol("error")},qr={id:"image",name:"Image",component:function(e){var t=e.viewMode,n=e.concept,r=e.onInteractionStart,o=e.onInteractionEnd,a=e.onChange,i=n.summary.data;i.imgData&&a({imgSrc:i.imgData});var s=(0,c.useState)(i.imgSrc?Xr.LOADED:Xr.NOT_LOADED),d=(0,l.Z)(s,2),u=d[0],f=d[1],p=(0,c.useState)(i.imgSrc),m=(0,l.Z)(p,2),b=m[0],g=m[1],y=(0,c.useState)(""),h=(0,l.Z)(y,2),v=h[0],w=h[1],x=(0,c.useRef)(null);if((0,c.useEffect)((function(){f(i.imgSrc?Xr.LOADED:Xr.NOT_LOADED),g(i.imgSrc)}),[i]),"NavItem"===t)return u===Xr.LOADED?c.createElement("div",{className:Yr.ImageNavItem},c.createElement("img",{src:b,draggable:!1})):v?c.createElement("div",{className:Yr.ImageErrorMsg},v):c.createElement("div",{className:Yr.ImageErrorMsg},"An empty image");switch(u){case Xr.LOADED:return c.createElement("div",{className:Yr.ImageBlockViewer},c.createElement("img",{src:b,draggable:!1,"data-view-mode":t}),c.createElement("button",{onClick:function(){return a({imgSrc:""})}},"Replace"));case Xr.NOT_LOADED:return c.createElement("div",{className:Yr.ImageBlockChooser},c.createElement("div",{className:Yr.Title},"From the Web"),c.createElement("input",{ref:x,className:Yr.ImgLinkInput,placeholder:"Paste the image link...",type:"url",onFocus:r,onBlur:o}),c.createElement("button",{className:Yr.ImgLinkButton,onClick:function(){var e;a({imgSrc:null===(e=x.current)||void 0===e?void 0:e.value})}},"Embed image"),c.createElement("div",{className:Yr.Title},"From your computer"),c.createElement("div",{className:Yr.sizeWarning},"Don't upload large images, currently the database (window.localStorage) only have 5MB quota for everything."),c.createElement("label",{className:Yr.ChooseImgBtn},c.createElement("input",{type:"file",accept:".apng, .avif, .gif,image/jpeg, .png, .svg, .webp, .bmp",onChange:function(e){var t=e.target.files;if(t){var n=t[0];n.type&&-1===n.type.indexOf("image")?console.log("File is not an image.",n.type,n):function(e){return new Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(e){var r,o,a=null===(r=e.target)||void 0===r||null===(o=r.result)||void 0===o?void 0:o.toString();a?t(a):n("Cannot get data url")})),r.addEventListener("error",(function(e){n(e)})),r.readAsDataURL(e)}))}(n).then((function(e){a({imgSrc:e})})).catch((function(e){w(e),f(Xr.ERROR)}))}else console.log('"e.target.files" is null.')}}),c.createElement("span",null,"Choose an image")));default:return c.createElement("div",{className:Yr.ImageErrorMsg},v)}},toText:function(e){var t=e.summary.data.imgSrc;return"image ".concat((null==t?void 0:t.slice(0,1024))||"")}};function Qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var to=(0,d.zE)({LinkInput:eo(eo({},Ke),{},{width:"100%"}),LinkConfirmButton:eo({},We),ControlButton:eo(eo({},Ve),{},{borderRadius:0,$nest:eo(eo({},Ve.$nest),{},{"&:not(:last-child)":{borderRight:"1px solid ".concat(u.colors.neutral50)},"&:first-child":{borderTopLeftRadius:u.borders.smallRadius,borderBottomLeftRadius:u.borders.smallRadius},"&:last-child":{borderTopRightRadius:u.borders.smallRadius,borderBottomRightRadius:u.borders.smallRadius}})}),FrameWrapperAutoHeight:{position:"relative",paddingBottom:"56.25%",paddingTop:25,height:0},FrameWrapperFixedHeight:{height:"100%"},fillParentHeight:{height:"100%"}}),no=(0,d.zE)({ControlButtonGroup:{position:"absolute",top:12,right:20,opacity:0,transition:"opacity 0.15s ".concat(u.easings.easeInOutCubic),boxShadow:"".concat(u.colors.neutral90," 0px 0px 2px"),borderRadius:u.borders.smallRadius}}),ro=(0,d.zE)({EmbedBlockDisplay:{position:"relative",$nest:(0,r.Z)({},"&:hover > .".concat(no.ControlButtonGroup),{opacity:1})},EmbedBlockEmpty:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:u.paddings.blockComfort,height:"100%",$nest:{"& > *":{display:"block"},"& > input":{marginBottom:".7rem",maxWidth:400},"& > button":{width:180,maxWidth:"100%"}}},emptyNavItem:eo({},Jr)}),oo=eo(eo(eo({},to),no),ro);function ao(e){var t=e.searchParams.get("t");if(t){var n=/\d+/.exec(t);return n?n[0]:void 0}}function io(e){if(e.startsWith("https://www.youtube.com/watch?v=")){var t=new URL(e),n=t.searchParams.get("v"),r=ao(t);return n?"https://www.youtube.com/embed/".concat(n).concat(r?"?start=".concat(r):""):void 0}if(e.startsWith("https://youtu.be/")){var o=new URL(e),a=o.pathname.split("/").pop(),i=ao(o);return a?"https://www.youtube.com/embed/".concat(a).concat(i?"?start=".concat(i):""):void 0}return e}function co(e){return e.startsWith("https://twitter.com/")}function so(e){if(co(e))return new URL(e).pathname.split("/").pop()}var lo=(0,d.zE)({iframe:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},noInteraction:{pointerEvents:"none"}}),uo=c.forwardRef((function(e,t){var n=e.url,r=e.noInteraction,o=e.scale,a=void 0===o?1:o,i="".concat(100/a,"%");return c.createElement("iframe",{ref:t,className:(0,d.Sh)(lo.iframe,r&&lo.noInteraction),style:{width:i,height:i,transform:"scale(".concat(a,")"),transformOrigin:"top left"},width:i,height:i,src:io(n),frameBorder:"0",loading:"lazy",scrolling:r?"no":"auto",allow:"clipboard-write; encrypted-media; picture-in-picture",allowFullScreen:!0})})),fo=c.memo(uo),po=[];function mo(e){var t=e.id,n=e.options,r=e.placeholder,o=e.className,a=e.protocol,i=void 0===a?"https:":a,s=e.onTweetLoadSuccess,d=e.onTweetLoadError,u=(0,c.useState)(!0),f=(0,l.Z)(u,1)[0],p=(0,c.useRef)(null);return(0,c.useEffect)((function(){var e=function(){t&&window.twttr.ready().then((function(e){var r=e.widgets;p.current&&(console.log("clear"),p.current.innerHTML=""),r.createTweetEmbed(t,p.current,n).then((function(e){e.style.marginTop="0px",e.style.marginBottom="0px",s&&s(e)})).catch(d)})).catch(d)},r=window.twttr;if(r&&r.ready)e();else{var o=window.location.protocol.indexOf("file")>=0;!function(e,t){if(0===po.length){po.push(t);var n=document.createElement("script");n.setAttribute("src",e),n.onload=function(){return po.forEach((function(e){return e()}))},document.body.appendChild(n)}else po.push(t)}("".concat(o?i:"","//platform.twitter.com/widgets.js"),e)}}),[t]),c.createElement("div",{ref:p,className:o},f&&r)}var bo=(0,d.zE)({container:{height:"100%"},overflowAuto:{overflow:"auto"},overflowHidden:{overflow:"hidden"},disableIframeInteraction:{$nest:{"& iframe":{pointerEvents:"none"}}}});function go(e){return c.createElement("div",{className:(0,d.Sh)(bo.container,e.noInteraction?bo.overflowHidden:bo.overflowAuto)},c.createElement(mo,(0,Tt.Z)({},e,{placeholder:"loading",className:(0,d.Sh)(e.noInteraction&&bo.disableIframeInteraction,e.className)})))}function yo(e){var t=e.blockId,n=e.concept,r=e.onChange,o=e.onInteractionStart,a=e.onInteractionEnd,i=oe($().blocks,t),s=i&&i.mode===M.Resizing,u=i&&i.mode===M.Focusing,f=V(),p=f.openExternal,m=f.dispatchAction,b=n.summary.data,g=b&&b.url?b.url:"",y=(0,c.useRef)(null),h=(0,c.useState)(!0),v=(0,l.Z)(h,2),w=v[0],x=v[1],k=!w||s||!u,E=Rr({onFocus:o,onBlur:a}).setNodeRef,O=(0,c.useCallback)((function(){window.removeEventListener("mouseup",O),window.removeEventListener("touchend",O),x(!0)}),[]),T=(0,c.useCallback)((function(){x(!1),window.addEventListener("mouseup",O),window.addEventListener("touchend",O)}),[O]),C=(0,c.useCallback)((function(){r({initialized:!0,url:void 0}),m({type:A.BlockSetSize,data:{id:t,size:{w:300,h:"auto"}}})}),[t,r,m]),S=(0,c.useCallback)((function(){var e,n=null===(e=y.current)||void 0===e?void 0:e.value;n&&(r({initialized:!0,url:n}),m({type:A.BlockSetSize,data:{id:t,size:{w:400,h:225}}}))}),[t,r,m]);return g?c.createElement("div",{className:(0,d.Sh)(oo.EmbedBlockDisplay,"auto"!==i.size.h&&oo.fillParentHeight)},c.createElement("div",{ref:E,className:"auto"===i.size.h?oo.FrameWrapperAutoHeight:oo.FrameWrapperFixedHeight},co(g)?c.createElement(go,{id:so(g),noInteraction:k}):c.createElement(fo,{url:g,noInteraction:k})),!u&&c.createElement("div",{className:oo.ControlButtonGroup},c.createElement("button",{className:oo.ControlButton,style:{cursor:"move"},onMouseDown:T,onTouchStart:T},"Move"),c.createElement("button",{className:oo.ControlButton,onClick:C},"Replace"),c.createElement("button",{className:oo.ControlButton,onClick:function(){return p(g)}},"Original"),c.createElement("button",{className:oo.ControlButton,onClick:function(){return lt(g)}},"Copy link"))):c.createElement("div",{className:oo.EmbedBlockEmpty},c.createElement("input",{ref:y,className:oo.LinkInput,placeholder:"Paste in https://...",type:"url",onFocus:o,onBlur:a,onKeyDown:function(e){return"Enter"===e.key&&S()}}),c.createElement("button",{className:oo.LinkConfirmButton,onClick:S},"Embed link"))}function ho(e){var t=e.concept,n=e.blockId,r=e.viewMode,o=t.summary.data,a=o&&o.url?o.url:"",i=oe($().blocks,n);return a?c.createElement("div",{className:(0,d.Sh)(oo.EmbedBlockDisplay,"auto"!==i.size.h&&oo.fillParentHeight)},c.createElement("div",{className:"auto"===i.size.h?oo.FrameWrapperAutoHeight:oo.FrameWrapperFixedHeight},co(a)?c.createElement(go,{id:so(a),noInteraction:!0}):c.createElement(fo,{url:a,noInteraction:!0,scale:"NavItem"===r?.3:1}))):c.createElement("div",{className:oo.emptyNavItem},"An empty embed")}var vo={id:"embed",name:"Embed",component:function(e){return"NavItem"===e.viewMode?c.createElement(ho,e):c.createElement(yo,e)},toText:function(e){var t=e.summary.data.url;return"embed ".concat(t||"")}},wo=n(6982);const xo={JADE_VER:"0.3.8",JADE_LAST_UPDATED:"2022.02.16",JADE_DB_VER:5};var ko=(0,d.zE)({header:{$nest:{"& > *":{margin:0},"& > h1, & > h3":{fontWeight:500}}},appName:{display:"flex",alignItems:"center",$nest:{"& > img":{height:"1.3em",marginRight:"0.5rem"},"& > span":{transform:"translateY(-0.2rem)"}}},buildInfo:{opacity:.7,fontSize:"1rem",paddingLeft:"0.25rem"}});function Eo(){return c.createElement("header",{className:ko.header},c.createElement("h1",{className:ko.appName},c.createElement("img",{src:wo}),c.createElement("span",null,"Jade")),c.createElement("h3",{className:ko.buildInfo},"v",xo.JADE_VER," (",xo.JADE_LAST_UPDATED,")"))}var Oo=(0,d.zE)({blockCounter:{display:"flex",alignItems:"flex-end",margin:0,lineHeight:1},count:{fontSize:"1.6rem",color:u.colors.uiPrimary},text:{display:"flex",flexDirection:"column",marginLeft:"0.5rem"},firstLine:{fontSize:"0.9rem"},secondLine:{fontSize:"0.7rem"}});function To(e){var t=e.value;return c.createElement("div",{className:Oo.blockCounter},c.createElement("div",{className:Oo.count},t),c.createElement("div",{className:Oo.text},c.createElement("div",null,"block",t>1?"s":""),c.createElement("div",{className:Oo.secondLine},"on this canvas")))}var Co=(0,d.zE)({canvasMonitor:{$nest:{"& code":{color:u.colors.neutral10,background:u.colors.neutral90,fontSize:".9em",padding:".1rem .3rem",borderRadius:".3rem",transitionProperty:"color, background",transitionDuration:"0.2s",transitionTimingFunction:"".concat(u.easings.easeInOutCubic)},"& p":{marginTop:0,marginBottom:"0.3em"},"& p:last-child":{marginBottom:0}}},glowCode:{$nest:{"& code":{color:u.colors.uiText,background:u.colors.uiPrimaryAttractive}}}});function So(e){var t=e.focus,n=e.scale,r=e.selecting,o=e.selectedCount;return c.createElement("div",{className:Co.canvasMonitor},c.createElement("p",null,"Focusing"," ",c.createElement("code",null,"(",t.x.toFixed(1),", ",t.y.toFixed(1),")")," ","with scale ",c.createElement("code",null,(100*n).toFixed(1),"%")),c.createElement("p",{className:r?Co.glowCode:void 0},c.createElement("code",null,r?"✓":"✗"," Selecting ",o)))}function Io(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/plain";return"data:".concat(t,";charset=utf-8,")+encodeURIComponent(e)}function Po(){var e="rtl"===document.documentElement.getAttribute("dir"),t=document.createElement("a");t.style.fontSize="12pt",t.style.border="0",t.style.padding="0",t.style.margin="0",t.style.position="absolute",t.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;return t.style.top="".concat(n,"px"),t}function Bo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bo(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mo=(0,d.zE)({statusCardTitle:{width:"100%"},status:{userSelect:"none",padding:u.paddings.blockComfort,$nest:{"& button":zo({},We)}},blockCounter:{padding:"0.5rem 0.3rem"},canvasMonitor:{padding:"0.5rem 0.3rem"},buttons:{padding:"0.5rem 0.3rem",$nest:{"& > button:not(:last-child)":{margin:"0 0.3rem 0.3rem 0"}}},chooseFileButton:zo(zo({},We),{},{display:"inline-block",textAlign:"center",$nest:zo(zo({},We.$nest),{},{"& > input":{display:"none"}})})}),Ro={id:"status",name:"Status",component:function(e){var t=e.dispatchAction,n=e.database,r=$(),a=st(),s=(0,c.useCallback)((function(){function e(e,t){return e+Math.floor(Math.random()*Math.floor(t-e+1))}for(var n=0;n<100;n++){var r={x:e(-1e3,1e3),y:e(-1e3,1e3)};t({type:A.ConceptCreate,data:{posType:z.Normal,intent:Z.ExactAt,pointerInViewportCoords:r}})}}),[t]),l=(0,c.useCallback)((0,o.Z)(i().mark((function e(){var t,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Io,e.t1=JSON,e.next=4,n.getAllConcepts();case 4:e.t2=e.sent,e.t3=e.t1.stringify.call(e.t1,e.t2),t=(0,e.t0)(e.t3,"application/json"),r="".concat(("all-concepts",a=void 0,a=new Date,"".concat("all-concepts","-").concat(a.getFullYear(),"-").concat(a.getMonth()+1,"-").concat(a.getDate())),".json"),(o=Po()).href=t,o.download=r,o.click();case 12:case"end":return e.stop()}var a}),e)}))),[n]),d=(0,c.useCallback)((function(e){e.forEach((function(e){return n.createConcept(e)}))}),[n]),u=(0,c.useCallback)((function(e){var t=e.target.files;if(t){var n=t[0];n.type&&-1===n.type.indexOf("json")?console.log("File is not an json.",n.type,n):function(e){return new Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(e){var r,o,a=(null===(r=e.target)||void 0===r||null===(o=r.result)||void 0===o?void 0:o.toString())||"";try{var i=JSON.parse(a);t(i)}catch(e){n(e)}})),r.addEventListener("error",(function(e){n(e)})),r.readAsText(e)}))}(n).then((function(e){d(e)})).catch((function(e){console.error(e)}))}else console.log('"e.target.files" is null.')}),[d]),f=(0,c.useCallback)((function(){t({type:A.SettingsSet,data:{shouldEnableEfficientRendering:!a.shouldEnableEfficientRendering}})}),[t,a.shouldEnableEfficientRendering]),p=(0,c.useCallback)((function(){t({type:A.SettingsSet,data:{shouldEnableDevMode:!a.shouldEnableDevMode}})}),[t,a.shouldEnableDevMode]);switch(e.viewMode){case"NavItem":case"Block":return c.createElement("div",{className:Mo.status},c.createElement(Eo,null),c.createElement("div",{className:Mo.blockCounter},c.createElement(To,{value:r.blocks.length})),c.createElement("div",{className:Mo.canvasMonitor},c.createElement(So,{focus:r.camera.focus,scale:r.camera.scale,selecting:r.selecting,selectedCount:r.selectedBlockIds.length})),c.createElement("div",{className:Mo.buttons},c.createElement("button",{onClick:f},"Turn ",a.shouldEnableEfficientRendering?"OFF ":"ON "," ","efficient rendering"),c.createElement("button",{onClick:p},"Turn ",a.shouldEnableDevMode?"OFF ":"ON "," dev mode"),c.createElement("button",{onClick:s},"Create 100 blocks"),c.createElement("button",{onClick:l},"Export all concepts"),c.createElement("label",{className:Mo.chooseFileButton},c.createElement("input",{type:"file",accept:".json",onChange:u}),c.createElement("span",null,"Import concepts"))));default:return c.createElement("div",{className:Mo.statusCardTitle},"About Jade & nerd info")}},toText:function(){return"status, About Jade & nerd info"}};function jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Do(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jo(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var No=(0,d.zE)({"Search--Linking":{cursor:"grabbing"},SearchBar:{display:"flex",alignItems:"center",padding:u.paddings.blockCompact},SearchIcon:{flex:"0 0 1.5rem",width:"1.5rem",height:"1.5rem",padding:".2rem",marginRight:".3rem",fill:u.colors.neutral50},SearchInput:Do(Do({},Je),{},{flex:"1 1 0",padding:".1rem",fontSize:".8rem",width:"100%",color:u.colors.contentText,$nest:{"&::placeholder":{color:u.colors.neutral50,fontSize:".8rem"}}}),SearchShortcutHint:{flex:"0 0 4rem",height:"1.5rem",marginLeft:".3rem",fontSize:".6rem",color:u.colors.neutral50,display:"flex",justifyContent:"center",alignItems:"center"},ScrollList:{height:"100%",maxHeight:500,overflow:"auto",paddingLeft:"1.25rem",paddingRight:"1.25rem"},ScrollListItem:{position:"relative",maxHeight:150,overflow:"hidden",marginLeft:"-.5rem",marginRight:"-.5rem",borderRadius:u.borders.smallRadius,$nest:{"&:last-of-type":{marginBottom:".5rem"}}},ScrollListItemOverlay:{position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:"background 50ms ".concat(u.easings.easeInOutCubic),$nest:{"&:hover":{background:u.colors.bgHover},"&:active":{background:u.colors.bgActive}}},Divider:{border:"none",borderBottom:"1px solid ".concat(u.colors.neutral90),$nest:{"&:last-of-type":{display:"none"}}},VisualCopy:{width:300,maxHeight:200,overflow:"hidden",zIndex:99999},pageControl:{display:"flex",alignItems:"center",padding:u.paddings.blockComfort,fontSize:".8rem",textAlign:"center",color:u.colors.neutral50},pageButton:{flex:"0 0 50px",padding:".2rem .6rem",borderRadius:u.borders.smallRadius,transition:"background 0.1s ease-in-out",cursor:"pointer",$nest:{"&:hover":{background:u.colors.bgHover},"&:active":{background:u.colors.bgActive}}},pageInfo:{flex:"1 1 0px"},tabs:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0 .75rem .5rem"},tabButton:Do(Do({},_e),{},{flex:"1 1 0",color:u.colors.neutral60,fontSize:".8rem",lineHeight:1.25,padding:".2rem .6rem",marginRight:".3rem",$nest:Do({"&:last-of-type":{marginRight:0}},_e.$nest)}),Selected:{backgroundColor:u.colors.bgHover},ContentPreview:{maxHeight:"inherit",pointerEvents:"none"},tabDescription:{margin:0,padding:"0 .75rem .75rem",color:u.colors.neutral40,fontSize:".8rem",textAlign:"center"}});function Lo(e,t){var n=(0,c.useState)(0),r=(0,l.Z)(n,2),o=r[0],a=r[1],i=(o+1)*t;return{page:o,start:o*t,nextStart:i,goPrevPage:function(){0!==o&&a(o-1)},goNextPage:function(){i>e.length-1||a(o+1)},resetPage:function(){a(0)}}}function Ao(e,t){var n=e.lastEditedTime||0;return(t.lastEditedTime||0)-n}function Zo(e,t,n){var r={},o={},a={},i=n.searchConceptByText(e);e?i.forEach((function(e){return a[e.item.id]=e.item})):t.forEach((function(e){return a[e.id]=e}));for(var c=function(e){var n=t[e];r[n.id]=n,n.references.forEach((function(e){o[e.to]?o[e.to].push(n.id):o[e.to]=[n.id]}))},s=0;s<t.length;++s)c(s);var l={canvases:[],blocks:[],orphans:[]};return t.forEach((function(e){if(a[e.id]){H(e)&&l.canvases.push({type:"canvas",canvasId:e.id,concept:e});var t=o[e.id];t&&t.forEach((function(t){var n=r[t].references.find((function(t){return t.to===e.id}));n&&l.blocks.push({type:"block",canvasId:t,blockId:n.id,concept:e})})),H(e)||t||l.orphans.push({type:"orphan",canvasId:e.id,concept:e})}})),{canvases:l.canvases.sort((function(e,t){return Ao(e.concept,t.concept)})),blocks:l.blocks.sort((function(e,t){return Ao(e.concept,t.concept)})),orphans:l.orphans.sort((function(e,t){return Ao(e.concept,t.concept)}))}}function Ho(){}var Fo=(0,d.zE)({conceptPreview:{maxHeight:"inherit",pointerEvents:"none"}});function $o(e){var t=e.viewMode,n=e.conceptId,r=e.database,o=e.dispatchAction,a=e.blockId,i=De(n);return i?c.createElement("div",{className:Fo.conceptPreview},wa.createConceptDisplay(i.summary.type,{viewMode:t,blockId:a,readOnly:!0,concept:i,dispatchAction:o,factoryRegistry:wa,database:r,onChange:Ho,onReplace:Ho,onInteractionStart:Ho,onInteractionEnd:Ho})):c.createElement("p",null,"Cannot get concept ",n)}var _o=c.memo((function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}))})),Vo={Idle:Symbol("idle"),Linking:Symbol("linking")},Wo=function(e){var t=e.dispatchAction,n=e.database,r=e.blockId,a=$(),s=V().createOverlay,u=(0,c.useRef)(null),f=(0,c.useRef)(null),p=(0,c.useState)(""),m=(0,l.Z)(p,2),g=m[0],y=m[1],h=(0,c.useState)(!0),v=(0,l.Z)(h,2),x=v[0],k=v[1],O=(0,c.useState)("canvas"),T=(0,l.Z)(O,2),C=T[0],S=T[1],I=(0,c.useState)({canvases:[],blocks:[],orphans:[]}),P=(0,l.Z)(I,2),B=P[0],z=P[1],M=(0,c.useRef)(null);(0,c.useEffect)((function(){M.current&&(clearTimeout(M.current),M.current=null),x?z({canvases:[],blocks:[],orphans:[]}):M.current=setTimeout((function(){function e(){return e=(0,o.Z)(i().mark((function e(){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getAllConcepts();case 2:t=e.sent,r=Zo(g,t,n),z(r);case 5:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){throw e}))}),50)}),[g,n,x]);var R="canvas"===C?B.canvases:"block"===C?B.blocks:B.orphans,j=(0,c.useState)(Vo.Idle),D=(0,l.Z)(j,2),N=D[0],L=D[1],Z=(0,c.useState)({valid:!1}),H=(0,l.Z)(Z,2),F=H[0],_=H[1],W=(0,c.useState)({x:0,y:0}),K=(0,l.Z)(W,2),J=K[0],G=K[1],U=(0,c.useState)({x:0,y:0}),Y=(0,l.Z)(U,2),X=Y[0],q=Y[1],Q=(0,c.useRef)(),ee=(0,c.useRef)(),te=(0,c.useRef)(),ne=(0,c.useRef)(),re=function(e){var t;e.target instanceof Node&&(null!==(t=u.current)&&void 0!==t&&t.contains(e.target)||k(!0))};(0,c.useEffect)((function(){Q.current=F}),[F]),(0,c.useEffect)((function(){ee.current=J}),[J]),(0,c.useEffect)((function(){te.current=X}),[X]),(0,c.useEffect)((function(){ne.current=a}),[a]),(0,c.useEffect)((function(){var e=u.current;if(e){var n=function(){var e="idle",n={x:0,y:0},r=function(t){var r=Oe(t);if("ready"===e&&w(r,n)>3&&Q.current&&Q.current.valid)k(!0),L(Vo.Linking),G(b(r,Q.current.rect)),e="linking";else if("linking"===e){var o;if(null===(o=Q.current)||void 0===o||!o.valid)return;q(b(r,Q.current.rect))}n=r},o=function o(a){if(window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",o),window.removeEventListener("touchend",o),"ready"===e){var i=Q.current;null!=i&&i.valid&&t({type:A.BlockOpenAsCanvas,data:"canvas"===i.item.type||"orphan"===i.item.type?{id:i.item.canvasId}:{id:i.item.canvasId,focusBlockId:i.item.blockId}})}else if("linking"===e){var c=Q.current,s=ee.current,l=te.current,d=ne.current;if(null!=c&&c.valid&&l&&s&&d){var u=d.camera.scale;t({type:A.BlockCreate,data:{id:c.item.concept.id,position:E({x:c.rect.left+l.x-s.x*u,y:c.rect.top+l.y-s.y*u},d.camera)}})}else console.error("s2lBlock is invalid");_({valid:!1}),G({x:0,y:0}),q({x:0,y:0}),L(Vo.Idle)}e="idle",n={x:0,y:0}};return{handlePointerDown:function(t){t.target instanceof Element&&u.current&&Array.from(u.current.querySelectorAll(".ScrollListItem")).find((function(e){return e.contains(t.target)}))&&t.stopPropagation(),e="ready";var a=Oe(t);n=a,window.addEventListener("mousemove",r),window.addEventListener("touchmove",r),window.addEventListener("mouseup",o),window.addEventListener("touchend",o)},handleKeyDown:function(t){"idle"===e&&((t.ctrlKey||t.metaKey)&&"p"===t.key?(f.current&&(f.current.value="",f.current.focus(),y("")),t.preventDefault()):"Escape"===t.key&&document.activeElement===f.current&&(f.current&&f.current.blur(),k(!0)))}}}();return e.addEventListener("mousedown",n.handlePointerDown),e.addEventListener("touchstart",n.handlePointerDown),window.addEventListener("mousedown",re),window.addEventListener("touchstart",re),window.addEventListener("keydown",n.handleKeyDown),function(){e.removeEventListener("mousedown",n.handlePointerDown),e.removeEventListener("touchstart",n.handlePointerDown),window.removeEventListener("mousedown",re),window.removeEventListener("touchstart",re),window.removeEventListener("keydown",n.handleKeyDown)}}}),[t]);var oe,ae,ie=Lo(B.canvases,20),ce=Lo(B.blocks,20),se=Lo(B.orphans,20),le="canvas"===C?ie:"block"===C?ce:se,de=le.page,ue=le.start,fe=le.nextStart,pe=le.goPrevPage,me=le.goNextPage,be=le.resetPage,ge=function(){switch(C){case"canvas":return"Topics, Boards, Playgrounds";case"block":return"Unit ideas, References of canvases";case"orphan":return"Concepts that you're about to forget"}}();return c.createElement("div",{className:(0,d.Sh)(N===Vo.Linking&&No["Search--Linking"]),ref:u},c.createElement("div",{className:No.SearchBar},c.createElement("div",{className:No.SearchIcon},c.createElement(_o,null)),c.createElement("input",{ref:f,className:No.SearchInput,placeholder:"Search",onChange:function(e){y(e.target.value),be()},onFocus:function(){k(!1)}}),x&&c.createElement("div",{className:No.SearchShortcutHint},"Ctrl/Cmd+P")),!x&&c.createElement(c.Fragment,null,c.createElement("div",{className:No.tabs},c.createElement("button",{className:(0,d.Sh)(No.tabButton,"canvas"===C&&No.Selected),onClick:function(){return S("canvas")}},"Canvas (",B.canvases.length,")"),c.createElement("button",{className:(0,d.Sh)(No.tabButton,"block"===C&&No.Selected),onClick:function(){return S("block")}},"Block (",B.blocks.length,")"),c.createElement("button",{className:(0,d.Sh)(No.tabButton,"orphan"===C&&No.Selected),onClick:function(){return S("orphan")}},"Orphan (",B.orphans.length,")")),c.createElement("p",{className:No.tabDescription},ge),c.createElement("div",{className:No.ScrollList},c.createElement("div",{key:de},R.slice(ue,fe).map((function(e,o){return c.createElement(c.Fragment,{key:"canvas"===e.type||"orphan"===e.type?e.canvasId:"".concat(e.canvasId,"-").concat(e.blockId,"-").concat(o)},N===Vo.Linking?c.createElement("div",{className:No.ScrollListItem},c.createElement($o,{blockId:r,conceptId:e.concept.id,viewMode:"NavItem",dispatchAction:t,database:n})):c.createElement("div",{className:"".concat(No.ScrollListItem," ScrollListItem"),onMouseEnter:function(t){_({valid:!0,item:e,rect:t.currentTarget.getBoundingClientRect()})},onMouseLeave:function(){_({valid:!1})}},c.createElement($o,{blockId:r,conceptId:e.concept.id,viewMode:"NavItem",dispatchAction:t,database:n}),c.createElement("div",{className:No.ScrollListItemOverlay})),c.createElement("hr",{className:No.Divider}))})))),c.createElement("div",{className:No.pageControl},c.createElement("div",{className:No.pageButton,onClick:pe},"Prev"),c.createElement("div",{className:No.pageInfo},ue+1," ~ ",Math.min(ue+20,R.length)," ","of ",R.length),c.createElement("div",{className:No.pageButton,onClick:me},"Next"))),N===Vo.Linking&&F.valid&&(oe=a.camera.scale,ae={x:F.rect.left+X.x-J.x*oe,y:F.rect.top+X.y-J.y*oe},s(c.createElement("div",{className:Ee.block,style:{transformOrigin:"top left",transform:"translate3d(".concat(ae.x,"px, ").concat(ae.y,"px, 0px) scale(").concat(oe,")"),width:300,pointerEvents:"none"}},c.createElement($o,{blockId:r,conceptId:F.item.concept.id,database:n,dispatchAction:t,viewMode:"Block"})))))},Ko={id:"searchtool",name:"Search Tool",isTool:!0,component:function(e){return"Block"!==e.viewMode?c.createElement("span",null,"Search Tool"):c.createElement(Wo,e)}};function Jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Go(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jo(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Uo=(0,d.zE)({HeaderToolNav:Go({},Ge),HeaderToolBlock:{width:"100%",display:"flex",flexWrap:"nowrap",padding:u.paddings.blockComfort,paddingTop:".35rem",paddingBottom:".35rem",minHeight:"2.2rem",maxHeight:"2.2rem",transition:"max-height 0.2s ".concat(u.easings.easeInOutCubic),overflow:"hidden"},HeaderToolBlockNotCollapsed:{maxHeight:300},Button:Go(Go({},_e),{},{flex:"0 0 1.5rem",width:"1.5rem",height:"1.5rem",padding:".2rem",fill:u.colors.contentText,$nest:Go({},_e.$nest)}),TitleContainer:{flex:"1 1 0",padding:".1rem .5rem",margin:"auto 0",fontSize:".95rem"},TitleContainerNotCollapsed:{maxHeight:"calc(".concat(300,"px - 0.7rem)"),overflow:"auto"},menu:Go(Go({},Ue),{},{boxShadow:u.shadows.layer,background:u.colors.bgCanvasSemiTransparent,backdropFilter:"saturate(180%) blur(30px)",width:216}),menuItem:Go({},Xe)}),Yo=function(){return c.createElement("svg",{className:ge,width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}))},Xo=c.memo((function(){var e=st(),t=V(),n=t.createOverlay,r=t.dispatchAction,o=(0,c.useRef)(null),a=(0,c.useRef)(null),i=(0,c.useState)(!1),s=(0,l.Z)(i,2),d=s[0],u=s[1],f=(0,c.useCallback)((function(){return u((function(e){return!e}))}),[]);(0,c.useEffect)((function(){function e(e){var t,n;null!==(t=o.current)&&void 0!==t&&t.contains(e.target)||null!==(n=a.current)&&void 0!==n&&n.contains(e.target)||u(!1)}if(d)return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[d]);var p,m,b=(0,c.useCallback)((function(){var t;lt((t=e.viewingConceptId,"jade://v1/concept/".concat(t))),u(!1)}),[e.viewingConceptId]),g=(0,c.useCallback)((function(){e.viewingConceptId!==e.homeConceptId&&r({type:A.SettingsSet,data:{homeConceptId:e.viewingConceptId}}),u(!1)}),[e.homeConceptId,e.viewingConceptId,r]);return c.createElement(c.Fragment,null,c.createElement("button",{ref:o,className:Uo.Button,onClick:f},c.createElement(Yo,null)),d&&n(c.createElement("div",{ref:a,className:Uo.menu,style:{transform:(p=o.current,m=null==p?void 0:p.getBoundingClientRect(),m?"translate(".concat((m.left+m.right)/2-108,"px, ").concat(m.bottom+5,"px)"):"")}},c.createElement("button",{className:Uo.menuItem,onClick:b},"Copy link to Canvas"),c.createElement("button",{className:Uo.menuItem,onClick:g},"Set as home"))))}));var qo=c.memo((function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1z"}))})),Qo=c.memo((function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"}))})),ea=c.memo((function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"}))})),ta=c.memo((function(){return c.createElement("svg",{className:ge,width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M24 24H0V0h24v24z",fill:"none",opacity:".87"}),c.createElement("path",{d:"M15.88 9.29L12 13.17 8.12 9.29c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0l4.59-4.59c.39-.39.39-1.02 0-1.41-.39-.38-1.03-.39-1.42 0z"}))})),na=function(){return c.createElement("svg",{className:ge,width:"100%",height:"100%",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),c.createElement("path",{d:"M11.29 8.71L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.38-.39-1.02-.39-1.41 0z"}))},ra=c.memo((function(){return c.createElement("svg",{className:ge,viewBox:"0 0 24 24",width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"},c.createElement("g",null,c.createElement("path",{d:"M12,3 L4,9v12h16v-2H6v-9l6-4.5l6,4.5v9h2V9L12,3z"})))})),oa={id:"headertool",name:"Header Tool",isTool:!0,component:function(e){var t,n=e.viewMode,r=e.blockId,o=e.database,a=e.dispatchAction,i=e.onInteractionStart,s=e.onInteractionEnd,u=$(),f=st(),p=(0,c.useState)(!0),m=(0,l.Z)(p,2),b=m[0],g=m[1],y=(0,c.useCallback)((function(){return g((function(e){return!e}))}),[]),h=(0,c.useCallback)((function(){var e=Nt("pmtext");o.createConcept(e),a({type:A.BlockOpenAsCanvas,data:{id:e.id}})}),[o,a]),v=(0,c.useCallback)((function(){g(!0),a({type:A.NavigateBack})}),[a]),w=(0,c.useCallback)((function(){}),[]);return"Block"!==n?c.createElement("div",{className:Uo.HeaderToolNav},"🔧 Header Tool"):c.createElement("div",{className:(0,d.Sh)(Uo.HeaderToolBlock,!b&&Uo.HeaderToolBlockNotCollapsed)},c.createElement("button",{className:Uo.Button,onClick:v},c.createElement(Qo,null)),c.createElement("button",{className:Uo.Button,onClick:w},c.createElement(ea,null)),c.createElement("button",{className:Uo.Button,onClick:function(){g(!0),a({type:A.BlockOpenAsCanvas,data:{id:f.homeConceptId}})}},c.createElement(ra,null)),c.createElement("div",{className:(0,d.Sh)(Uo.TitleContainer,!b&&Uo.TitleContainerNotCollapsed)},(t={viewMode:"CardTitle",readOnly:!1,dispatchAction:a,factoryRegistry:e.factoryRegistry,database:e.database,concept:u.viewingConcept,blockId:r,onChange:function(e){return a({type:A.ConceptWriteData,data:{id:u.viewingConcept.id,type:u.viewingConcept.summary.type,content:e}})},onReplace:function(e){return a({type:A.ConceptWriteData,data:{id:u.viewingConcept.id,type:e,content:{initialized:!1}}})},onInteractionStart:i,onInteractionEnd:s,key:"CardTitle-"+u.viewingConcept.id},e.factoryRegistry.createConceptDisplay(u.viewingConcept.summary.type,t))),c.createElement("button",{className:Uo.Button,onClick:y},b?c.createElement(ta,null):c.createElement(na,null)),c.createElement("button",{className:Uo.Button,onClick:h},c.createElement(qo,null)),c.createElement(Xo,null))}},aa=(0,d.zE)({Recent:{width:"100%",height:40,display:"flex",padding:"0px 20px",$nest:{"& button":{border:"none",background:"unset",lineHeight:1.3},"& button:focus":{outline:"none"}}},RecentBtn:{flex:"1 0 75px",maxWidth:300,height:"100%",overflow:"hidden",transition:"background 0.2s, flex-basis 0.3s",padding:"0 5px",borderRadius:u.borders.smallRadius,cursor:"pointer",color:u.colors.contentText,$nest:{"&:hover":{background:u.colors.bgHover,overflowY:"scroll",paddingRight:0},"&:active":{background:u.colors.bgActive},"&::-webkit-scrollbar":{width:5,backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{background:"rgba(0, 0, 0, 0.25)",$nest:{"&:active":{background:"rgba(0, 0, 0, 0.5)"}}}}},ContentPreview:{pointerEvents:"none",height:"100%"}}),ia={id:"recenttool",name:"Recent Tool",isTool:!0,component:function(e){var t=e.viewMode,n=e.blockId,r=e.dispatchAction,o=e.database,a=$().expandHistory,i=(0,c.useRef)(null);return"Block"!==t?c.createElement("span",null,"Recent Tool"):c.createElement("div",{className:aa.Recent,ref:i},function(){for(var e,t=[],i=(null===(e=U.getMeasuredSize(n))||void 0===e?void 0:e.width)||0,s=Math.floor(i/100),l=function(e){var n=a[e];return n?!t.find((function(e){return e===n}))&&(t.push(n),t.length>=s)?"break":void 0:"continue"},d=a.length-2;d>=0;d--){var u=l(d);if("continue"!==u&&"break"===u)break}return t.map((function(e){return c.createElement("button",{className:aa.RecentBtn,onClick:function(){r({type:A.BlockOpenAsCanvas,data:{id:e}})},key:e},c.createElement($o,{blockId:n,conceptId:e,database:o,dispatchAction:r,viewMode:"NavItem"}))}))}())}};function ca(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ca(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ca(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var la=(0,d.zE)({Insight:{padding:u.paddings.blockComfort,maxHeight:500,overflow:"auto"},InsightItem:{position:"relative",maxHeight:150,overflow:"hidden",marginLeft:"-.5rem",marginRight:"-.5rem",borderRadius:u.borders.smallRadius,transition:"background 0.1s ease-in-out",$nest:{"&:hover":{background:u.colors.bgHover,opacity:.9},"&:active":{background:u.colors.bgActive,opacity:.8}}},Divider:{border:"none",borderBottom:"1px solid ".concat(u.colors.neutral90),$nest:{"&:last-of-type":{display:"none"}}},Header:{display:"flex",justifyContent:"center",alignItems:"center",color:u.colors.neutral50,$nest:{"&:not(:only-child)":{marginBottom:".5rem"},"& > div":{flex:"1 1 0"},"& > button":sa(sa({},_e),{},{flex:"0 0 1.4rem",width:"1.4rem",height:"1.4rem",padding:".15rem",$nest:sa(sa({},_e.$nest),{},{"& > svg":{fill:u.colors.neutral50}})})}},HeaderText:{color:u.colors.neutral50,fontSize:".8rem"}});function da(e,t){var n,r=(n={},t.forEach((function(e){return n[e.id]=e})),n);return t.reduce((function(t,n){var o=n.references.filter((function(t){return t.to===e||function(e,t){return!!(t&&t.summary&&t.summary.type)&&"pmtext"===t.summary.type&&function(e,t){var n=vr(t.summary.data.data,Jn);if(!n)return!1;var r=!1;return n.descendants((function(t){if(t.text){var n=t.marks.find((function(e){return e.type.name===Wn}));if(!n)return;var o=n.attrs.href;ft(o)&&ut(o).conceptId===e&&(r=!0)}})),r}(e,t)}(e,r[t.to])}));return t.concat(o.map((function(e){return{concept:n,blockId:e.id}})))}),[])}var ua={id:"insighttool",name:"Insight Tool",isTool:!0,component:function(e){var t=e.viewMode,n=e.blockId,r=e.dispatchAction,a=e.database,s=$(),d=(0,c.useState)([]),u=(0,l.Z)(d,2),f=u[0],p=u[1],m=(0,c.useState)(!0),b=(0,l.Z)(m,2),g=b[0],y=b[1];return(0,c.useEffect)((function(){var e=function(){var e=(0,o.Z)(i().mark((function e(){var t,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.getAllConcepts();case 2:t=e.sent,n=da(s.viewingConcept.id,t),p(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e().catch((function(e){throw e}))}),[a,s.viewingConcept.id]),"Block"!==t?c.createElement("span",null,"Insight Tool"):c.createElement("div",{className:la.Insight},f.length?c.createElement(c.Fragment,null,c.createElement("div",{className:la.Header},c.createElement("div",{className:la.HeaderText},"Embedded at"," ",g&&"".concat(f.length," place").concat(f.length>1?"s":"")),c.createElement("button",{onClick:function(){return y(!g)}},g?c.createElement(na,null):c.createElement(ta,null))),!g&&f.map((function(e){var t=e.concept,o=e.blockId;return c.createElement(c.Fragment,{key:"".concat(t.id,"/").concat(o)},c.createElement("div",{className:la.InsightItem,onClick:function(){return r({type:A.BlockOpenAsCanvas,data:{id:t.id,focusBlockId:o}})}},c.createElement($o,{blockId:n,conceptId:t.id,database:a,dispatchAction:r,viewMode:"NavItem"})),c.createElement("hr",{className:la.Divider}))}))):c.createElement("div",{className:la.HeaderText},"Not embedded anywhere"))}};function fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fa(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ma=(0,d.zE)({cssBlock:{padding:u.paddings.blockComfort},cssNavItem:pa(pa({},Jr),{},{color:u.colors.contentText}),textarea:{display:"block",color:u.colors.contentText,background:"inherit",outlineColor:u.colors.contentText,fontFamily:u.fonts.monospace,lineHeight:1.4,width:"100%",height:300,padding:"0.5rem",border:"none",resize:"none",cursor:"inherit",$nest:{"&:focus-visible":{outline:"none"}}},noScrollAndPadding:{padding:0,overflow:"hidden"}});function ba(e){var t=e.readOnly,n=e.concept,r=e.onChange,o=e.onInteractionStart,a=e.onInteractionEnd,i=n.summary.data.globalCss,s=(0,c.useRef)(),d=(0,c.useRef)(),u=(0,c.useRef)(null),f=(0,c.useState)(i),p=(0,l.Z)(f,2),m=p[0],b=p[1];return(0,c.useEffect)((function(){var e=document.createElement("style"),t=document.createTextNode("");return e.appendChild(t),document.head.appendChild(e),s.current=e,d.current=t,function(){document.head.removeChild(e)}}),[]),(0,c.useEffect)((function(){d.current&&(d.current.textContent=m)}),[m]),(0,c.useEffect)((function(){var e=u.current;if(e){var t=function(e){e.ctrlKey||e.stopPropagation()};return e.addEventListener("wheel",t),function(){return e.removeEventListener("wheel",t)}}}),[]),(0,c.useEffect)((function(){var e=u.current;if(t&&e){e.blur();var n=window.getSelection();n&&n.removeAllRanges()}}),[t]),c.createElement("div",{className:ma.cssBlock},c.createElement("textarea",{ref:u,value:m,className:ma.textarea,onFocus:o,onBlur:a,onChange:function(e){b(e.target.value),r({globalCss:e.target.value})},readOnly:t}))}function ga(e){var t=e.concept.summary.data.globalCss;return c.createElement("div",{className:ma.cssNavItem},c.createElement("textarea",{value:t,className:(0,d.Sh)(ma.textarea,ma.noScrollAndPadding),readOnly:!0}))}var ya={id:"css",name:"CSS",component:function(e){return"NavItem"===e.viewMode?c.createElement(ga,e):c.createElement(ba,e)},toText:function(e){return e.summary.data.globalCss||""}};function ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function va(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ha(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wa=new((0,J.Z)((function e(){var t=this;(0,G.Z)(this,e),(0,r.Z)(this,"factories",[Nr,Kr,qr,vo,Ro,Ko,oa,ia,ua,ya].map((function(e){return va(va({},e),{},{component:c.memo(e.component)})}))),(0,r.Z)(this,"default",Nr),(0,r.Z)(this,"getDefaultContentFactory",(function(){return t.default})),(0,r.Z)(this,"getContentFactories",(function(){return t.factories.filter((function(e){return!e.isTool}))})),(0,r.Z)(this,"getToolFactories",(function(){return t.factories.filter((function(e){return e.isTool}))})),(0,r.Z)(this,"getFactory",(function(e){return t.factories.find((function(t){return t.id===e}))})),(0,r.Z)(this,"getConceptString",(function(e){var n=e.summary.type,r=t.getFactory(n);return r&&r.toText?r.toText(e):""})),(0,r.Z)(this,"createConceptDisplay",(function(e,n){var r=t.getFactory(e);return r?c.createElement(sn,null,c.createElement(r.component,n)):c.createElement("span",null,'Factory "',e,'" does not exist in registry.')}))})));function xa(){var e=localStorage.getItem("state_v3");if(e)try{return JSON.parse(e)}catch(e){return}}function ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oa=Date.now(),Ta=n(9004),Ca=[Nt("headertool"),Nt("recenttool"),Nt("insighttool"),Nt("searchtool")],Sa={id:"__tool_mask__",summary:{type:"toolmask",data:void 0},references:[q({to:Ca[0].id,posType:z.PinnedTL,pos:{x:400,y:10},size:{w:450,h:"auto"}}),q({to:Ca[1].id,posType:z.PinnedTR,pos:{x:10,y:10},size:{w:450,h:"auto"}}),q({to:Ca[2].id,posType:z.PinnedBR,pos:{x:10,y:10},size:{w:250,h:"auto"}}),q({to:Ca[3].id,posType:z.PinnedTL,pos:{x:10,y:10},size:{w:270,h:"auto"}})],relations:[],drawing:[],camera:{focus:{x:0,y:0},scale:1},createdTime:Oa,lastEditedTime:Oa},Ia=Ta.map((function(e){return Ea(Ea({},e),{},{references:e.references.map((function(e){return Ea(Ea({},e),{},{posType:void 0===e.posType?z.Normal:e.posType})})),camera:e.camera||{focus:{x:0,y:0},scale:1},createdTime:e.createdTime||Oa,lastEditedTime:e.lastEditedTime||Oa})})).concat(Ta.find((function(e){return"__tool_mask__"===e.id}))?[]:Ca.concat(Sa)),Pa="home";function Ba(){return{homeConceptId:Pa,viewingConceptId:Pa,shouldEnableDevMode:!1,shouldEnableEfficientRendering:!0}}function za(e){var t=Ba();return{homeConceptId:e.homeConceptId||t.homeConceptId,viewingConceptId:e.viewingConceptId||t.viewingConceptId,shouldEnableDevMode:void 0===e.shouldEnableDevMode?t.shouldEnableDevMode:e.shouldEnableDevMode,shouldEnableEfficientRendering:void 0===e.shouldEnableEfficientRendering?t.shouldEnableEfficientRendering:e.shouldEnableEfficientRendering}}var Ma=n(4221);function Ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ja(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ra(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Da={threshold:.2,distance:15,keys:[{name:"summary.type",weight:.2},{name:"summary.text",weight:.8}],useExtendedSearch:!0,includeScore:!0,ignoreLocation:!0,ignoreFieldNorm:!0};function Na(e,t){var n=new Ma.Z([],Da);function r(){return(r=(0,o.Z)(i().mark((function t(){var r,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAllConcepts();case 2:r=t.sent,o=r.map(a),n.setCollection(o);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function a(e){return ja(ja({},e),{},{summary:ja(ja({},e.summary),{},{text:t.getConceptString(e)})})}return function(){return r.apply(this,arguments)}().catch((function(e){throw e})),ja(ja({},e),{},{init:function(t,r){return n.setCollection(r.map(a)),e.init(t,r)},createConcept:function(t){n.add(a(t)),e.createConcept(t)},updateConcept:function(t){n.remove((function(e){return e.id===t.id})),n.add(a(t)),e.updateConcept(t)},searchConceptByText:function(e,t){return n.search(e,t)}})}function La(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?La(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):La(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Za(){return Za=(0,o.Z)(i().mark((function e(t,n){var r,o,a,l,d,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.title="Jade v".concat(xo.JADE_VER),r=Na(t,wa),o=xa(),e.next=5,r.isValid();case 5:if(e.t0=!e.sent,!e.t0){e.next=8;break}e.t0=o;case 8:if(!e.t0){e.next=12;break}return console.log("core/index: Migrating state_v3"),e.next=12,r.init({shouldEnableDevMode:o.debugging,shouldEnableEfficientRendering:!0,homeConceptId:o.homeConceptId,viewingConceptId:o.viewingConceptId},Object.values(o.conceptMap).map((function(e){return Aa(Aa({},e),{},{relations:[]})})));case 12:return e.next=14,r.isValid();case 14:if(e.t1=e.sent,!e.t1){e.next=21;break}return e.t2=O,e.next=19,r.getVersion();case 19:e.t3=e.sent,e.t1=(0,e.t2)(e.t3);case 21:if(!e.t1){e.next=32;break}return console.log("core/index: Migrating state4"),e.next=26,r.getAllConcepts();case 26:a=e.sent,l=Date.now(),a.forEach((function(e){return r.updateConcept({id:e.id,camera:{focus:{x:0,y:0},scale:1},drawing:e.drawing,references:e.details.map((function(e){return{id:e.id,to:e.to,posType:z.Normal,pos:e.position,size:{w:e.width,h:"auto"},createdTime:l,lastEditedTime:l}})),relations:[],summary:e.summary,createdTime:l,lastEditedTime:l})})),r.createConcept(Sa),Ca.forEach((function(e){return r.createConcept(e)})),r.setVersion(5);case 32:return e.next=34,r.isValid();case 34:if(!e.sent){e.next=38;break}d=r.getSettings(),u=za(d),r.saveSettings(u);case 38:return e.next=40,r.isValid();case 40:if(e.sent){e.next=44;break}return console.log("core/index: Bootstrap new db"),e.next=44,r.init({homeConceptId:"home",viewingConceptId:"b1f78b9d-eebd-4d94-b3e3-ba80b54769ff",shouldEnableDevMode:!1,shouldEnableEfficientRendering:!0},Ia);case 44:s.render(c.createElement(rn,{db:r,openExternal:n,factoryRegistry:wa}),document.getElementById("react-root"));case 45:case"end":return e.stop()}}),e)}))),Za.apply(this,arguments)}var Ha=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.auditChannel;(0,G.Z)(this,e),(0,r.Z)(this,"subscriberMap",void 0),(0,r.Z)(this,"lastEmitTime",void 0),(0,r.Z)(this,"auditChannel",void 0),(0,r.Z)(this,"publish",(function(e,n){var r=t.subscriberMap[e];if(r&&r.length>0)for(var o=0;o<r.length;o++)r[o].callback(n);var a=Date.now();a-t.lastEmitTime>16&&e!==t.auditChannel&&t.publishAuditMessage("publish",e),t.lastEmitTime=a})),(0,r.Z)(this,"subscribe",(function(e,n){var r=t.subscriberMap[e],o={user:"",callback:n};r&&r.length>0?r.push(o):t.subscriberMap[e]=[o],t.publishAuditMessage("subscribe",e)})),(0,r.Z)(this,"unsubscribe",(function(e,n){var r=t.subscriberMap[e];if(r&&r.length>0)for(var o=0;o<r.length;o++)if(r[o].callback===n){r.splice(o,1);break}t.publishAuditMessage("unsubscribe",e)})),this.subscriberMap={},this.lastEmitTime=0,this.auditChannel=o}return(0,J.Z)(e,[{key:"publishAuditMessage",value:function(e,t){if(this.auditChannel){var n=Object.entries(this.subscriberMap).map((function(e){return{name:e[0],subNum:e[1].length}}));this.publish(this.auditChannel,{activeChannel:t,action:e,channels:n})}}}]),e}();function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _a=new Ha;function Va(){localStorage.setItem("lastUpdatedAt",Date.now().toString())}var Wa={isValid:function(){return new Promise((function(e){e(null!==localStorage.getItem("JADE_DB_LOADED"))}))},init:function(e,t){return new Promise((function(n){Wa.saveSettings(e),t.forEach((function(e){Wa.createConcept(e)})),localStorage.setItem("JADE_DB_LOADED",""),localStorage.setItem("JADE_DB_VER",xo.JADE_DB_VER.toString()),n()}))},getConcept:function(e){return new Promise((function(t){try{var n=localStorage.getItem("concept/".concat(e));if(!n)return void t(void 0);var r=JSON.parse(n);t(r.relations?r:$a($a({},r),{},{relations:[]}))}catch(e){t(void 0)}}))},getAllConcepts:function(){return new Promise((function(e){for(var t=[],n=0;n<localStorage.length;n++){var r=localStorage.key(n);if(r&&r.startsWith("concept")){var o=localStorage.getItem(r);if(!o)continue;var a=JSON.parse(o);t.push(a.relations?a:$a($a({},a),{},{relations:[]}))}}e(t)}))},updateConcept:function(e){setTimeout((function(){localStorage.setItem("concept/".concat(e.id),JSON.stringify(e)),Va(),_a.publish(e.id,e),_a.publish("*",e)}),0)},createConcept:function(e){localStorage.setItem("concept/".concat(e.id),JSON.stringify(e)),Va(),_a.publish(e.id,e),_a.publish("*",e)},getSettings:function(){try{var e=localStorage.getItem("settings");if(!e)throw new Error("Settings is null");return JSON.parse(e)}catch(e){console.error(e);var t=Ba();return Wa.saveSettings(t),t}},saveSettings:function(e){localStorage.setItem("settings",JSON.stringify(e)),Va()},getLastUpdatedTime:function(){var e=localStorage.getItem("lastUpdatedAt");return e?parseInt(e):0},getVersion:function(){return new Promise((function(e){var t=localStorage.getItem("JADE_DB_VER");e(t?parseInt(t):0)}))},setVersion:function(e){localStorage.setItem("JADE_DB_VER",e.toString())},subscribeConcept:_a.subscribe,unsubscribeConcept:_a.unsubscribe};(function(e,t){return Za.apply(this,arguments)})(Wa,(function(e){var t=window.open();t&&(t.opener=null,t.location.assign(e))})).catch(console.error)},6982:(e,t,n)=>{e.exports=n.p+"assets/2272b1ebf4a4f045f2ad.png"},9004:e=>{e.exports=JSON.parse('[{"id":"f581070a-4100-4cdc-9fd5-2f5ca5092199","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"You start by "},{"type":"text","marks":[{"type":"bold"}],"text":"creating"},{"type":"text","text":" "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"s."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634303968652,"lastEditedTime":1640458346033},{"id":"ddcd8423-05f3-4cf5-869d-c1a73d182d17","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Manage contacts."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056114969,"lastEditedTime":1634056123914},{"id":"370b5e79-f728-4be6-9734-f00e17c58400","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/87888b5b-5747-43ef-ba05-208952e3c3a6","title":null}}],"text":"← Prev"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313693054,"lastEditedTime":1634313774295},{"id":"c2525cc9-01c9-4142-b289-8eedae6f4b13","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-pink"}}],"text":"Link"},{"type":"text","text":" thoughts in different contexts."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634310641124,"lastEditedTime":1640458682579},{"id":"67214f92-be5d-4d87-9313-472e48685e2c","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-orange"}}],"text":"Connect"},{"type":"text","text":" related thoughts with arrows."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634310574552,"lastEditedTime":1640458614277},{"id":"72079351-217f-4529-920c-3ee8f8bb3bb3","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Jade is like your "},{"type":"text","marks":[{"type":"bold"}],"text":"table"},{"type":"text","text":" and "},{"type":"text","marks":[{"type":"bold"}],"text":"stationery"},{"type":"text","text":", letting you bring in "},{"type":"text","marks":[{"type":"bold"}],"text":"resources"},{"type":"text","text":" you care, "},{"type":"text","marks":[{"type":"bold"}],"text":"capture"},{"type":"text","text":" / "},{"type":"text","marks":[{"type":"bold"}],"text":"connect"},{"type":"text","text":" small yet precious thoughts, and evolve useful "},{"type":"text","marks":[{"type":"bold"}],"text":"knowledge"},{"type":"text","text":" from them."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634055507652,"lastEditedTime":1640458319979},{"id":"4fc501f5-40b9-4257-ae52-09d7803ff499","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Drag a search result out."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634314431412,"lastEditedTime":1634314456200},{"id":"8dfecddd-7592-49f6-8a2a-7af588710597","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Build a design gallery."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056165169,"lastEditedTime":1634056834769},{"id":"cda5c762-3e28-4b37-bf20-aee61c6fa9eb","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Hit "},{"type":"text","marks":[{"type":"code"}],"text":"Enter"},{"type":"text","text":" in a "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":" to create another one below. This lets you quickly record a sequence of thoughts."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634304575792,"lastEditedTime":1640458550061},{"id":"b1f78b9d-eebd-4d94-b3e3-ba80b54769ff","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Jade Tutorial"}]}}},"references":[{"id":"ab8fc9ce-5957-4d93-b74a-5f22bc72daa6","createdTime":1634051255657,"lastEditedTime":1634051255657,"to":"8a15e8a7-aa41-4b42-a39b-f9e4dd3fe167","posType":1,"pos":{"x":-990.99995936164,"y":288.0820601749857},"size":{"w":300,"h":"auto"}},{"id":"265d4489-ebcf-4661-acca-d08eea7f1c4c","createdTime":1634052540093,"lastEditedTime":1634052540093,"to":"home","posType":1,"pos":{"x":4710.13318916579,"y":303.66882945634825},"size":{"w":405,"h":"auto"}},{"id":"0676953a-557a-45dd-9788-ba59f64fc309","createdTime":1634053060729,"lastEditedTime":1634053060729,"to":"eb7eb6e9-bf5d-4a0d-9383-2daa41bb3b50","posType":1,"pos":{"x":-1123.206819655667,"y":288.0820601749857},"size":{"w":127.21847453083598,"h":"auto"}},{"id":"dfd6f57d-70cf-4fc9-802d-e9c0f7bafcdf","createdTime":1634055179884,"lastEditedTime":1634055179884,"to":"805f1c64-e0ad-49b7-a542-56bd1e5a4e6f","posType":1,"pos":{"x":4710.13318916579,"y":355.3584847603033},"size":{"w":405,"h":"auto"}},{"id":"1e8dad96-c9cf-4d6a-bd80-a86bc1b1ff3e","createdTime":1634055507654,"lastEditedTime":1634055507654,"to":"72079351-217f-4529-920c-3ee8f8bb3bb3","posType":1,"pos":{"x":-990.9999257347689,"y":339.77174180997883},"size":{"w":474.1329719530507,"h":"auto"}},{"id":"9206c6d6-a950-4ce8-b8ae-549ee8562b95","createdTime":1634057800920,"lastEditedTime":1634057800920,"to":"cb4952ef-d47a-4c53-a9be-5520ae02da0d","posType":1,"pos":{"x":718.2138599710447,"y":771.2296779949529},"size":{"w":116.5,"h":"auto"},"color":"background-blue"},{"id":"359df0a0-57ea-4ea9-823c-111260e7e00c","createdTime":1634304171337,"lastEditedTime":1634304171337,"to":"7583f5d7-46b1-45fd-8c2e-b3ae2fd17bb6","posType":1,"pos":{"x":718.2138599710447,"y":578.4710453350408},"size":{"w":374,"h":"auto"}},{"id":"87888b5b-5747-43ef-ba05-208952e3c3a6","createdTime":1634304264221,"lastEditedTime":1634304264221,"to":"67764109-fdae-4469-addc-c72d9f30e8e9","posType":1,"pos":{"x":1739.0230226884514,"y":-389.37700480987417},"size":{"w":374,"h":"auto"}},{"id":"af55ff6a-0d6a-4bbe-9de9-da0cc5e4c8df","createdTime":1634304575793,"lastEditedTime":1634304575793,"to":"cda5c762-3e28-4b37-bf20-aee61c6fa9eb","posType":1,"pos":{"x":1739.0230226884514,"y":-280.30803126861434},"size":{"w":374,"h":"auto"}},{"id":"2310b763-6bed-49e5-af5d-ae56226c15f2","createdTime":1634305155164,"lastEditedTime":1634305155164,"to":"753c8d99-8931-4b96-96a0-e03313811ed9","posType":1,"pos":{"x":2000.023160017553,"y":-170.13561458160262},"size":{"w":113,"h":"auto"},"color":"background-blue"},{"id":"52102358-30d1-4b4f-97f6-d1023b9b2396","createdTime":1634306596347,"lastEditedTime":1634306596347,"to":"4516c95d-d3cc-412a-a683-c68705517ab3","posType":1,"pos":{"x":-513.4334397582429,"y":476.1165599252132},"size":{"w":116,"h":"auto"},"color":"background-blue"},{"id":"ccbc0cb1-1b48-46f2-9387-d59078a50e08","createdTime":1634307529485,"lastEditedTime":1634307529485,"to":"f6f02393-f01c-4fe8-b3c8-d4e6b1fc19ba","posType":1,"pos":{"x":1739.0230226884514,"y":-170.13561458160268},"size":{"w":116,"h":"auto"},"color":"background-blue"},{"id":"7e4e3cad-cc1d-4631-abfa-13294135f8ce","createdTime":1634307748921,"lastEditedTime":1634307748921,"to":"0a3706b8-f67a-49eb-9e57-291e26d62fbb","posType":1,"pos":{"x":2435.0852464087916,"y":418.62421074110796},"size":{"w":263.1060390802613,"h":"auto"},"color":"background-grey"},{"id":"64fd8807-34ea-44b7-a065-71c276b957d9","createdTime":1634307984208,"lastEditedTime":1634307984208,"to":"f8c62c5b-62fb-42c3-a223-e2332757740d","posType":1,"pos":{"x":718.2138599710447,"y":661.0572613079412},"size":{"x":706.4233124354648,"y":440.9670406437822,"w":374,"h":"auto"}},{"id":"38063a08-ab19-44fb-85ab-0eb4cbb4d3af","createdTime":1634308140909,"lastEditedTime":1634308140909,"to":"0f7090cd-df41-4328-834f-545edb86d10c","posType":1,"pos":{"x":270.2138599710447,"y":533.7813900310857},"size":{"w":400,"h":"auto"}},{"id":"871a8a57-9440-4dda-82fc-82240224fa4b","to":"2eb9e224-adf7-40fd-abc7-cdd2c79236c4","posType":1,"pos":{"x":1148.2138599710447,"y":533.3277701829929},"size":{"w":422,"h":250},"createdTime":1634308867627,"lastEditedTime":1634308946983},{"id":"27bd78dd-21fb-4e10-99a9-753055f4024c","createdTime":1634309127135,"lastEditedTime":1634309127135,"to":"bbb78b24-0b03-4cf0-96f6-36d8da124c11","posType":1,"pos":{"x":975.006960618735,"y":771.2296526892756},"size":{"w":117.20766124213878,"h":"auto"},"color":"background-blue"},{"id":"840c09b9-7c72-467c-8b52-3591eb079afa","createdTime":1634309144614,"lastEditedTime":1634309144614,"to":"f581070a-4100-4cdc-9fd5-2f5ca5092199","posType":1,"pos":{"x":718.2138599710447,"y":526.7813676370686},"size":{"w":374,"h":"auto"}},{"id":"bb33fb4c-e7dd-47bf-8990-e8b1cce80cc5","createdTime":1634310486675,"lastEditedTime":1634310486675,"to":"2fbb1df6-5c90-483d-aa65-20f4720a4843","posType":1,"pos":{"x":2989.1391234438097,"y":505.14856952840273},"size":{"w":405.00000000000045,"h":"auto"}},{"id":"96779e6f-0793-4d8d-8e68-6281f873c3ae","createdTime":1634310574552,"lastEditedTime":1634310574552,"to":"67214f92-be5d-4d87-9313-472e48685e2c","posType":1,"pos":{"x":2989.1391234438097,"y":556.8382248323578},"size":{"w":389,"h":"auto"}},{"id":"13eea517-1dad-45f1-90dc-a34137c2a00f","createdTime":1634310592853,"lastEditedTime":1634310592853,"to":"c2f2a509-87b5-45ff-81ab-85c6de98dfaf","posType":1,"pos":{"x":2989.1391234438097,"y":608.5278801363129},"size":{"w":389,"h":"auto"}},{"id":"f4bfb3fe-5602-492f-83f3-864a79df6b10","createdTime":1634310641124,"lastEditedTime":1634310641124,"to":"c2525cc9-01c9-4142-b289-8eedae6f4b13","posType":1,"pos":{"x":2989.1391234438097,"y":740.5968460481781},"size":{"w":349,"h":"auto"}},{"id":"ed7d6b4d-af5a-41dc-9a8f-d170d7bbbd40","createdTime":1634310987427,"lastEditedTime":1634310987427,"to":"58af6c26-4565-42c8-ad95-e4c540522c31","posType":1,"pos":{"x":2894.1391234438097,"y":505.14856952840273},"size":{"w":90,"h":"auto"}},{"id":"9edd4fb1-d220-479c-9be3-306e82199e56","createdTime":1634311163245,"lastEditedTime":1634311163245,"to":"cd924087-9834-4dfe-8430-623e4b28cf41","posType":1,"pos":{"x":2989.1391234438097,"y":688.907190744223},"size":{"w":283,"h":"auto"}},{"id":"14394fd7-74df-4183-b06e-9a292339ad35","createdTime":1634312031572,"lastEditedTime":1634312031572,"to":"a92621be-4538-4cae-9ac2-9ce352ad56a8","posType":1,"pos":{"x":3350.8726568563325,"y":688.8037437837738},"size":{"w":282,"h":"auto"},"color":"background-green"},{"id":"f161e4ee-ceb1-45c6-92c7-d7d55d9a8be5","createdTime":1634312065148,"lastEditedTime":1634312065148,"to":"72de3b3d-1d8f-432b-8938-fa288be377a3","posType":1,"pos":{"x":3390.8726568563325,"y":751.6856682440041},"size":{"w":370,"h":"auto"},"color":"background-pink"},{"id":"cb2c22cf-738f-41af-8f3e-903754f815d7","createdTime":1634312393789,"lastEditedTime":1634312393789,"to":"b2aada53-355d-4291-ba05-c6df9df2ed29","posType":1,"pos":{"x":3436.5567959528344,"y":505.14856952840273},"size":{"x":3366.9884035459963,"y":706.172265226204,"w":300,"h":"auto"},"color":"background-orange"},{"id":"423d4c3b-ff39-4c9a-9daa-0193380721ce","createdTime":1634312952447,"lastEditedTime":1634312952447,"to":"a06d4cd0-f42f-4299-9a63-50a10eb921ff","posType":1,"pos":{"x":2894.1391234438097,"y":424.7692589204925},"size":{"w":376.6548517371675,"h":"auto"}},{"id":"c448c24e-9e1c-4ca3-a582-8803f6d71410","createdTime":1634312315941,"lastEditedTime":1634312315941,"to":"a9e34922-7b8c-4058-882c-15646bc665d7","posType":1,"pos":{"x":3424.5567959528344,"y":599.3459763802898},"size":{"x":3344.9884035459963,"y":774.172265226204,"w":300,"h":"auto"},"color":"background-yellow"},{"id":"139dd214-cd0d-46db-b43d-4d53290aab9d","createdTime":1634313462867,"lastEditedTime":1634313462867,"to":"827f4330-b424-4384-9748-43c148f747e0","posType":1,"pos":{"x":2567.9617679031467,"y":510.9126773298717},"size":{"w":207.1289949261768,"h":"auto"},"color":"background-grey"},{"id":"484d0e4e-8b8b-4bc7-a45c-36ebe915c0f0","createdTime":1634306342894,"lastEditedTime":1634306342894,"to":"49debdfe-e9d3-4d5f-8a5b-cd7096d63869","posType":1,"pos":{"x":2468.5398133865046,"y":572.9148658262011},"size":{"w":281.22929504496005,"h":"auto"},"color":"background-grey"},{"id":"1577585b-cf5c-4584-99c6-4ae62406f6ca","createdTime":1634307144456,"lastEditedTime":1634307144456,"to":"f30e5148-f6c4-4252-9811-3135506d532f","posType":1,"pos":{"x":2494.523690519723,"y":670.0417627889528},"size":{"w":326.49276044460476,"h":"auto"},"color":"background-grey"},{"id":"f371bc71-06c8-4f75-ae68-ff3fbb3bb7aa","createdTime":1634313416527,"lastEditedTime":1634313416527,"to":"77d4dfe9-10ee-407b-a7b3-df1267fd90e7","posType":1,"pos":{"x":2430.0045545938237,"y":768.7610187203181},"size":{"w":320,"h":"auto"},"color":"background-grey"},{"id":"13b06410-95fb-48cf-9e0b-2ffe9fd3bd97","createdTime":1634313432539,"lastEditedTime":1634313432539,"to":"af67cfe7-e7ef-4b8d-b627-d4000dbc2a94","posType":1,"pos":{"x":2520.695821437951,"y":862.2787401343169},"size":{"x":4546.622587150884,"y":1246.895173880203,"w":300,"h":"auto"},"color":"background-grey"},{"id":"e4a1e744-c728-4776-acf4-20e08bab3d32","createdTime":1634313610310,"lastEditedTime":1634313610310,"to":"addb48b4-ad7f-4eed-b332-6d615227a52c","posType":1,"pos":{"x":2558.4665493123935,"y":355.62421074110796},"size":{"w":293,"h":"auto"},"color":"background-grey"},{"id":"fa8ab356-39df-464f-8987-3dfb8a435b32","createdTime":1634313693054,"lastEditedTime":1634313693054,"to":"370b5e79-f728-4be6-9734-f00e17c58400","posType":1,"pos":{"x":2413.498026719395,"y":303.9345554371529},"size":{"w":110.44137320548407,"h":"auto"},"color":"background-blue"},{"id":"ec0ed5d0-7921-48ce-9e2d-115996003c97","createdTime":1634313708309,"lastEditedTime":1634313708309,"to":"3dbb6a06-53df-43fb-acb4-7cf44957c0d4","posType":1,"pos":{"x":3662.165762935434,"y":863.370889766152},"size":{"w":111.71357875444028,"h":"auto"},"color":"background-blue"},{"id":"4dc336a3-2dad-4b33-98e0-ab617147606b","createdTime":1634313916561,"lastEditedTime":1634313916561,"to":"a83486f5-b348-4846-bbb0-63d6d4505b15","posType":1,"pos":{"x":2186.1944801522036,"y":-371.0655135080983},"size":{"x":2288.0230226884514,"y":-310.37700480987417,"w":300,"h":"auto"},"color":"background-grey"},{"id":"815cacbb-96e4-4bed-9170-a21115cf46fe","createdTime":1634314333195,"lastEditedTime":1634314333195,"to":"2e6808f2-c49e-42e2-8fee-9d9fc1ad4447","posType":1,"pos":{"x":4710.13318916579,"y":454.2895188484381},"size":{"w":110,"h":"auto"},"color":"background-blue"},{"id":"9125cc27-1b5d-4732-8332-f67be5130ca5","createdTime":1634314392690,"lastEditedTime":1634314392690,"to":"a00dcc85-c504-4561-b344-a88bb1f24348","posType":1,"pos":{"x":2989.1389736287997,"y":792.2864899080414},"size":{"w":295,"h":"auto"}},{"id":"7a3fa5cb-6346-4f03-a07f-63f4b435d62a","createdTime":1634314431412,"lastEditedTime":1634314431412,"to":"4fc501f5-40b9-4257-ae52-09d7803ff499","posType":1,"pos":{"x":3330.4665493123935,"y":842.7692589204926},"size":{"x":3239.4665493123935,"y":971.7692589204926,"w":300,"h":"auto"},"color":"background-purple"},{"id":"b5bc5ce7-e6a5-45bc-81a5-2c0edd15a826","createdTime":1634314617697,"lastEditedTime":1634314617697,"to":"cc7baa42-2423-4dfe-b86b-8456e03dbe32","posType":1,"pos":{"x":5168.349408180022,"y":278.71293481048616},"size":{"w":212.77250340274804,"h":"auto"}},{"id":"883d155b-5180-4e33-b8cd-6600b4bca4d7","createdTime":1634054077768,"lastEditedTime":1634054077768,"to":"5606238a-4d2f-497d-afa2-524cff5e08a2","posType":1,"pos":{"x":4711.150438814441,"y":142.91021329885422},"size":{"w":405,"h":"auto"}},{"id":"32b5dd75-27bf-4e83-8f2b-bdc69663b7af","createdTime":1634316296937,"lastEditedTime":1634316296937,"to":"17b1ebc5-fe6f-42bd-8b5f-d90019e1132f","posType":1,"pos":{"x":4711.150438814441,"y":194.59985620533678},"size":{"w":403.9999772426836,"h":"auto"}}],"relations":[{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"9edd4fb1-d220-479c-9be3-306e82199e56","toEntity":"block","toId":"14394fd7-74df-4183-b06e-9a292339ad35","id":"e4dd8d06-a743-4ec3-876b-60468cf27c8a"},{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"f4bfb3fe-5602-492f-83f3-864a79df6b10","toEntity":"block","toId":"f161e4ee-ceb1-45c6-92c7-d7d55d9a8be5","id":"d5a3141b-6f0b-41e6-8d15-3e9502917e30"},{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"96779e6f-0793-4d8d-8e68-6281f873c3ae","toEntity":"block","toId":"cb2c22cf-738f-41af-8f3e-903754f815d7","id":"549205a1-dfe1-4861-8164-e2d4aef41ed7"},{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"13eea517-1dad-45f1-90dc-a34137c2a00f","toEntity":"block","toId":"c448c24e-9e1c-4ca3-a582-8803f6d71410","id":"a0585435-bb1b-4dd0-8784-692680561aa5"},{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"9125cc27-1b5d-4732-8332-f67be5130ca5","toEntity":"block","toId":"7a3fa5cb-6346-4f03-a07f-63f4b435d62a","id":"80b1c3fb-b150-4811-af88-222063ebdb46"},{"type":"block-to-block-in-canvas","fromEntity":"block","fromId":"b5bc5ce7-e6a5-45bc-81a5-2c0edd15a826","toEntity":"block","toId":"265d4489-ebcf-4661-acca-d08eea7f1c4c","id":"4f7cf1ee-cfe4-44dc-af40-83b5bb73a2ae"}],"drawing":[],"camera":{"focus":{"x":-1507.9334397582436,"y":129.77174180997883},"scale":1},"createdTime":1634054429016,"lastEditedTime":1634054464290},{"id":"cd924087-9834-4dfe-8430-623e4b28cf41","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-green"}}],"text":"Mention"},{"type":"text","text":" well-known terms."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634311163244,"lastEditedTime":1640458626460},{"id":"cb4952ef-d47a-4c53-a9be-5520ae02da0d","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/1e8dad96-c9cf-4d6a-bd80-a86bc1b1ff3e","title":null}}],"text":"← Prev"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634057800919,"lastEditedTime":1634307492733},{"id":"58af6c26-4565-42c8-ad95-e4c540522c31","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"blue-purple-gradient"}}],"text":"Tips"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634310987427,"lastEditedTime":1634311000705},{"id":"f30e5148-f6c4-4252-9811-3135506d532f","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"2. Adding new ideas is better than updating old ones. ["},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/inc/","title":null}}],"text":"source"},{"type":"text","text":"]"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634307144456,"lastEditedTime":1634313390475},{"id":"97b8a099-57f4-4c6b-a76e-70a2a31875b8","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"orange-pink-gradient"}}],"text":"This is your home canvas"},{"type":"text","text":", the one you\'ll see whenever you click on the "},{"type":"text","marks":[{"type":"italic"}],"text":"home button"},{"type":"text","text":"."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634057443985,"lastEditedTime":1634315251904},{"id":"cc7baa42-2423-4dfe-b86b-8456e03dbe32","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Click the "},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-green"}}],"text":"top-left corner"},{"type":"text","text":" of this block when you\'re done."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634314617696,"lastEditedTime":1640458920107},{"id":"5606238a-4d2f-497d-afa2-524cff5e08a2","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Congratulations, that\'s it for now."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634054077768,"lastEditedTime":1634316351822},{"id":"__tool_mask__","summary":{"type":"toolmask"},"references":[{"id":"43d87451-8b95-4cda-a87b-3c6558cc9fcc","createdTime":1634051238541,"lastEditedTime":1634051238541,"to":"9cd97640-aa7c-4916-9a26-dadb694a2717","posType":2,"pos":{"x":400,"y":10},"size":{"w":450,"h":"auto"}},{"id":"2b41d2d4-6b23-46f0-9597-5279d9fa6f09","createdTime":1634051238541,"lastEditedTime":1634051238542,"to":"fb7e6963-aa2e-4fca-b196-8526196be549","posType":3,"pos":{"x":10,"y":10},"size":{"w":450,"h":"auto"}},{"id":"a45d0136-3e98-4292-bc7c-8fa251e37c85","createdTime":1634051238542,"lastEditedTime":1634051238542,"to":"44c11a76-d353-4522-88b8-48523a0115bd","posType":5,"pos":{"x":10,"y":10},"size":{"w":250,"h":"auto"}},{"id":"9f90a945-565e-43a8-a494-4ca7ebe33c37","createdTime":1634051238542,"lastEditedTime":1634051238542,"to":"f5898f68-e760-43c5-af62-0d97de2eca69","posType":2,"pos":{"x":10,"y":10},"size":{"w":270,"h":"auto"}}],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051238540,"lastEditedTime":1634051238540},{"id":"4516c95d-d3cc-412a-a683-c68705517ab3","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/840c09b9-7c72-467c-8b52-3591eb079afa","title":null}}],"text":"Next →"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634055113555,"lastEditedTime":1634309339210},{"id":"9793fb6a-328c-4566-937e-93896d367e1f","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Capture your random inspiration."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634055971483,"lastEditedTime":1634056064306},{"id":"fb7e6963-aa2e-4fca-b196-8526196be549","summary":{"type":"recenttool","data":{}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051238541,"lastEditedTime":1634051238541},{"id":"dcf6da14-23ad-4480-9f8c-9e1303c6f872","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Take notes while reading articles or watching videos."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056846505,"lastEditedTime":1634056932319},{"id":"a06d4cd0-f42f-4299-9a63-50a10eb921ff","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"After having some raw input, you may want to "},{"type":"text","marks":[{"type":"bold"}],"text":"rearrange"},{"type":"text","text":" them."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634306783328,"lastEditedTime":1640458697490},{"id":"8a15e8a7-aa41-4b42-a39b-f9e4dd3fe167","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"blue-purple-gradient"}}],"text":"Hi, Welcome to Jade"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051255656,"lastEditedTime":1634052669596},{"id":"2e6808f2-c49e-42e2-8fee-9d9fc1ad4447","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/423d4c3b-ff39-4c9a-9daa-0193380721ce","title":null}}],"text":"← Prev"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634314333194,"lastEditedTime":1634314350860},{"id":"52bd1d10-4535-4bc7-81f3-8d03c5d7bfb3","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Feel free to delete the existing blocks in this canvas."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634054665832,"lastEditedTime":1634057617353},{"id":"b2aada53-355d-4291-ba05-c6df9df2ed29","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Drag from the top-right corner of a "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634312393789,"lastEditedTime":1634312414903},{"id":"44c11a76-d353-4522-88b8-48523a0115bd","summary":{"type":"insighttool","data":{}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051238541,"lastEditedTime":1634051238541},{"id":"9cd97640-aa7c-4916-9a26-dadb694a2717","summary":{"type":"headertool","data":{}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051238541,"lastEditedTime":1634051238541},{"id":"49debdfe-e9d3-4d5f-8a5b-cd7096d63869","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"1. Captured ideas are better than missed ones. ["},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/inc/","title":null}}],"text":"source"},{"type":"text","text":"]"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634306342894,"lastEditedTime":1634313374307},{"id":"456ada6c-5a78-46fc-b5b2-ae084820aa3c","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Secret Place"}]}}},"references":[{"id":"dd3e06b3-203e-436f-88aa-b44ffacca6c7","to":"6fa22a56-b865-4a5a-acaa-f24e7315051f","posType":1,"pos":{"x":196,"y":177},"size":{"w":720.8631789193493,"h":"auto"},"createdTime":1634230494173,"lastEditedTime":1634230494173},{"id":"8f777f38-749a-465e-99eb-bf499f54b551","to":"1905f6a9-aa14-4a7d-b276-279aad106b69","posType":1,"pos":{"x":1008.8631789193491,"y":142},"size":{"x":-406.9334803966036,"y":518.000011072249,"w":300,"h":"auto"},"createdTime":1634061083809,"lastEditedTime":1634061083809}],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":48.03125},"scale":1},"createdTime":1634056326237,"lastEditedTime":1634315606992},{"id":"a83486f5-b348-4846-bbb0-63d6d4505b15","summary":{"type":"pmtext","data":{"initialized":true}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313916561,"lastEditedTime":1634313916574},{"id":"f6f02393-f01c-4fe8-b3c8-d4e6b1fc19ba","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/840c09b9-7c72-467c-8b52-3591eb079afa","title":null}}],"text":"← Back"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634307465884,"lastEditedTime":1634309380459},{"id":"3d92087a-1ed2-4b90-9fae-5d4dfeec6812","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"https://notes.andymatuschak.org/Evergreen_notes","title":null}}],"text":"Evergreen notes"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056635176,"lastEditedTime":1634314905932},{"id":"fba64cf3-f317-4479-82ee-0186b36ece76","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Make sense of complex topics."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056078904,"lastEditedTime":1634056131715},{"id":"665b9c7e-9ed1-44f3-943a-19f553e366ac","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/inc/","title":null}}],"text":"Incremental note-taking"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056400988,"lastEditedTime":1634314878768},{"id":"a92621be-4538-4cae-9ac2-9ce352ad56a8","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Type "},{"type":"text","marks":[{"type":"bold"}],"text":"@"},{"type":"text","text":" or "},{"type":"text","marks":[{"type":"bold"}],"text":"[["},{"type":"text","text":" in a Text "},{"type":"text","marks":[{"type":"italic"}],"text":"Block."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634312031572,"lastEditedTime":1640458589341},{"id":"c2c34960-734e-40a7-ab66-b7ae49afa01b","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"You can start capturing ideas here."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634057536445,"lastEditedTime":1634057565827},{"id":"805f1c64-e0ad-49b7-a542-56bd1e5a4e6f","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Try selecting some text and set styles as you like!"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634055179884,"lastEditedTime":1640458899350},{"id":"3859dd0a-bd3a-40ea-8d60-a8eab2ccb854","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"If you want to read the tutorial again, hit "},{"type":"text","marks":[{"type":"code"}],"text":"Ctrl/Cmd"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"P"},{"type":"text","text":" and search for \\"Jade Tutorial\\", you\'ll find it under the "},{"type":"text","marks":[{"type":"italic"}],"text":"Canvas"},{"type":"text","text":" tab."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634054907332,"lastEditedTime":1634314694759},{"id":"67764109-fdae-4469-addc-c72d9f30e8e9","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Keep your text short, so your "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"s can be easily rearranged into different groupings and presentations."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634304264221,"lastEditedTime":1634304855840},{"id":"a00dcc85-c504-4561-b344-a88bb1f24348","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-purple"}}],"text":"Embed"},{"type":"text","text":" the same thought in multiple "},{"type":"text","marks":[{"type":"italic"}],"text":"Canvas"},{"type":"text","text":"es."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634314392689,"lastEditedTime":1640458648104},{"id":"b4740c13-f7dc-4881-8a67-64d95ce8a7f0","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"If you\'re brought here accidentally in the middle of the tutorial, click "},{"type":"text","marks":[{"type":"bold"},{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff","title":null}}],"text":"this link"},{"type":"text","text":" to go back."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634054623648,"lastEditedTime":1634303692612},{"id":"1905f6a9-aa14-4a7d-b276-279aad106b69","summary":{"type":"status","data":{"initialized":false}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634061083809,"lastEditedTime":1634061088709},{"id":"3dbb6a06-53df-43fb-acb4-7cf44957c0d4","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/883d155b-5180-4e33-b8cd-6600b4bca4d7","title":null}}],"text":"Next →"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313708309,"lastEditedTime":1634313811962},{"id":"8f80c2d8-9b53-4210-a624-42d5e30304c1","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"}],"text":"Some things you can try"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634055967167,"lastEditedTime":1634314828406},{"id":"f8c62c5b-62fb-42c3-a223-e2332757740d","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"By default it\'s a "},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-red"}}],"text":"r"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-orange"}}],"text":"ic"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-yellow"}}],"text":"h"},{"type":"text","text":"-"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-green"}}],"text":"t"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-blue"}}],"text":"e"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-purple"}}],"text":"x"},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-pink"}}],"text":"t"},{"type":"text","text":" "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":", but you can type "},{"type":"text","marks":[{"type":"code"}],"text":"/"},{"type":"text","text":" to replace it with an Image "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":" or an Embed "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634307984207,"lastEditedTime":1640458473667},{"id":"a9e34922-7b8c-4058-882c-15646bc665d7","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Select the details → drag and drop them into another "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634312315941,"lastEditedTime":1634312357481},{"id":"41bfd25a-a65b-4a6b-9b8c-09c6c295da94","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Plan your life."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056011800,"lastEditedTime":1634056017077},{"id":"753c8d99-8931-4b96-96a0-e03313811ed9","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/423d4c3b-ff39-4c9a-9daa-0193380721ce","title":null}}],"text":"Next →"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634305155164,"lastEditedTime":1634312993531},{"id":"2fbb1df6-5c90-483d-aa65-20f4720a4843","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-red"}}],"text":"Snap"},{"type":"text","text":" continuous thoughts in sequences."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634310486675,"lastEditedTime":1640458607470},{"id":"77d4dfe9-10ee-407b-a7b3-df1267fd90e7","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"3. Ideas that can’t be recalled are worse than useless ["},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/inc/","title":null}}],"text":"source"},{"type":"text","text":"]"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313416527,"lastEditedTime":1634313420325},{"id":"0f7090cd-df41-4328-834f-545edb86d10c","summary":{"type":"image","data":{"imgSrc":"https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F426fe4e9-a656-4a03-ba99-a7ee074ebfde%2FJade_v0.3_Block_Set_Presentation.png?width=1366&table=block&id=0ee92779-54e6-4420-b0e9-d30a20351c71"}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634308140909,"lastEditedTime":1634308720139},{"id":"af67cfe7-e7ef-4b8d-b627-d4000dbc2a94","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"4. Time is essential to how we remember ["},{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/inc/","title":null}}],"text":"source"},{"type":"text","text":"]"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313432539,"lastEditedTime":1634313434786},{"id":"eb7eb6e9-bf5d-4a0d-9383-2daa41bb3b50","summary":{"type":"image","data":{"imgSrc":"https://raw.githubusercontent.com/dragonman225/dragonman225.github.io/master/p/jade/assets/2272b1ebf4a4f045f2ad.png"}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634053060729,"lastEditedTime":1634053168666},{"id":"c2f2a509-87b5-45ff-81ab-85c6de98dfaf","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"},{"type":"highlight","attrs":{"color":"background-yellow"}}],"text":"Hide"},{"type":"text","text":" details that create noise in current context with nested "},{"type":"text","marks":[{"type":"italic"}],"text":"Canvases"},{"type":"text","text":"."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634310592853,"lastEditedTime":1640458620470},{"id":"e6089d0e-33f3-48e4-a780-566f0ac91573","summary":{"type":"css","data":{"globalCss":":root {\\n  --bg-canvas: hsl(215deg, 5%, 17%);\\n\\n}"}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634227721424,"lastEditedTime":1634230472343},{"id":"2eb9e224-adf7-40fd-abc7-cdd2c79236c4","summary":{"type":"embed","data":{"initialized":true,"url":"https://youtu.be/PUv66718DII?t=257"}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634308867627,"lastEditedTime":1634308946983},{"id":"f5898f68-e760-43c5-af62-0d97de2eca69","summary":{"type":"searchtool","data":{}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634051238541,"lastEditedTime":1634051238541},{"id":"0a3706b8-f67a-49eb-9e57-291e26d62fbb","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"https://thesephist.com/posts/medium/#an-infinite-room","title":null}}],"text":"Designing a better thinking-writing medium"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634307748920,"lastEditedTime":1634313549328},{"id":"7583f5d7-46b1-45fd-8c2e-b3ae2fd17bb6","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"background-yellow"}}],"text":"Double-click"},{"type":"text","text":" on the "},{"type":"text","marks":[{"type":"italic"}],"text":"Canvas"},{"type":"text","text":", or hit "},{"type":"text","marks":[{"type":"code"}],"text":"Alt"},{"type":"text","text":" + "},{"type":"text","marks":[{"type":"code"}],"text":"N"},{"type":"text","text":" anywhere, to "},{"type":"text","marks":[{"type":"bold"}],"text":"create"},{"type":"text","text":" one."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634304171337,"lastEditedTime":1640458366705},{"id":"bbb78b24-0b03-4cf0-96f6-36d8da124c11","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"jade://v1/concept/b1f78b9d-eebd-4d94-b3e3-ba80b54769ff/87888b5b-5747-43ef-ba05-208952e3c3a6","title":null}}],"text":"Next →"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634309127135,"lastEditedTime":1634309445481},{"id":"3775c06e-0a6e-4021-834f-292657f35001","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"bold"}],"text":"Worth reading"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634056622783,"lastEditedTime":1634314861370},{"id":"6fa22a56-b865-4a5a-acaa-f24e7315051f","summary":{"type":"css","data":{"globalCss":"/**\\n * \\"Dark Mode\\" CSS theme\\n * Inspired by Teerb\\n * https://mayccoll.github.io/Gogh/\\n */\\n:root {\\n  --content-text: hsl(50deg, 16%, 72%);\\n  --bg-block: #212121;\\n  --bg-canvas: hsl(0deg, 0%, 11%);\\n  --bg-canvas-semi-transparent: hsla(0deg, 0%, 9%, 0.6);\\n  --bg-red: hsl(0deg, 60%, 17%);\\n  --bg-orange: hsl(22deg, 72%, 16%);\\n  --bg-yellow: hsl(46deg, 70%, 16%);\\n  --bg-brown: hsl(34deg, 95%, 11%);\\n  --bg-blue: hsl(210deg, 63%, 16%);\\n  --bg-green: hsl(84deg, 60%, 14%);\\n  --bg-purple: hsl(264deg, 58%, 22%);\\n  --bg-pink: hsl(335deg, 56%, 18%);\\n  --bg-grey: hsl(0deg, 0%, 18%);\\n  --neutral-100: rgb(0, 0, 0);\\n  --neutral-99: rgb(29, 28, 22);\\n  --neutral-98: rgb(50, 48, 42);\\n  --neutral-95: rgb(61, 59, 53);\\n  --neutral-90: rgb(73, 71, 65);\\n  --neutral-80: rgb(84, 82, 75);\\n  --neutral-70: rgb(96, 94, 88);\\n  --neutral-60: rgb(121, 119, 112);\\n  --neutral-50: rgb(147, 144, 136);\\n  --neutral-40: rgb(174, 171, 163);\\n  --neutral-35: rgb(202, 198, 189);\\n  --neutral-30: rgb(230, 226, 217);\\n  --neutral-25: rgb(245, 240, 231);\\n  --neutral-20: rgb(254, 249, 240);\\n  --neutral-10: rgb(255, 252, 243);\\n  --neutral-0: rgb(255, 255, 255);\\n}"}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":-48.03125},"scale":1},"createdTime":1634230494173,"lastEditedTime":1644258984451},{"id":"827f4330-b424-4384-9748-43c148f747e0","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"link","attrs":{"href":"https://darkblueheaven.com/spatialsoftware/","title":null}}],"text":"Spatial Software"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313462867,"lastEditedTime":1634313463225},{"id":"17b1ebc5-fe6f-42bd-8b5f-d90019e1132f","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"The last thing is to change the content of below block to set the title of your home canvas."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634316296936,"lastEditedTime":1634316297409},{"id":"addb48b4-ad7f-4eed-b332-6d615227a52c","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"↓ "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":"s for you to play with"}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634313610310,"lastEditedTime":1634313754699},{"id":"72de3b3d-1d8f-432b-8938-fa288be377a3","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","text":"Right-click on the target "},{"type":"text","marks":[{"type":"italic"}],"text":"Block"},{"type":"text","text":" → copy link → and paste it to some text."}]}}},"references":[],"relations":[],"drawing":[],"camera":{"focus":{"x":0,"y":0},"scale":1},"createdTime":1634312065147,"lastEditedTime":1634312351544},{"id":"home","summary":{"type":"pmtext","data":{"initialized":true,"data":{"type":"doc","content":[{"type":"text","marks":[{"type":"underline"},{"type":"highlight","attrs":{"color":"orange-pink-gradient"}}],"text":"Your name"},{"type":"text","text":"\'s Space"}]}}},"references":[{"id":"a61d9ba7-924e-406a-9ffd-a1b3bf54390f","createdTime":1634054623648,"lastEditedTime":1634054623648,"to":"b4740c13-f7dc-4881-8a67-64d95ce8a7f0","posType":1,"pos":{"x":76.92337347062107,"y":162.3808399296709},"size":{"w":264,"h":"auto"},"color":"background-red"},{"id":"3417827c-33b8-49bc-bca3-78e21a49ca5a","createdTime":1634054665833,"lastEditedTime":1634054665833,"to":"52bd1d10-4535-4bc7-81f3-8d03c5d7bfb3","posType":1,"pos":{"x":369.9233124354648,"y":353.139472589583},"size":{"w":375.00006103515625,"h":"auto"}},{"id":"d792679b-e181-48c2-96ca-1f5a992ea49d","createdTime":1634054907332,"lastEditedTime":1634054907332,"to":"3859dd0a-bd3a-40ea-8d60-a8eab2ccb854","posType":1,"pos":{"x":369.9233124354648,"y":433.5187946415849},"size":{"x":359.9233124354648,"y":293.76016198167287,"w":375.00006103515625,"h":"auto"}},{"id":"62e08f1f-e65d-4b02-a110-604d3b813bf7","createdTime":1634057443986,"lastEditedTime":1634057443986,"to":"97b8a099-57f4-4c6b-a76e-70a2a31875b8","posType":1,"pos":{"x":369.9233734706211,"y":162.3808399296709},"size":{"w":375.00006103515625,"h":"auto"}},{"id":"735035a6-eabf-4484-bd1c-47caa1314af6","createdTime":1634057536446,"lastEditedTime":1634057536446,"to":"c2c34960-734e-40a7-ab66-b7ae49afa01b","posType":1,"pos":{"x":369.9233124354648,"y":301.4498020268389},"size":{"w":375.00006103515625,"h":"auto"}},{"id":"9409d2f7-6b26-403d-b745-cf22b605402d","createdTime":1634055967167,"lastEditedTime":1634055967167,"to":"8f80c2d8-9b53-4210-a624-42d5e30304c1","posType":1,"pos":{"x":777.2348863348043,"y":162.3808399296709},"size":{"w":275.5815826404309,"h":"auto"},"color":"background-green"},{"id":"b943277e-2b9b-4e66-b8c6-c56cc28e22f7","createdTime":1634055971483,"lastEditedTime":1634055971483,"to":"9793fb6a-328c-4566-937e-93896d367e1f","posType":1,"pos":{"x":777.2348863348043,"y":214.07046200534074},"size":{"w":331,"h":"auto"},"color":"background-green"},{"id":"c3959518-fbaf-43e7-93d9-faeb1d6b05d3","createdTime":1634056011800,"lastEditedTime":1634056011800,"to":"41bfd25a-a65b-4a6b-9b8c-09c6c295da94","posType":1,"pos":{"x":777.2348863348043,"y":265.76012875338785},"size":{"w":170,"h":"auto"},"color":"background-green"},{"id":"34031d2d-f9b9-4a49-a911-d57613d0f2f4","createdTime":1634056078905,"lastEditedTime":1634056078905,"to":"fba64cf3-f317-4479-82ee-0186b36ece76","posType":1,"pos":{"x":777.2348863348043,"y":317.4497649838566},"size":{"w":309,"h":"auto"},"color":"background-green"},{"id":"521923d4-99b0-42cb-a164-dcc68f26d9b1","createdTime":1634056114969,"lastEditedTime":1634056114969,"to":"ddcd8423-05f3-4cf5-869d-c1a73d182d17","posType":1,"pos":{"x":777.2348863348043,"y":420.8290755917658},"size":{"w":202,"h":"auto"},"color":"background-green"},{"id":"77e5ab57-f520-4381-93f7-5c660974fda2","createdTime":1634056165169,"lastEditedTime":1634056165169,"to":"8dfecddd-7592-49f6-8a2a-7af588710597","posType":1,"pos":{"x":777.2348863348043,"y":369.1394202878117},"size":{"w":250,"h":"auto"},"color":"background-green"},{"id":"f15161a4-e166-43e0-b8ea-f99d5d561446","createdTime":1634056400989,"lastEditedTime":1634056400989,"to":"665b9c7e-9ed1-44f3-943a-19f553e366ac","posType":1,"pos":{"x":777.2348863348043,"y":624.0705257512041},"size":{"x":15.423312435464823,"y":706.5187374211259,"w":334,"h":"auto"},"color":"background-orange"},{"id":"025ef444-41b0-4ca1-9a6c-400e53a5b441","createdTime":1634056622783,"lastEditedTime":1634056622783,"to":"3775c06e-0a6e-4021-834f-292657f35001","posType":1,"pos":{"x":777.2348863348043,"y":572.380870447249},"size":{"w":191.86252833869887,"h":"auto"},"color":"background-orange"},{"id":"bf75e869-7c03-4165-a126-2f11a86a97a1","createdTime":1634056635177,"lastEditedTime":1634056635177,"to":"3d92087a-1ed2-4b90-9fae-5d4dfeec6812","posType":1,"pos":{"x":777.2348863348043,"y":675.7601657963701},"size":{"x":421.4233124354648,"y":730.5187336064287,"w":334.00006103515625,"h":"auto"},"color":"background-orange"},{"id":"ef09be5f-420e-4b09-8d39-d6f40a264d5d","createdTime":1634056846505,"lastEditedTime":1634056846505,"to":"dcf6da14-23ad-4480-9f8c-9e1303c6f872","posType":1,"pos":{"x":777.2348863348043,"y":472.5187041928393},"size":{"w":304,"h":"auto"},"color":"background-green"}],"relations":[],"drawing":[],"camera":{"focus":{"x":28.423342953042948,"y":67.38083992967091},"scale":1},"createdTime":1634051204000,"lastEditedTime":1634053481562}]')}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e].call(a.exports,a,a.exports,r),a.exports}r.m=t,e=[],r.O=(t,n,o,a)=>{if(!n){var i=1/0;for(d=0;d<e.length;d++){for(var[n,o,a]=e[d],c=!0,s=0;s<n.length;s++)(!1&a||i>=a)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(c=!1,a<i&&(i=a));if(c){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[n,o,a]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={143:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[i,c,s]=n,l=0;if(i.some((t=>0!==e[t]))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(s)var d=s(r)}for(t&&t(n);l<i.length;l++)a=i[l],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(d)},n=self.webpackChunkjade=self.webpackChunkjade||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var o=r.O(void 0,[216],(()=>r(1046)));o=r.O(o)})();